(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-00aea5ac"],{"05d4":function(e,t,i){"use strict";i("b9cd")},"10d0":function(e,t,i){},2209:function(e,t,i){},"250d":function(e,t,i){"use strict";i("9dfc")},"3db7":function(e,t,i){},"41e3":function(e,t,i){"use strict";i("2209")},4238:function(e,t,i){},"514a":function(e,t,i){},"52e1":function(e,t,i){!function(t,i){e.exports=i()}("undefined"!=typeof self&&self,(function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return n}));class n{constructor(e,t=null){this.events={},this.container=e,this.precanvas=null,this.nodeId=1,this.ele_selected=null,this.node_selected=null,this.drag=!1,this.reroute=!1,this.reroute_fix_curvature=!1,this.curvature=.5,this.reroute_curvature_start_end=.5,this.reroute_curvature=.5,this.reroute_width=6,this.drag_point=!1,this.editor_selected=!1,this.connection=!1,this.connection_ele=null,this.connection_selected=null,this.canvas_x=0,this.canvas_y=0,this.pos_x=0,this.pos_x_start=0,this.pos_y=0,this.pos_y_start=0,this.mouse_x=0,this.mouse_y=0,this.line_path=5,this.first_click=null,this.force_first_input=!1,this.draggable_inputs=!0,this.useuuid=!1,this.select_elements=null,this.noderegister={},this.render=t,this.drawflow={drawflow:{Home:{data:{}}}},this.module="Home",this.editor_mode="edit",this.zoom=1,this.zoom_max=1.6,this.zoom_min=.5,this.zoom_value=.1,this.zoom_last_value=1,this.evCache=new Array,this.prevDiff=-1}start(){this.container.classList.add("parent-drawflow"),this.container.tabIndex=0,this.precanvas=document.createElement("div"),this.precanvas.classList.add("drawflow"),this.container.appendChild(this.precanvas),this.container.addEventListener("mouseup",this.dragEnd.bind(this)),this.container.addEventListener("mousemove",this.position.bind(this)),this.container.addEventListener("mousedown",this.click.bind(this)),this.container.addEventListener("touchend",this.dragEnd.bind(this)),this.container.addEventListener("touchmove",this.position.bind(this)),this.container.addEventListener("touchstart",this.click.bind(this)),this.container.addEventListener("contextmenu",this.contextmenu.bind(this)),this.container.addEventListener("keydown",this.key.bind(this)),this.container.addEventListener("wheel",this.zoom_enter.bind(this)),this.container.addEventListener("input",this.updateNodeValue.bind(this)),this.container.addEventListener("dblclick",this.dblclick.bind(this)),this.container.onpointerdown=this.pointerdown_handler.bind(this),this.container.onpointermove=this.pointermove_handler.bind(this),this.container.onpointerup=this.pointerup_handler.bind(this),this.container.onpointercancel=this.pointerup_handler.bind(this),this.container.onpointerout=this.pointerup_handler.bind(this),this.container.onpointerleave=this.pointerup_handler.bind(this),this.load()}pointerdown_handler(e){this.evCache.push(e)}pointermove_handler(e){for(var t=0;t<this.evCache.length;t++)if(e.pointerId==this.evCache[t].pointerId){this.evCache[t]=e;break}if(2==this.evCache.length){var i=Math.abs(this.evCache[0].clientX-this.evCache[1].clientX);this.prevDiff>100&&(i>this.prevDiff&&this.zoom_in(),i<this.prevDiff&&this.zoom_out()),this.prevDiff=i}}pointerup_handler(e){this.remove_event(e),this.evCache.length<2&&(this.prevDiff=-1)}remove_event(e){for(var t=0;t<this.evCache.length;t++)if(this.evCache[t].pointerId==e.pointerId){this.evCache.splice(t,1);break}}load(){for(var e in this.drawflow.drawflow[this.module].data)this.addNodeImport(this.drawflow.drawflow[this.module].data[e],this.precanvas);if(this.reroute)for(var e in this.drawflow.drawflow[this.module].data)this.addRerouteImport(this.drawflow.drawflow[this.module].data[e]);for(var e in this.drawflow.drawflow[this.module].data)this.updateConnectionNodes("node-"+e);const t=this.drawflow.drawflow;let i=1;Object.keys(t).map((function(e,n){Object.keys(t[e].data).map((function(e,t){parseInt(e)>=i&&(i=parseInt(e)+1)}))})),this.nodeId=i}removeReouteConnectionSelected(){this.dispatch("connectionUnselected",!0),this.reroute_fix_curvature&&this.connection_selected.parentElement.querySelectorAll(".main-path").forEach((e,t)=>{e.classList.remove("selected")})}click(e){if(this.dispatch("click",e),"fixed"===this.editor_mode){if("parent-drawflow"!==e.target.classList[0]&&"drawflow"!==e.target.classList[0])return!1;this.ele_selected=e.target.closest(".parent-drawflow")}else"view"===this.editor_mode?(null!=e.target.closest(".drawflow")||e.target.matches(".parent-drawflow"))&&(this.ele_selected=e.target.closest(".parent-drawflow"),e.preventDefault()):(this.first_click=e.target,this.ele_selected=e.target,0===e.button&&this.contextmenuDel(),null!=e.target.closest(".drawflow_content_node")&&(this.ele_selected=e.target.closest(".drawflow_content_node").parentElement));switch(this.ele_selected.classList[0]){case"drawflow-node":null!=this.node_selected&&(this.node_selected.classList.remove("selected"),this.node_selected!=this.ele_selected&&this.dispatch("nodeUnselected",!0)),null!=this.connection_selected&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.node_selected!=this.ele_selected&&this.dispatch("nodeSelected",this.ele_selected.id.slice(5)),this.node_selected=this.ele_selected,this.node_selected.classList.add("selected"),this.draggable_inputs?"SELECT"!==e.target.tagName&&(this.drag=!0):"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&"SELECT"!==e.target.tagName&&!0!==e.target.hasAttribute("contenteditable")&&(this.drag=!0);break;case"output":this.connection=!0,null!=this.node_selected&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),null!=this.connection_selected&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.drawConnection(e.target);break;case"parent-drawflow":case"drawflow":null!=this.node_selected&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),null!=this.connection_selected&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.editor_selected=!0;break;case"main-path":null!=this.node_selected&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),null!=this.connection_selected&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.connection_selected=this.ele_selected,this.connection_selected.classList.add("selected");const t=this.connection_selected.parentElement.classList;this.dispatch("connectionSelected",{output_id:t[2].slice(14),input_id:t[1].slice(13),output_class:t[3],input_class:t[4]}),this.reroute_fix_curvature&&this.connection_selected.parentElement.querySelectorAll(".main-path").forEach((e,t)=>{e.classList.add("selected")});break;case"point":this.drag_point=!0,this.ele_selected.classList.add("selected");break;case"drawflow-delete":this.node_selected&&this.removeNodeId(this.node_selected.id),this.connection_selected&&this.removeConnection(),null!=this.node_selected&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),null!=this.connection_selected&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null)}"touchstart"===e.type?(this.pos_x=e.touches[0].clientX,this.pos_x_start=e.touches[0].clientX,this.pos_y=e.touches[0].clientY,this.pos_y_start=e.touches[0].clientY):(this.pos_x=e.clientX,this.pos_x_start=e.clientX,this.pos_y=e.clientY,this.pos_y_start=e.clientY),this.dispatch("clickEnd",e)}position(e){if("touchmove"===e.type)var t=e.touches[0].clientX,i=e.touches[0].clientY;else t=e.clientX,i=e.clientY;if(this.connection&&this.updateConnection(t,i),this.editor_selected&&(n=this.canvas_x+-(this.pos_x-t),s=this.canvas_y+-(this.pos_y-i),this.dispatch("translate",{x:n,y:s}),this.precanvas.style.transform="translate("+n+"px, "+s+"px) scale("+this.zoom+")"),this.drag){var n=(this.pos_x-t)*this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom),s=(this.pos_y-i)*this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom);this.pos_x=t,this.pos_y=i,this.ele_selected.style.top=this.ele_selected.offsetTop-s+"px",this.ele_selected.style.left=this.ele_selected.offsetLeft-n+"px",this.drawflow.drawflow[this.module].data[this.ele_selected.id.slice(5)].pos_x=this.ele_selected.offsetLeft-n,this.drawflow.drawflow[this.module].data[this.ele_selected.id.slice(5)].pos_y=this.ele_selected.offsetTop-s,this.updateConnectionNodes(this.ele_selected.id)}if(this.drag_point){n=(this.pos_x-t)*this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom),s=(this.pos_y-i)*this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom),this.pos_x=t,this.pos_y=i;var a=this.pos_x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom)),o=this.pos_y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom));this.ele_selected.setAttributeNS(null,"cx",a),this.ele_selected.setAttributeNS(null,"cy",o);const e=this.ele_selected.parentElement.classList[2].slice(9),r=this.ele_selected.parentElement.classList[1].slice(13),l=this.ele_selected.parentElement.classList[3],c=this.ele_selected.parentElement.classList[4];let d=Array.from(this.ele_selected.parentElement.children).indexOf(this.ele_selected)-1;this.reroute_fix_curvature&&(d-=this.ele_selected.parentElement.querySelectorAll(".main-path").length-1,d<0&&(d=0));const u=e.slice(5),h=this.drawflow.drawflow[this.module].data[u].outputs[l].connections.findIndex((function(e,t){return e.node===r&&e.output===c}));this.drawflow.drawflow[this.module].data[u].outputs[l].connections[h].points[d]={pos_x:a,pos_y:o};const p=this.ele_selected.parentElement.classList[2].slice(9);this.updateConnectionNodes(p)}"touchmove"===e.type&&(this.mouse_x=t,this.mouse_y=i),this.dispatch("mouseMove",{x:t,y:i})}dragEnd(e){if(null!=this.select_elements&&(this.select_elements.remove(),this.select_elements=null),"touchend"===e.type)var t=this.mouse_x,i=this.mouse_y,n=document.elementFromPoint(t,i);else t=e.clientX,i=e.clientY,n=e.target;if(this.drag&&(this.pos_x_start==t&&this.pos_y_start==i||this.dispatch("nodeMoved",this.ele_selected.id.slice(5))),this.drag_point&&this.ele_selected.classList.remove("selected"),this.editor_selected&&(this.canvas_x=this.canvas_x+-(this.pos_x-t),this.canvas_y=this.canvas_y+-(this.pos_y-i),this.editor_selected=!1),!0===this.connection)if("input"===n.classList[0]||this.force_first_input&&(null!=n.closest(".drawflow_content_node")||"drawflow-node"===n.classList[0])){if(!this.force_first_input||null==n.closest(".drawflow_content_node")&&"drawflow-node"!==n.classList[0])s=n.parentElement.parentElement.id,a=n.classList[1];else{if(null!=n.closest(".drawflow_content_node"))var s=n.closest(".drawflow_content_node").parentElement.id;else s=n.id;if(0===Object.keys(this.getNodeFromId(s.slice(5)).inputs).length)var a=!1;else a="input_1"}var o=this.ele_selected.parentElement.parentElement.id,r=this.ele_selected.classList[1];if(o!==s&&!1!==a){if(0===this.container.querySelectorAll(".connection.node_in_"+s+".node_out_"+o+"."+r+"."+a).length){this.connection_ele.classList.add("node_in_"+s),this.connection_ele.classList.add("node_out_"+o),this.connection_ele.classList.add(r),this.connection_ele.classList.add(a);var l=s.slice(5),c=o.slice(5);this.drawflow.drawflow[this.module].data[c].outputs[r].connections.push({node:l,output:a}),this.drawflow.drawflow[this.module].data[l].inputs[a].connections.push({node:c,input:r}),this.updateConnectionNodes("node-"+c),this.updateConnectionNodes("node-"+l),this.dispatch("connectionCreated",{output_id:c,input_id:l,output_class:r,input_class:a})}else this.dispatch("connectionCancel",!0),this.connection_ele.remove();this.connection_ele=null}else this.dispatch("connectionCancel",!0),this.connection_ele.remove(),this.connection_ele=null}else this.dispatch("connectionCancel",!0),this.connection_ele.remove(),this.connection_ele=null;this.drag=!1,this.drag_point=!1,this.connection=!1,this.ele_selected=null,this.editor_selected=!1}contextmenu(e){if(this.dispatch("contextmenu",e),e.preventDefault(),"fixed"===this.editor_mode||"view"===this.editor_mode)return!1;if(this.precanvas.getElementsByClassName("drawflow-delete").length&&this.precanvas.getElementsByClassName("drawflow-delete")[0].remove(),this.node_selected||this.connection_selected){var t=document.createElement("div");t.classList.add("drawflow-delete"),t.innerHTML="x",this.node_selected&&this.node_selected.appendChild(t),this.connection_selected&&(t.style.top=e.clientY*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))+"px",t.style.left=e.clientX*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))+"px",this.precanvas.appendChild(t))}}contextmenuDel(){this.precanvas.getElementsByClassName("drawflow-delete").length&&this.precanvas.getElementsByClassName("drawflow-delete")[0].remove()}key(e){if(this.dispatch("keydown",e),"fixed"===this.editor_mode||"view"===this.editor_mode)return!1;("Delete"===e.key||"Backspace"===e.key&&e.metaKey)&&(null!=this.node_selected&&"INPUT"!==this.first_click.tagName&&"TEXTAREA"!==this.first_click.tagName&&!0!==this.first_click.hasAttribute("contenteditable")&&this.removeNodeId(this.node_selected.id),null!=this.connection_selected&&this.removeConnection())}zoom_enter(e,t){e.ctrlKey&&(e.preventDefault(),e.deltaY>0?this.zoom_out():this.zoom_in())}zoom_refresh(){this.dispatch("zoom",this.zoom),this.canvas_x=this.canvas_x/this.zoom_last_value*this.zoom,this.canvas_y=this.canvas_y/this.zoom_last_value*this.zoom,this.zoom_last_value=this.zoom,this.precanvas.style.transform="translate("+this.canvas_x+"px, "+this.canvas_y+"px) scale("+this.zoom+")"}zoom_in(){this.zoom<this.zoom_max&&(this.zoom+=this.zoom_value,this.zoom_refresh())}zoom_out(){this.zoom>this.zoom_min&&(this.zoom-=this.zoom_value,this.zoom_refresh())}zoom_reset(){1!=this.zoom&&(this.zoom=1,this.zoom_refresh())}createCurvature(e,t,i,n,s,a){var o=e,r=t,l=i,c=n,d=s;switch(a){case"open":if(e>=i)var u=o+Math.abs(l-o)*d,h=l-Math.abs(l-o)*(-1*d);else u=o+Math.abs(l-o)*d,h=l-Math.abs(l-o)*d;return" M "+o+" "+r+" C "+u+" "+r+" "+h+" "+c+" "+l+"  "+c;case"close":return e>=i?(u=o+Math.abs(l-o)*(-1*d),h=l-Math.abs(l-o)*d):(u=o+Math.abs(l-o)*d,h=l-Math.abs(l-o)*d)," M "+o+" "+r+" C "+u+" "+r+" "+h+" "+c+" "+l+"  "+c;case"other":return e>=i?(u=o+Math.abs(l-o)*(-1*d),h=l-Math.abs(l-o)*(-1*d)):(u=o+Math.abs(l-o)*d,h=l-Math.abs(l-o)*d)," M "+o+" "+r+" C "+u+" "+r+" "+h+" "+c+" "+l+"  "+c;default:return" M "+o+" "+r+" C "+(u=o+Math.abs(l-o)*d)+" "+r+" "+(h=l-Math.abs(l-o)*d)+" "+c+" "+l+"  "+c}}drawConnection(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");this.connection_ele=t;var i=document.createElementNS("http://www.w3.org/2000/svg","path");i.classList.add("main-path"),i.setAttributeNS(null,"d",""),t.classList.add("connection"),t.appendChild(i),this.precanvas.appendChild(t);var n=e.parentElement.parentElement.id.slice(5),s=e.classList[1];this.dispatch("connectionStart",{output_id:n,output_class:s})}updateConnection(e,t){const i=this.precanvas,n=this.zoom;let s=i.clientWidth/(i.clientWidth*n);s=s||0;let a=i.clientHeight/(i.clientHeight*n);a=a||0;var o=this.connection_ele.children[0],r=this.ele_selected.offsetWidth/2+(this.ele_selected.getBoundingClientRect().x-i.getBoundingClientRect().x)*s,l=this.ele_selected.offsetHeight/2+(this.ele_selected.getBoundingClientRect().y-i.getBoundingClientRect().y)*a,c=e*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom)),d=t*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom)),u=this.curvature,h=this.createCurvature(r,l,c,d,u,"openclose");o.setAttributeNS(null,"d",h)}addConnection(e,t,i,n){var s=this.getModuleFromNodeId(e);if(s===this.getModuleFromNodeId(t)){var a=this.getNodeFromId(e),o=!1;for(var r in a.outputs[i].connections){var l=a.outputs[i].connections[r];l.node==t&&l.output==n&&(o=!0)}if(!1===o){if(this.drawflow.drawflow[s].data[e].outputs[i].connections.push({node:t.toString(),output:n}),this.drawflow.drawflow[s].data[t].inputs[n].connections.push({node:e.toString(),input:i}),this.module===s){var c=document.createElementNS("http://www.w3.org/2000/svg","svg"),d=document.createElementNS("http://www.w3.org/2000/svg","path");d.classList.add("main-path"),d.setAttributeNS(null,"d",""),c.classList.add("connection"),c.classList.add("node_in_node-"+t),c.classList.add("node_out_node-"+e),c.classList.add(i),c.classList.add(n),c.appendChild(d),this.precanvas.appendChild(c),this.updateConnectionNodes("node-"+e),this.updateConnectionNodes("node-"+t)}this.dispatch("connectionCreated",{output_id:e,input_id:t,output_class:i,input_class:n})}}}updateConnectionNodes(e){const t="node_in_"+e,i="node_out_"+e;this.line_path;const n=this.container,s=this.precanvas,a=this.curvature,o=this.createCurvature,r=this.reroute_curvature,l=this.reroute_curvature_start_end,c=this.reroute_fix_curvature,d=this.reroute_width,u=this.zoom;let h=s.clientWidth/(s.clientWidth*u);h=h||0;let p=s.clientHeight/(s.clientHeight*u);p=p||0;const g=n.querySelectorAll("."+i);Object.keys(g).map((function(t,i){if(null===g[t].querySelector(".point")){var f=n.querySelector("#"+e),m=g[t].classList[1].replace("node_in_",""),v=n.querySelector("#"+m).querySelectorAll("."+g[t].classList[4])[0],b=v.offsetWidth/2+(v.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,y=v.offsetHeight/2+(v.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,w=f.querySelectorAll("."+g[t].classList[3])[0],O=w.offsetWidth/2+(w.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,_=w.offsetHeight/2+(w.getBoundingClientRect().y-s.getBoundingClientRect().y)*p;const i=o(O,_,b,y,a,"openclose");g[t].children[0].setAttributeNS(null,"d",i)}else{const i=g[t].querySelectorAll(".point");let a="";const f=[];i.forEach((t,c)=>{if(0===c&&i.length-1==0){var g=n.querySelector("#"+e),m=((_=t).getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,v=(_.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,b=(C=g.querySelectorAll("."+t.parentElement.classList[3])[0]).offsetWidth/2+(C.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,y=C.offsetHeight/2+(C.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,w=o(b,y,m,v,l,"open");a+=w,f.push(w),g=t;var O=t.parentElement.classList[1].replace("node_in_",""),_=(x=n.querySelector("#"+O)).querySelectorAll("."+t.parentElement.classList[4])[0];m=(j=x.querySelectorAll("."+t.parentElement.classList[4])[0]).offsetWidth/2+(j.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,v=j.offsetHeight/2+(j.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,b=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,y=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,w=o(b,y,m,v,l,"close"),a+=w,f.push(w)}else if(0===c){var C;g=n.querySelector("#"+e),m=((_=t).getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,v=(_.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,b=(C=g.querySelectorAll("."+t.parentElement.classList[3])[0]).offsetWidth/2+(C.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,y=C.offsetHeight/2+(C.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,w=o(b,y,m,v,l,"open"),a+=w,f.push(w),g=t,m=((_=i[c+1]).getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,v=(_.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,b=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,y=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,w=o(b,y,m,v,r,"other"),a+=w,f.push(w)}else if(c===i.length-1){var x,j;g=t,O=t.parentElement.classList[1].replace("node_in_",""),_=(x=n.querySelector("#"+O)).querySelectorAll("."+t.parentElement.classList[4])[0],m=(j=x.querySelectorAll("."+t.parentElement.classList[4])[0]).offsetWidth/2+(j.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,v=j.offsetHeight/2+(j.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,b=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*(s.clientWidth/(s.clientWidth*u))+d,y=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*(s.clientHeight/(s.clientHeight*u))+d,w=o(b,y,m,v,l,"close"),a+=w,f.push(w)}else g=t,m=((_=i[c+1]).getBoundingClientRect().x-s.getBoundingClientRect().x)*(s.clientWidth/(s.clientWidth*u))+d,v=(_.getBoundingClientRect().y-s.getBoundingClientRect().y)*(s.clientHeight/(s.clientHeight*u))+d,b=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*(s.clientWidth/(s.clientWidth*u))+d,y=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*(s.clientHeight/(s.clientHeight*u))+d,w=o(b,y,m,v,r,"other"),a+=w,f.push(w)}),c?f.forEach((e,i)=>{g[t].children[i].setAttributeNS(null,"d",e)}):g[t].children[0].setAttributeNS(null,"d",a)}}));const f=n.querySelectorAll("."+t);Object.keys(f).map((function(t,i){if(null===f[t].querySelector(".point")){var u=n.querySelector("#"+e),g=f[t].classList[2].replace("node_out_",""),m=n.querySelector("#"+g).querySelectorAll("."+f[t].classList[3])[0],v=m.offsetWidth/2+(m.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,b=m.offsetHeight/2+(m.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,y=(u=u.querySelectorAll("."+f[t].classList[4])[0]).offsetWidth/2+(u.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,w=u.offsetHeight/2+(u.getBoundingClientRect().y-s.getBoundingClientRect().y)*p;const i=o(v,b,y,w,a,"openclose");f[t].children[0].setAttributeNS(null,"d",i)}else{const i=f[t].querySelectorAll(".point");let a="";const u=[];i.forEach((t,c)=>{if(0===c&&i.length-1==0){var g=n.querySelector("#"+e),f=((O=t).getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,m=(O.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,v=(x=g.querySelectorAll("."+t.parentElement.classList[4])[0]).offsetWidth/2+(x.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,b=x.offsetHeight/2+(x.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,y=o(f,m,v,b,l,"close");a+=y,u.push(y),g=t;var w=t.parentElement.classList[2].replace("node_out_",""),O=(C=n.querySelector("#"+w)).querySelectorAll("."+t.parentElement.classList[3])[0];f=(_=C.querySelectorAll("."+t.parentElement.classList[3])[0]).offsetWidth/2+(_.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,m=_.offsetHeight/2+(_.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,v=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,b=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,y=o(f,m,v,b,l,"open"),a+=y,u.push(y)}else if(0===c){var _;g=t,w=t.parentElement.classList[2].replace("node_out_",""),O=(C=n.querySelector("#"+w)).querySelectorAll("."+t.parentElement.classList[3])[0],f=(_=C.querySelectorAll("."+t.parentElement.classList[3])[0]).offsetWidth/2+(_.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,m=_.offsetHeight/2+(_.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,v=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,b=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,y=o(f,m,v,b,l,"open"),a+=y,u.push(y),g=t,v=((O=i[c+1]).getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,b=(O.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,f=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,m=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,y=o(f,m,v,b,r,"other"),a+=y,u.push(y)}else if(c===i.length-1){var C,x;g=t,w=t.parentElement.classList[1].replace("node_in_",""),O=(C=n.querySelector("#"+w)).querySelectorAll("."+t.parentElement.classList[4])[0],v=(x=C.querySelectorAll("."+t.parentElement.classList[4])[0]).offsetWidth/2+(x.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,b=x.offsetHeight/2+(x.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,f=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,m=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,y=o(f,m,v,b,l,"close"),a+=y,u.push(y)}else g=t,v=((O=i[c+1]).getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,b=(O.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,f=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,m=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,y=o(f,m,v,b,r,"other"),a+=y,u.push(y)}),c?u.forEach((e,i)=>{f[t].children[i].setAttributeNS(null,"d",e)}):f[t].children[0].setAttributeNS(null,"d",a)}}))}dblclick(e){null!=this.connection_selected&&this.reroute&&this.createReroutePoint(this.connection_selected),"point"===e.target.classList[0]&&this.removeReroutePoint(e.target)}createReroutePoint(e){this.connection_selected.classList.remove("selected");const t=this.connection_selected.parentElement.classList[2].slice(9),i=this.connection_selected.parentElement.classList[1].slice(13),n=this.connection_selected.parentElement.classList[3],s=this.connection_selected.parentElement.classList[4];this.connection_selected=null;const a=document.createElementNS("http://www.w3.org/2000/svg","circle");a.classList.add("point");var o=this.pos_x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom)),r=this.pos_y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom));a.setAttributeNS(null,"cx",o),a.setAttributeNS(null,"cy",r),a.setAttributeNS(null,"r",this.reroute_width);let l=0;if(this.reroute_fix_curvature){const t=e.parentElement.querySelectorAll(".main-path").length;var c=document.createElementNS("http://www.w3.org/2000/svg","path");if(c.classList.add("main-path"),c.setAttributeNS(null,"d",""),e.parentElement.insertBefore(c,e.parentElement.children[t]),1===t)e.parentElement.appendChild(a);else{const i=Array.from(e.parentElement.children).indexOf(e);l=i,e.parentElement.insertBefore(a,e.parentElement.children[i+t+1])}}else e.parentElement.appendChild(a);const d=t.slice(5),u=this.drawflow.drawflow[this.module].data[d].outputs[n].connections.findIndex((function(e,t){return e.node===i&&e.output===s}));void 0===this.drawflow.drawflow[this.module].data[d].outputs[n].connections[u].points&&(this.drawflow.drawflow[this.module].data[d].outputs[n].connections[u].points=[]),this.reroute_fix_curvature?(l>0?this.drawflow.drawflow[this.module].data[d].outputs[n].connections[u].points.splice(l,0,{pos_x:o,pos_y:r}):this.drawflow.drawflow[this.module].data[d].outputs[n].connections[u].points.push({pos_x:o,pos_y:r}),e.parentElement.querySelectorAll(".main-path").forEach((e,t)=>{e.classList.remove("selected")})):this.drawflow.drawflow[this.module].data[d].outputs[n].connections[u].points.push({pos_x:o,pos_y:r}),this.dispatch("addReroute",d),this.updateConnectionNodes(t)}removeReroutePoint(e){const t=e.parentElement.classList[2].slice(9),i=e.parentElement.classList[1].slice(13),n=e.parentElement.classList[3],s=e.parentElement.classList[4];let a=Array.from(e.parentElement.children).indexOf(e)-1;const o=t.slice(5),r=this.drawflow.drawflow[this.module].data[o].outputs[n].connections.findIndex((function(e,t){return e.node===i&&e.output===s}));if(this.reroute_fix_curvature){const t=e.parentElement.querySelectorAll(".main-path").length;e.parentElement.children[t-1].remove(),a-=t,a<0&&(a=0)}this.drawflow.drawflow[this.module].data[o].outputs[n].connections[r].points.splice(a,1),e.remove(),this.dispatch("removeReroute",o),this.updateConnectionNodes(t)}registerNode(e,t,i=null,n=null){this.noderegister[e]={html:t,props:i,options:n}}getNodeFromId(e){var t=this.getModuleFromNodeId(e);return JSON.parse(JSON.stringify(this.drawflow.drawflow[t].data[e]))}getNodesFromName(e){var t=[];const i=this.drawflow.drawflow;return Object.keys(i).map((function(n,s){for(var a in i[n].data)i[n].data[a].name==e&&t.push(i[n].data[a].id)})),t}addNode(e,t,i,n,s,a,o,r,l=!1){if(this.useuuid)var c=this.getUuid();else c=this.nodeId;const d=document.createElement("div");d.classList.add("parent-node");const u=document.createElement("div");u.innerHTML="",u.setAttribute("id","node-"+c),u.classList.add("drawflow-node"),""!=a&&u.classList.add(a);const h=document.createElement("div");h.classList.add("inputs");const p=document.createElement("div");p.classList.add("outputs");const g={};for(var f=0;f<t;f++){const e=document.createElement("div");e.classList.add("input"),e.classList.add("input_"+(f+1)),g["input_"+(f+1)]={connections:[]},h.appendChild(e)}const m={};for(f=0;f<i;f++){const e=document.createElement("div");e.classList.add("output"),e.classList.add("output_"+(f+1)),m["output_"+(f+1)]={connections:[]},p.appendChild(e)}const v=document.createElement("div");if(v.classList.add("drawflow_content_node"),!1===l)v.innerHTML=r;else if(!0===l)v.appendChild(this.noderegister[r].html.cloneNode(!0));else if(3===parseInt(this.render.version))this.render.createApp({render:e=>this.render.h(this.noderegister[r].html,this.noderegister[r].props,this.noderegister[r].options)}).mount(v);else{let e=new this.render({render:e=>e(this.noderegister[r].html,{props:this.noderegister[r].props}),...this.noderegister[r].options}).$mount();v.appendChild(e.$el)}Object.entries(o).forEach((function(e,t){if("object"==typeof e[1])!function e(t,i,n){t=null===t?o[i]:t[i],null!==t&&Object.entries(t).forEach((function(i,s){if("object"==typeof i[1])e(t,i[0],n+"-"+i[0]);else for(var a=v.querySelectorAll("[df-"+n+"-"+i[0]+"]"),o=0;o<a.length;o++)a[o].value=i[1]}))}(null,e[0],e[0]);else for(var i=v.querySelectorAll("[df-"+e[0]+"]"),n=0;n<i.length;n++)i[n].value=e[1]})),u.appendChild(h),u.appendChild(v),u.appendChild(p),u.style.top=s+"px",u.style.left=n+"px",d.appendChild(u),this.precanvas.appendChild(d);var b={id:c,name:e,data:o,class:a,html:r,typenode:l,inputs:g,outputs:m,pos_x:n,pos_y:s};return this.drawflow.drawflow[this.module].data[c]=b,this.dispatch("nodeCreated",c),this.useuuid||this.nodeId++,c}addNodeImport(e,t){const i=document.createElement("div");i.classList.add("parent-node");const n=document.createElement("div");n.innerHTML="",n.setAttribute("id","node-"+e.id),n.classList.add("drawflow-node"),""!=e.class&&n.classList.add(e.class);const s=document.createElement("div");s.classList.add("inputs");const a=document.createElement("div");a.classList.add("outputs"),Object.keys(e.inputs).map((function(i,n){const a=document.createElement("div");a.classList.add("input"),a.classList.add(i),s.appendChild(a),Object.keys(e.inputs[i].connections).map((function(n,s){var a=document.createElementNS("http://www.w3.org/2000/svg","svg"),o=document.createElementNS("http://www.w3.org/2000/svg","path");o.classList.add("main-path"),o.setAttributeNS(null,"d",""),a.classList.add("connection"),a.classList.add("node_in_node-"+e.id),a.classList.add("node_out_node-"+e.inputs[i].connections[n].node),a.classList.add(e.inputs[i].connections[n].input),a.classList.add(i),a.appendChild(o),t.appendChild(a)}))}));for(var o=0;o<Object.keys(e.outputs).length;o++){const e=document.createElement("div");e.classList.add("output"),e.classList.add("output_"+(o+1)),a.appendChild(e)}const r=document.createElement("div");if(r.classList.add("drawflow_content_node"),!1===e.typenode)r.innerHTML=e.html;else if(!0===e.typenode)r.appendChild(this.noderegister[e.html].html.cloneNode(!0));else if(3===parseInt(this.render.version))this.render.createApp({render:t=>this.render.h(this.noderegister[e.html].html,this.noderegister[e.html].props,this.noderegister[e.html].options)}).mount(r);else{let t=new this.render({render:t=>t(this.noderegister[e.html].html,{props:this.noderegister[e.html].props}),...this.noderegister[e.html].options}).$mount();r.appendChild(t.$el)}Object.entries(e.data).forEach((function(t,i){if("object"==typeof t[1])!function t(i,n,s){i=null===i?e.data[n]:i[n],null!==i&&Object.entries(i).forEach((function(e,n){if("object"==typeof e[1])t(i,e[0],s+"-"+e[0]);else for(var a=r.querySelectorAll("[df-"+s+"-"+e[0]+"]"),o=0;o<a.length;o++)a[o].value=e[1]}))}(null,t[0],t[0]);else for(var n=r.querySelectorAll("[df-"+t[0]+"]"),s=0;s<n.length;s++)n[s].value=t[1]})),n.appendChild(s),n.appendChild(r),n.appendChild(a),n.style.top=e.pos_y+"px",n.style.left=e.pos_x+"px",i.appendChild(n),this.precanvas.appendChild(i)}addRerouteImport(e){const t=this.reroute_width,i=this.reroute_fix_curvature;Object.keys(e.outputs).map((function(n,s){Object.keys(e.outputs[n].connections).map((function(s,a){const o=e.outputs[n].connections[s].points;void 0!==o&&o.forEach((a,r)=>{const l=e.outputs[n].connections[s].node,c=e.outputs[n].connections[s].output,d=document.querySelector(".connection.node_in_node-"+l+".node_out_node-"+e.id+"."+n+"."+c);if(i&&0===r)for(var u=0;u<o.length;u++){var h=document.createElementNS("http://www.w3.org/2000/svg","path");h.classList.add("main-path"),h.setAttributeNS(null,"d",""),d.appendChild(h)}const p=document.createElementNS("http://www.w3.org/2000/svg","circle");p.classList.add("point");var g=a.pos_x,f=a.pos_y;p.setAttributeNS(null,"cx",g),p.setAttributeNS(null,"cy",f),p.setAttributeNS(null,"r",t),d.appendChild(p)})}))}))}updateNodeValue(e){for(var t=e.target.attributes,i=0;i<t.length;i++)if(t[i].nodeName.startsWith("df-")){for(var n=t[i].nodeName.slice(3).split("-"),s=this.drawflow.drawflow[this.module].data[e.target.closest(".drawflow_content_node").parentElement.id.slice(5)].data,a=0;a<n.length-1;a+=1)null==s[n[a]]&&(s[n[a]]={}),s=s[n[a]];s[n[n.length-1]]=e.target.value}}updateNodeDataFromId(e,t){var i=this.getModuleFromNodeId(e);if(this.drawflow.drawflow[i].data[e].data=t,this.module===i){const i=document.querySelector("#node-"+e);Object.entries(t).forEach((function(e,n){if("object"==typeof e[1])!function e(n,s,a){n=null===n?t[s]:n[s],null!==n&&Object.entries(n).forEach((function(t,s){if("object"==typeof t[1])e(n,t[0],a+"-"+t[0]);else for(var o=i.querySelectorAll("[df-"+a+"-"+t[0]+"]"),r=0;r<o.length;r++)o[r].value=t[1]}))}(null,e[0],e[0]);else for(var s=i.querySelectorAll("[df-"+e[0]+"]"),a=0;a<s.length;a++)s[a].value=e[1]}))}}addNodeInput(e){var t=this.getModuleFromNodeId(e);const i=this.getNodeFromId(e),n=Object.keys(i.inputs).length;if(this.module===t){const t=document.createElement("div");t.classList.add("input"),t.classList.add("input_"+(n+1)),document.querySelector("#node-"+e+" .inputs").appendChild(t),this.updateConnectionNodes("node-"+e)}this.drawflow.drawflow[t].data[e].inputs["input_"+(n+1)]={connections:[]}}addNodeOutput(e){var t=this.getModuleFromNodeId(e);const i=this.getNodeFromId(e),n=Object.keys(i.outputs).length;if(this.module===t){const t=document.createElement("div");t.classList.add("output"),t.classList.add("output_"+(n+1)),document.querySelector("#node-"+e+" .outputs").appendChild(t),this.updateConnectionNodes("node-"+e)}this.drawflow.drawflow[t].data[e].outputs["output_"+(n+1)]={connections:[]}}removeNodeInput(e,t){var i=this.getModuleFromNodeId(e);const n=this.getNodeFromId(e);this.module===i&&document.querySelector("#node-"+e+" .inputs .input."+t).remove();const s=[];Object.keys(n.inputs[t].connections).map((function(i,a){const o=n.inputs[t].connections[a].node,r=n.inputs[t].connections[a].input;s.push({id_output:o,id:e,output_class:r,input_class:t})})),s.forEach((e,t)=>{this.removeSingleConnection(e.id_output,e.id,e.output_class,e.input_class)}),delete this.drawflow.drawflow[i].data[e].inputs[t];const a=[],o=this.drawflow.drawflow[i].data[e].inputs;Object.keys(o).map((function(e,t){a.push(o[e])})),this.drawflow.drawflow[i].data[e].inputs={};const r=t.slice(6);let l=[];a.forEach((t,n)=>{t.connections.forEach((e,t)=>{l.push(e)}),this.drawflow.drawflow[i].data[e].inputs["input_"+(n+1)]=t}),l=new Set(l.map(e=>JSON.stringify(e))),l=Array.from(l).map(e=>JSON.parse(e)),this.module===i&&document.querySelectorAll("#node-"+e+" .inputs .input").forEach((e,t)=>{const i=e.classList[1].slice(6);parseInt(r)<parseInt(i)&&(e.classList.remove("input_"+i),e.classList.add("input_"+(i-1)))}),l.forEach((t,n)=>{this.drawflow.drawflow[i].data[t.node].outputs[t.input].connections.forEach((n,s)=>{if(n.node==e){const a=n.output.slice(6);if(parseInt(r)<parseInt(a)){if(this.module===i){const i=document.querySelector(".connection.node_in_node-"+e+".node_out_node-"+t.node+"."+t.input+".input_"+a);i.classList.remove("input_"+a),i.classList.add("input_"+(a-1))}n.points?this.drawflow.drawflow[i].data[t.node].outputs[t.input].connections[s]={node:n.node,output:"input_"+(a-1),points:n.points}:this.drawflow.drawflow[i].data[t.node].outputs[t.input].connections[s]={node:n.node,output:"input_"+(a-1)}}}})}),this.updateConnectionNodes("node-"+e)}removeNodeOutput(e,t){var i=this.getModuleFromNodeId(e);const n=this.getNodeFromId(e);this.module===i&&document.querySelector("#node-"+e+" .outputs .output."+t).remove();const s=[];Object.keys(n.outputs[t].connections).map((function(i,a){const o=n.outputs[t].connections[a].node,r=n.outputs[t].connections[a].output;s.push({id:e,id_input:o,output_class:t,input_class:r})})),s.forEach((e,t)=>{this.removeSingleConnection(e.id,e.id_input,e.output_class,e.input_class)}),delete this.drawflow.drawflow[i].data[e].outputs[t];const a=[],o=this.drawflow.drawflow[i].data[e].outputs;Object.keys(o).map((function(e,t){a.push(o[e])})),this.drawflow.drawflow[i].data[e].outputs={};const r=t.slice(7);let l=[];a.forEach((t,n)=>{t.connections.forEach((e,t)=>{l.push({node:e.node,output:e.output})}),this.drawflow.drawflow[i].data[e].outputs["output_"+(n+1)]=t}),l=new Set(l.map(e=>JSON.stringify(e))),l=Array.from(l).map(e=>JSON.parse(e)),this.module===i&&document.querySelectorAll("#node-"+e+" .outputs .output").forEach((e,t)=>{const i=e.classList[1].slice(7);parseInt(r)<parseInt(i)&&(e.classList.remove("output_"+i),e.classList.add("output_"+(i-1)))}),l.forEach((t,n)=>{this.drawflow.drawflow[i].data[t.node].inputs[t.output].connections.forEach((n,s)=>{if(n.node==e){const a=n.input.slice(7);if(parseInt(r)<parseInt(a)){if(this.module===i){const i=document.querySelector(".connection.node_in_node-"+t.node+".node_out_node-"+e+".output_"+a+"."+t.output);i.classList.remove("output_"+a),i.classList.remove(t.output),i.classList.add("output_"+(a-1)),i.classList.add(t.output)}n.points?this.drawflow.drawflow[i].data[t.node].inputs[t.output].connections[s]={node:n.node,input:"output_"+(a-1),points:n.points}:this.drawflow.drawflow[i].data[t.node].inputs[t.output].connections[s]={node:n.node,input:"output_"+(a-1)}}}})}),this.updateConnectionNodes("node-"+e)}removeNodeId(e){this.removeConnectionNodeId(e);var t=this.getModuleFromNodeId(e.slice(5));this.module===t&&this.container.querySelector("#"+e).remove(),delete this.drawflow.drawflow[t].data[e.slice(5)],this.dispatch("nodeRemoved",e.slice(5))}removeConnection(){if(null!=this.connection_selected){var e=this.connection_selected.parentElement.classList;this.connection_selected.parentElement.remove();var t=this.drawflow.drawflow[this.module].data[e[2].slice(14)].outputs[e[3]].connections.findIndex((function(t,i){return t.node===e[1].slice(13)&&t.output===e[4]}));this.drawflow.drawflow[this.module].data[e[2].slice(14)].outputs[e[3]].connections.splice(t,1);var i=this.drawflow.drawflow[this.module].data[e[1].slice(13)].inputs[e[4]].connections.findIndex((function(t,i){return t.node===e[2].slice(14)&&t.input===e[3]}));this.drawflow.drawflow[this.module].data[e[1].slice(13)].inputs[e[4]].connections.splice(i,1),this.dispatch("connectionRemoved",{output_id:e[2].slice(14),input_id:e[1].slice(13),output_class:e[3],input_class:e[4]}),this.connection_selected=null}}removeSingleConnection(e,t,i,n){var s=this.getModuleFromNodeId(e);if(s===this.getModuleFromNodeId(t)){if(this.drawflow.drawflow[s].data[e].outputs[i].connections.findIndex((function(e,i){return e.node==t&&e.output===n}))>-1){this.module===s&&document.querySelector(".connection.node_in_node-"+t+".node_out_node-"+e+"."+i+"."+n).remove();var a=this.drawflow.drawflow[s].data[e].outputs[i].connections.findIndex((function(e,i){return e.node==t&&e.output===n}));this.drawflow.drawflow[s].data[e].outputs[i].connections.splice(a,1);var o=this.drawflow.drawflow[s].data[t].inputs[n].connections.findIndex((function(t,n){return t.node==e&&t.input===i}));return this.drawflow.drawflow[s].data[t].inputs[n].connections.splice(o,1),this.dispatch("connectionRemoved",{output_id:e,input_id:t,output_class:i,input_class:n}),!0}return!1}return!1}removeConnectionNodeId(e){const t="node_in_"+e,i="node_out_"+e,n=this.container.querySelectorAll("."+i);for(var s=n.length-1;s>=0;s--){var a=n[s].classList,o=this.drawflow.drawflow[this.module].data[a[1].slice(13)].inputs[a[4]].connections.findIndex((function(e,t){return e.node===a[2].slice(14)&&e.input===a[3]}));this.drawflow.drawflow[this.module].data[a[1].slice(13)].inputs[a[4]].connections.splice(o,1);var r=this.drawflow.drawflow[this.module].data[a[2].slice(14)].outputs[a[3]].connections.findIndex((function(e,t){return e.node===a[1].slice(13)&&e.output===a[4]}));this.drawflow.drawflow[this.module].data[a[2].slice(14)].outputs[a[3]].connections.splice(r,1),n[s].remove(),this.dispatch("connectionRemoved",{output_id:a[2].slice(14),input_id:a[1].slice(13),output_class:a[3],input_class:a[4]})}const l=this.container.querySelectorAll("."+t);for(s=l.length-1;s>=0;s--)a=l[s].classList,r=this.drawflow.drawflow[this.module].data[a[2].slice(14)].outputs[a[3]].connections.findIndex((function(e,t){return e.node===a[1].slice(13)&&e.output===a[4]})),this.drawflow.drawflow[this.module].data[a[2].slice(14)].outputs[a[3]].connections.splice(r,1),o=this.drawflow.drawflow[this.module].data[a[1].slice(13)].inputs[a[4]].connections.findIndex((function(e,t){return e.node===a[2].slice(14)&&e.input===a[3]})),this.drawflow.drawflow[this.module].data[a[1].slice(13)].inputs[a[4]].connections.splice(o,1),l[s].remove(),this.dispatch("connectionRemoved",{output_id:a[2].slice(14),input_id:a[1].slice(13),output_class:a[3],input_class:a[4]})}getModuleFromNodeId(e){var t;const i=this.drawflow.drawflow;return Object.keys(i).map((function(n,s){Object.keys(i[n].data).map((function(i,s){i==e&&(t=n)}))})),t}addModule(e){this.drawflow.drawflow[e]={data:{}},this.dispatch("moduleCreated",e)}changeModule(e){this.dispatch("moduleChanged",e),this.module=e,this.precanvas.innerHTML="",this.canvas_x=0,this.canvas_y=0,this.pos_x=0,this.pos_y=0,this.mouse_x=0,this.mouse_y=0,this.zoom=1,this.zoom_last_value=1,this.precanvas.style.transform="",this.import(this.drawflow)}removeModule(e){this.module===e&&this.changeModule("Home"),delete this.drawflow.drawflow[e],this.dispatch("moduleRemoved",e)}clearModuleSelected(){this.precanvas.innerHTML="",this.drawflow.drawflow[this.module]={data:{}}}clear(){this.precanvas.innerHTML="",this.drawflow={drawflow:{Home:{data:{}}}}}export(){const e=JSON.parse(JSON.stringify(this.drawflow));return this.dispatch("export",e),e}import(e){this.clear(),this.drawflow=JSON.parse(JSON.stringify(e)),this.load(),this.dispatch("import","import")}on(e,t){return"function"!=typeof t?(console.error("The listener callback must be a function, the given type is "+typeof t),!1):"string"!=typeof e?(console.error("The event name must be a string, the given type is "+typeof e),!1):(void 0===this.events[e]&&(this.events[e]={listeners:[]}),void this.events[e].listeners.push(t))}removeListener(e,t){if(void 0===this.events[e])return!1;this.events[e].listeners=this.events[e].listeners.filter(e=>e.toString()!==t.toString())}dispatch(e,t){if(void 0===this.events[e])return!1;this.events[e].listeners.forEach(e=>{e(t)})}getUuid(){for(var e=[],t=0;t<36;t++)e[t]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]="0123456789abcdef".substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")}}}]).default}))},"545e":function(e,t,i){"use strict";i("10d0")},"687e":function(e,t,i){"use strict";var n=i("7a23");const s={class:"row"},a={class:"col-6"},o=Object(n["createVNode"])("label",{for:"botName",class:"col-form-label"},"Bot Name:",-1),r={class:"col"},l={class:"float-start"},c=Object(n["createVNode"])("div",null,[Object(n["createVNode"])("label",{for:"botFrequency",class:"col-form-label"},"Every")],-1),d={class:"float-start col-5 select-df"},u={class:"col-auto align-items-center text-end",style:{"padding-top":"32px"}},h={key:0,class:"text-warning fas fa-exclamation-triangle mr-2"},p=Object(n["createVNode"])("i",{class:"fas fa-eraser"},null,-1),g=Object(n["createTextVNode"])(" Clear "),f={key:0,class:"bar-zoom"};function m(e,t){const i=Object(n["resolveComponent"])("vue-number-input"),m=Object(n["resolveComponent"])("Multiselect");return Object(n["openBlock"])(),Object(n["createBlock"])(n["Fragment"],null,[Object(n["createVNode"])("div",null,[Object(n["createVNode"])("div",s,[Object(n["createVNode"])("div",a,[o,Object(n["withDirectives"])(Object(n["createVNode"])("input",{onKeyup:t[1]||(t[1]=(...t)=>e.validationStatusCheck&&e.validationStatusCheck(...t)),class:[e.v$.botName.$invalid?"border-warning":"","form-control"],type:"text","onUpdate:modelValue":t[2]||(t[2]=t=>e.botName=t),placeholder:"bot name...",id:"botName","aria-describedby":"botNameHelp"},null,34),[[n["vModelText"],e.botName]]),Object(n["createVNode"])("div",null,[Object(n["createVNode"])("span",{id:"botNameHelp",class:e.v$.botName.$invalid?"form-text text-warning":"form-text"}," Must be 5-20 characters long. ",2)])]),Object(n["createVNode"])("div",r,[Object(n["createVNode"])("div",l,[c,Object(n["createVNode"])(i,{attrs:{id:"botFrequency",tabindex:-1},"model-value":e.botFrequency,"onUpdate:modelValue":e.onFrequencyChange,min:1,size:"small",inputtable:!0,inline:"",controls:""},null,8,["model-value","onUpdate:modelValue"])]),Object(n["createVNode"])("div",d,[Object(n["createVNode"])(m,{onChange:e.frequencyUnitChange,canDeselect:!1,required:!0,canClear:!1,modelValue:e.botFrequencyUnit,"onUpdate:modelValue":t[3]||(t[3]=t=>e.botFrequencyUnit=t),options:e.scheduleOptions},null,8,["onChange","modelValue","options"])])]),Object(n["createVNode"])("div",u,[e.validationStatus?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])("i",h)),Object(n["createVNode"])("button",{onClick:t[4]||(t[4]=(...t)=>e.clearBot&&e.clearBot(...t)),type:"button",class:"ml-2 boto-button medium muted"},[p,g])])])]),Object(n["createVNode"])("div",{ref:e.editorId,id:e.editorId,class:"drawflowContainer",style:{height:"80%"},onDrop:t[5]||(t[5]=(...t)=>e.drop&&e.drop(...t)),onDragover:t[6]||(t[6]=(...t)=>e.allowDrop&&e.allowDrop(...t))},null,40,["id"]),e.showZoom?(Object(n["openBlock"])(),Object(n["createBlock"])("div",f,[Object(n["createVNode"])("i",{class:"fas fa-search-minus cursor-pointer",onClick:t[7]||(t[7]=e=>this.editor.zoom_out())}),Object(n["createVNode"])("i",{class:"fas fa-search cursor-pointer",onClick:t[8]||(t[8]=e=>this.editor.zoom_reset())}),Object(n["createVNode"])("i",{class:"fas fa-search-plus cursor-pointer",onClick:t[9]||(t[9]=e=>this.editor.zoom_in())})])):Object(n["createCommentVNode"])("",!0)],64)}var v=i("9ab4");const b={class:"title-box px-2 pt-1"},y={class:"text-muted"},w=Object(n["createTextVNode"])(),O={key:0,class:"text-warning fas fa-exclamation-triangle"},_={class:"text-end px-2"};function C(e,t){const i=Object(n["resolveComponent"])("block-properties");return Object(n["openBlock"])(),Object(n["createBlock"])("div",{class:e.blockOnError?"block-error":""},[Object(n["createVNode"])("div",b,[Object(n["createVNode"])("i",{class:e.logo_class},null,2),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.nodeName)+" ",1),Object(n["createVNode"])("small",y,"("+Object(n["toDisplayString"])(e.uid)+")",1),w,e.blockOnError?(Object(n["openBlock"])(),Object(n["createBlock"])("i",O)):Object(n["createCommentVNode"])("",!0)]),Object(n["createVNode"])("div",_,[Object(n["createVNode"])("a",{onClick:t[1]||(t[1]=t=>e.toggleSettings()),class:"fas fa-cog text-white"})]),Object(n["createVNode"])(i,{key:e.id,show:e.showProperties,blockId:e.uid,type:e.type,uid:e.uid,ctx:e.context,botContext:e.botContext,parameters:e.parameters,onClose:t[2]||(t[2]=t=>e.toggleSettings(!1))},null,8,["show","blockId","type","uid","ctx","botContext","parameters"])],2)}const x={key:0},j={key:0,class:"form-group mt-2"},T={key:1,class:"form-group mt-2"},N={key:2,class:"form-group mt-2"},D=Object(n["createVNode"])("br",null,null,-1),S={key:3,class:"form-group mt-2"},E={key:4,class:"form-group mt-2"},k={key:5,class:"form-group mt-2"};function B(e,t){const i=Object(n["resolveComponent"])("TextProperty");return Object(n["openBlock"])(),Object(n["createBlock"])(n["Transition"],{name:"modal"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])("div",{class:["modal-mask p-2",e.show?"":"d-none"]},[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(e.parameters,s=>(Object(n["openBlock"])(),Object(n["createBlock"])("div",null,[Object(n["createVNode"])("label",{for:e.form[s.slug],class:"text-left primary mt-1"},[Object(n["createTextVNode"])(Object(n["toDisplayString"])(s.name)+" ",1),s.mandatory?(Object(n["openBlock"])(),Object(n["createBlock"])("span",x,"*")):Object(n["createCommentVNode"])("",!0)],8,["for"]),"STR"===s.type?(Object(n["openBlock"])(),Object(n["createBlock"])("div",j,[Object(n["createVNode"])(i,{settings:e.tagifyStuff.tagifySettings,class:"form-control",mode:"input",name:s.slug,id:s.slug,modelValue:e.form[s.slug],"onUpdate:modelValue":t=>e.form[s.slug]=t,value:e.form[s.slug],placeholder:s.placeholder,onChange:e.change},null,8,["settings","name","id","modelValue","onUpdate:modelValue","value","placeholder","onChange"]),Object(n["createVNode"])("small",{id:s.name+"Help",class:"form-text text-muted"},Object(n["toDisplayString"])(s.description),9,["id"])])):Object(n["createCommentVNode"])("",!0),"TXT"===s.type?(Object(n["openBlock"])(),Object(n["createBlock"])("div",T,[Object(n["createVNode"])(i,{settings:e.tagifyStuff.tagifySettings,mode:"textarea",name:s.slug,id:s.slug,value:e.form[s.slug],onChange:e.change},null,8,["settings","name","id","value","onChange"]),Object(n["createVNode"])("small",{id:s.name+"Help",class:"form-text text-muted"},Object(n["toDisplayString"])(s.description),9,["id"])])):Object(n["createCommentVNode"])("",!0),"LIS"===s.type?(Object(n["openBlock"])(),Object(n["createBlock"])("div",N,[Object(n["withDirectives"])(Object(n["createVNode"])("select",{"onUpdate:modelValue":t=>e.form[s.slug]=t,id:s.slug,onChange:t[1]||(t[1]=(...t)=>e.change&&e.change(...t))},[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(s.list_values,e=>(Object(n["openBlock"])(),Object(n["createBlock"])("option",{value:e.value},Object(n["toDisplayString"])(e.label),9,["value"]))),256))],40,["onUpdate:modelValue","id"]),[[n["vModelSelect"],e.form[s.slug]]]),D,Object(n["createVNode"])("small",{id:s.slug+"Help",class:"form-text text-muted"},Object(n["toDisplayString"])(s.description),9,["id"])])):Object(n["createCommentVNode"])("",!0),"BOO"===s.type?(Object(n["openBlock"])(),Object(n["createBlock"])("div",S,[Object(n["withDirectives"])(Object(n["createVNode"])("input",{onChange:t[2]||(t[2]=(...t)=>e.change&&e.change(...t)),ref:s.slug,"onUpdate:modelValue":t=>e.form[s.slug]=t,value:"true",type:"checkbox",name:s.slug,id:s.slug,"aria-describedby":s.name},null,40,["onUpdate:modelValue","name","id","aria-describedby"]),[[n["vModelCheckbox"],e.form[s.slug]]])])):Object(n["createCommentVNode"])("",!0),"DAT"===s.type?(Object(n["openBlock"])(),Object(n["createBlock"])("div",E,[Object(n["withDirectives"])(Object(n["createVNode"])("input",{onInput:t[3]||(t[3]=(...t)=>e.change&&e.change(...t)),"onUpdate:modelValue":t=>e.form[s.slug]=t,type:"date",class:"form-control",name:s.slug,id:s.slug,"aria-describedby":s.name,placeholder:s.placeholder},null,40,["onUpdate:modelValue","name","id","aria-describedby","placeholder"]),[[n["vModelText"],e.form[s.slug]]]),Object(n["createVNode"])("small",{id:s.name+"Help",class:"form-text text-muted"},Object(n["toDisplayString"])(s.description),9,["id"])])):Object(n["createCommentVNode"])("",!0),"NUM"===s.type?(Object(n["openBlock"])(),Object(n["createBlock"])("div",k,[Object(n["withDirectives"])(Object(n["createVNode"])("input",{onInput:t[4]||(t[4]=(...t)=>e.change&&e.change(...t)),"onUpdate:modelValue":t=>e.form[s.slug]=t,type:"number",class:"form-control",name:s.slug,id:s.slug,"aria-describedby":s.name,placeholder:s.placeholder},null,40,["onUpdate:modelValue","name","id","aria-describedby","placeholder"]),[[n["vModelText"],e.form[s.slug]]]),Object(n["createVNode"])("small",{id:s.name+"Help",class:"form-text text-muted"},Object(n["toDisplayString"])(s.description),9,["id"])])):Object(n["createCommentVNode"])("",!0)]))),256))],2)]),_:1})}var L=i("94c2");function $(e,t){return"textarea"===e.mode?(Object(n["openBlock"])(),Object(n["createBlock"])("textarea",{key:0,name:this.$props.name,id:this.$props.id,onChange:t[1]||(t[1]=(...t)=>e.onChange&&e.onChange(...t))},null,40,["name","id"])):(Object(n["openBlock"])(),Object(n["createBlock"])("input",{key:1,name:this.$props.name,id:this.$props.id,class:"textPropertyInput",onChange:t[2]||(t[2]=(...t)=>e.onChange&&e.onChange(...t))},null,40,["name","id"]))}var A=i("d26e"),M=i.n(A),R=(i("3db7"),null),I=Object(n["defineComponent"])({name:"Tags",props:{mode:String,settings:Object,name:String,id:String,value:[String,Array],onChange:Function},data:function(){return{tagify:R}},watch:{value:function(e){var t=this;t.tagify.loadOriginalValues(e)},settings:{deep:!0,handler:function(e){this.tagify.settings.whitelist=e.whitelist,this.tagify.loadOriginalValues(this.$props.value)}}},mounted:function(){this.tagify=new M.a(this.$el,this.settings)}});i("41e3");I.render=$;var V=I,F=!0;function q(e){return q="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function z(e,t,i){return t&&H(e.prototype,t),i&&H(e,i),e}function W(e){return U(e)||X(e)||K(e)||Y()}function U(e){if(Array.isArray(e))return J(e)}function X(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function K(e,t){if(e){if("string"===typeof e)return J(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?J(e,t):void 0}}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Y(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function G(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object.keys(e).reduce((function(i,s){return t.includes(s)||(i[s]=Object(n["unref"])(e[s])),i}),{})}function Q(e){return"function"===typeof e}function Z(e){return Object(n["isReactive"])(e)||Object(n["isReadonly"])(e)}function ee(e,t,i){if(i)return t?t(e()):e();try{var n=Promise.resolve(e());return t?n.then(t):n}catch(s){return Promise.reject(s)}}var te="__root";function ie(e){return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];try{return Promise.resolve(e.apply(this,t))}catch(n){return Promise.reject(n)}}}function ne(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(n["unref"])(e),i=Object.keys(t),s={},a={},o={};return i.forEach((function(e){var i=t[e];switch(!0){case Q(i.$validator):s[e]=i;break;case Q(i):s[e]={$validator:i};break;case e.startsWith("$"):o[e]=i;break;default:a[e]=i}})),{rules:s,nestedValidators:a,config:o}}function se(e,t,i){var s=Object(n["unref"])(t);return e.call(i,s,i)}function ae(e){return void 0!==e.$valid?!e.$valid:!e}function oe(e,t,i,s,a,o,r){var l=a.$lazy,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],d=Object(n["ref"])(!!s.value),u=Object(n["ref"])(0);i.value=!1;var h=Object(n["watch"])([t,s].concat(c),(function(){if(l&&!s.value)return!1;var n;try{n=se(e,t,r)}catch(a){n=Promise.reject(a)}u.value++,i.value=!!u.value,d.value=!0,Promise.resolve(n).then((function(e){u.value--,i.value=!!u.value,o.value=e,d.value=ae(e)}))["catch"]((function(e){u.value--,i.value=!!u.value,o.value=e,d.value=!0}))}),{immediate:!0,deep:"object"===q(t)});return{$invalid:d,$unwatch:h}}function re(e,t,i,s,a,o){var r=s.$lazy,l=function(){return{}},c=Object(n["computed"])((function(){if(r&&!i.value)return!1;try{var n=se(e,t,o);return a.value=n,ae(n)}catch(s){a.value=s}return!0}));return{$unwatch:l,$invalid:c}}function le(e,t,i,s,a,o,r,l){var c,d,u=Object(n["ref"])(!1),h=e.$params||{},p=Object(n["ref"])(null);if(e.$async){var g=oe(e.$validator,t,u,i,s,p,a,e.$watchTargets);c=g.$invalid,d=g.$unwatch}else{var f=re(e.$validator,t,i,s,p,a);c=f.$invalid,d=f.$unwatch}var m=e.$message,v=Q(m)?Object(n["computed"])((function(){return m(G({$pending:u,$invalid:c,$params:G(h),$model:t,$response:p,$validator:o,$propertyPath:l,$property:r}))})):m||"";return{$message:v,$params:h,$pending:u,$invalid:c,$response:p,$unwatch:d}}function ce(e,t,i,s,a,o,r,l){var c=Object.keys(e),d=s.get(a,e),u=Object(n["ref"])(!1);if(d){if(!d.$partial)return d;d.$unwatch(),u.value=d.$dirty.value}var h={$dirty:u,$path:a,$touch:function(){u.value||(u.value=!0)},$reset:function(){u.value&&(u.value=!1)}};return c.length?(c.forEach((function(n){h[n]=le(e[n],t,h.$dirty,o,r,n,i,a)})),h.$externalResults=Object(n["computed"])((function(){return l.value?[].concat(l.value).map((function(e,t){return{$propertyPath:a,$property:i,$validator:"$externalResults",$uid:"".concat(a,"-").concat(t),$message:e,$params:{},$response:null,$pending:!1}})):[]})),h.$invalid=Object(n["computed"])((function(){return!!h.$externalResults.value.length||c.some((function(e){return Object(n["unref"])(h[e].$invalid)}))})),h.$pending=Object(n["computed"])((function(){return c.some((function(e){return Object(n["unref"])(h[e].$pending)}))})),h.$error=Object(n["computed"])((function(){return h.$invalid.value&&h.$dirty.value})),h.$silentErrors=Object(n["computed"])((function(){return c.filter((function(e){return Object(n["unref"])(h[e].$invalid)})).map((function(e){var t=h[e];return Object(n["reactive"])({$propertyPath:a,$property:i,$validator:e,$uid:"".concat(a,"-").concat(e),$message:t.$message,$params:t.$params,$response:t.$response,$pending:t.$pending})})).concat(h.$externalResults.value)})),h.$errors=Object(n["computed"])((function(){return h.$dirty.value?h.$silentErrors.value:[]})),h.$unwatch=function(){return c.forEach((function(e){h[e].$unwatch()}))},s.set(a,e,h),h):(d&&s.set(a,e,h),h)}function de(e,t,i,n,s,a,o){var r=Object.keys(e);return r.length?r.reduce((function(r,l){return r[l]=he({validations:e[l],state:t,key:l,parentKey:i,resultsCache:n,globalConfig:s,instance:a,externalResults:o}),r}),{}):{}}function ue(e,t,i){var s=Object(n["computed"])((function(){return[t,i].filter((function(e){return e})).reduce((function(e,t){return e.concat(Object.values(Object(n["unref"])(t)))}),[])})),a=Object(n["computed"])({get:function(){return e.$dirty.value||!!s.value.length&&s.value.every((function(e){return e.$dirty}))},set:function(t){e.$dirty.value=t}}),o=Object(n["computed"])((function(){var t=Object(n["unref"])(e.$silentErrors)||[],i=s.value.filter((function(e){return(Object(n["unref"])(e).$silentErrors||[]).length})).reduce((function(e,t){return e.concat.apply(e,W(t.$silentErrors))}),[]);return t.concat(i)})),r=Object(n["computed"])((function(){var t=Object(n["unref"])(e.$errors)||[],i=s.value.filter((function(e){return(Object(n["unref"])(e).$errors||[]).length})).reduce((function(e,t){return e.concat.apply(e,W(t.$errors))}),[]);return t.concat(i)})),l=Object(n["computed"])((function(){return s.value.some((function(e){return e.$invalid}))||Object(n["unref"])(e.$invalid)||!1})),c=Object(n["computed"])((function(){return s.value.some((function(e){return Object(n["unref"])(e.$pending)}))||Object(n["unref"])(e.$pending)||!1})),d=Object(n["computed"])((function(){return s.value.some((function(e){return e.$dirty}))||s.value.some((function(e){return e.$anyDirty}))||a.value})),u=Object(n["computed"])((function(){return l.value&&a.value||!1})),h=function(){e.$touch(),s.value.forEach((function(e){e.$touch()}))},p=function(){e.$reset(),s.value.forEach((function(e){e.$reset()}))};return s.value.length&&s.value.every((function(e){return e.$dirty}))&&h(),{$dirty:a,$errors:r,$invalid:l,$anyDirty:d,$error:u,$pending:c,$touch:h,$reset:p,$silentErrors:o}}function he(e){var t=e.validations,i=e.state,s=e.key,a=e.parentKey,o=e.childResults,r=e.resultsCache,l=e.globalConfig,c=void 0===l?{}:l,d=e.instance,u=e.externalResults,h=a?"".concat(a,".").concat(s):s,p=ne(t),g=p.rules,f=p.nestedValidators,m=p.config,v=Object.assign({},c,m),b=s?Object(n["computed"])((function(){var e=Object(n["unref"])(i);return e?Object(n["unref"])(e[s]):void 0})):i,y=Object.assign({},Object(n["unref"])(u)||{}),w=Object(n["computed"])((function(){var e=Object(n["unref"])(u);return s?e?Object(n["unref"])(e[s]):void 0:e})),O=ce(g,b,s,r,h,v,d,w),_=de(f,b,h,r,v,d,w),C=ue(O,_,o),x=C.$dirty,j=C.$errors,T=C.$invalid,N=C.$anyDirty,D=C.$error,S=C.$pending,E=C.$touch,k=C.$reset,B=C.$silentErrors,L=s?Object(n["computed"])({get:function(){return Object(n["unref"])(b)},set:function(e){x.value=!0;var t=Object(n["unref"])(i);Object(n["isRef"])(t[s])?t[s].value=e:t[s]=e}}):null;if(s&&v.$autoDirty)var $=Object(n["watch"])(b,(function(){var e="_".concat(h,"_$watcher_"),t=r.get(e,{});x.value||E(),t&&t.$unwatch(),r.set(e,{},{$unwatch:$})}),{flush:"sync"});function A(){return new Promise(ie((function(e){return x.value||E(),ee(n["nextTick"],(function(){if(!S.value)return e(!T.value);var t=Object(n["watch"])(S,(function(){e(!T.value),t()}))}))})))}function M(e){return(o.value||{})[e]}function R(){Object(n["isRef"])(u)?u.value=y:0===Object.keys(y).length?Object.keys(u).forEach((function(e){delete u[e]})):Object.assign(u,y)}return Object(n["reactive"])(Object.assign({},O,{$model:L,$dirty:x,$error:D,$errors:j,$invalid:T,$anyDirty:N,$pending:S,$touch:E,$reset:k,$path:h||te,$silentErrors:B},o&&{$getResultsForChild:M,$validate:A,$clearExternalResults:R},_))}var pe=function(){function e(){P(this,e),this.storage=new Map}return z(e,[{key:"set",value:function(e,t,i){this.storage.set(e,{rules:t,result:i})}},{key:"checkRulesValidity",value:function(e,t,i){var s=Object.keys(i),a=Object.keys(t);if(a.length!==s.length)return!1;var o=a.every((function(e){return s.includes(e)}));return!!o&&a.every((function(e){return!t[e].$params||Object.keys(t[e].$params).every((function(s){return Object(n["unref"])(i[e].$params[s])===Object(n["unref"])(t[e].$params[s])}))}))}},{key:"get",value:function(e,t){var i=this.storage.get(e);if(i){var n=i.rules,s=i.result,a=this.checkRulesValidity(e,t,n),o=s.$unwatch?s.$unwatch:function(){return{}};return a?s:{$dirty:s.$dirty,$partial:!0,$unwatch:o}}}}]),e}(),ge=Symbol("vuelidate#injectChiildResults"),fe=Symbol("vuelidate#removeChiildResults"),me={COLLECT_ALL:!0,COLLECT_NONE:!1};function ve(e){var t=e.$scope,i={},s=Object(n["ref"])([]),a=Object(n["computed"])((function(){return s.value.reduce((function(e,t){return e[t]=Object(n["unref"])(i[t]),e}),{})}));function o(e,n){var a=n.$registerAs,o=n.$scope,r=n.$stopPropagation;r||t===me.COLLECT_NONE||o===me.COLLECT_NONE||t!==me.COLLECT_ALL&&t!==o||(i[a]=e,s.value.push(a))}function r(e){s.value=s.value.filter((function(t){return t!==e})),delete i[e]}var l=Object(n["inject"])(ge,(function(){}));Object(n["provide"])(ge,o);var c=Object(n["inject"])(fe,(function(){}));return Object(n["provide"])(fe,r),{childResults:a,sendValidationResultsToParent:l,removeValidationResultsFromParent:c}}function be(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};1===arguments.length&&(i=e,e=void 0,t=void 0);var s=i,a=s.$registerAs,o=s.$scope,r=void 0===o?me.COLLECT_ALL:o,l=s.$stopPropagation,c=s.$externalResults,d=Object(n["getCurrentInstance"])(),u=d?F?d.type:d.proxy.$options:{};if(!a&&d){var h=d.uid||d._uid;a="_vuelidate_".concat(h)}var p=Object(n["ref"])({}),g=new pe,f=d?ve({$scope:r}):{childResults:Object(n["ref"])({})},m=f.childResults,v=f.sendValidationResultsToParent,b=f.removeValidationResultsFromParent;if(!e&&u.validations){var y=u.validations;t=Object(n["ref"])({}),Object(n["onBeforeMount"])((function(){function e(t){return new Proxy(t,{get:function(t,i,s){return"object"===q(t[i])?e(t[i]):Object(n["computed"])((function(){return t[i]}))}})}t.value=d.proxy,Object(n["watch"])((function(){return Q(y)?y.call(t.value,new e(t.value)):y}),(function(e){p.value=he({validations:e,state:t,childResults:m,resultsCache:g,globalConfig:i,instance:d.proxy,externalResults:d.proxy.vuelidateExternalResults})}),{immediate:!0})})),i=u.validationsConfig||{}}else{var w=Object(n["isRef"])(e)||Z(e)?e:Object(n["reactive"])(e||{});Object(n["watch"])(w,(function(e){p.value=he({validations:e,state:t,childResults:m,resultsCache:g,globalConfig:i,instance:d?d.proxy:{},externalResults:c})}),{immediate:!0})}return d&&(v(p,{$registerAs:a,$scope:r,$stopPropagation:l}),Object(n["onBeforeUnmount"])((function(){return b(a)}))),Object(n["computed"])((function(){return Object.assign({},Object(n["unref"])(p.value),m.value)}))}var ye=be;function we(e){return we="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(e)}function Oe(e,t){return _e(e)||Ce(e,t)||xe(e,t)||Te()}function _e(e){if(Array.isArray(e))return e}function Ce(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var i=[],n=!0,s=!1,a=void 0;try{for(var o,r=e[Symbol.iterator]();!(n=(o=r.next()).done);n=!0)if(i.push(o.value),t&&i.length===t)break}catch(l){s=!0,a=l}finally{try{n||null==r["return"]||r["return"]()}finally{if(s)throw a}}return i}}function xe(e,t){if(e){if("string"===typeof e)return je(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?je(e,t):void 0}}function je(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Te(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ne(e){return"function"===typeof e}function De(e){return null!==e&&"object"===we(e)&&!Array.isArray(e)}function Se(e){return Ne(e.$validator)?Object.assign({},e):{$validator:e}}function Ee(e){return"object"===we(e)?e.$valid:e}function ke(e){return e.$validator||e}function Be(e,t){if(!De(e))throw new Error('[@vuelidate/validators]: First parameter to "withParams" should be an object, provided '.concat(we(e)));if(!De(t)&&!Ne(t))throw new Error("[@vuelidate/validators]: Validator must be a function or object with $validator parameter");var i=Se(t);return i.$params=Object.assign({},i.$params||{},e),i}function Le(e,t){if(!Ne(e)&&"string"!==typeof Object(n["unref"])(e))throw new Error('[@vuelidate/validators]: First parameter to "withMessage" should be string or a function returning a string, provided '.concat(we(e)));if(!De(t)&&!Ne(t))throw new Error("[@vuelidate/validators]: Validator must be a function or object with $validator parameter");var i=Se(t);return i.$message=e,i}function $e(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=Se(e);return Object.assign({},i,{$async:!0,$watchTargets:t})}function Ae(e){return{$validator:function(t){for(var i=this,s=arguments.length,a=new Array(s>1?s-1:0),o=1;o<s;o++)a[o-1]=arguments[o];return Object(n["unref"])(t).reduce((function(t,n){var s=Object.entries(n).reduce((function(t,n){var s=Oe(n,2),o=s[0],r=s[1],l=e[o],c=Object.entries(l).reduce((function(e,t){var n=Oe(t,2),s=n[0],l=n[1],c=ke(l),d=c.call.apply(c,[i,r].concat(a)),u=Ee(d);if(e.$data[s]=d,!u){var h=l.$message||"",p=l.$params||{};"function"===typeof h&&(h=h({$pending:!1,$invalid:!u,$params:p,$model:r,$response:d})),e.$errors.push({$property:o,$message:h,$params:p,$response:d,$model:r,$pending:!1,$validator:s})}return{$valid:e.$valid&&u,$data:e.$data,$errors:e.$errors}}),{$valid:!0,$data:{},$errors:[]});return t.$data[o]=c.$data,t.$errors[o]=c.$errors,{$valid:t.$valid&&c.$valid,$data:t.$data,$errors:t.$errors}}),{$valid:!0,$data:{},$errors:{}});return{$valid:t.$valid&&s.$valid,$data:t.$data.concat(s.$data),$errors:t.$errors.concat(s.$errors)}}),{$valid:!0,$data:[],$errors:[]})},$message:function(e){var t=e.$response;return t?t.$errors.map((function(e){return Object.values(e).map((function(e){return e.map((function(e){return e.$message}))})).reduce((function(e,t){return e.concat(t)}),[])})):[]}}}var Me=function(e){if(e=Object(n["unref"])(e),Array.isArray(e))return!!e.length;if(void 0===e||null===e)return!1;if(!1===e)return!0;if(e instanceof Date)return!isNaN(e.getTime());if("object"===we(e)){for(var t in e)return!0;return!1}return!!String(e).length},Re=function(e){return e=Object(n["unref"])(e),Array.isArray(e)?e.length:"object"===we(e)?Object.keys(e).length:String(e).length};function Ie(e){return function(t){return t=Object(n["unref"])(t),!Me(t)||e.test(t)}}n["unref"],Ie(/^[a-zA-Z]*$/),Ie(/^[a-zA-Z0-9]*$/),Ie(/^\d*(\.\d+)?$/);var Ve=/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i;Ie(Ve);function Fe(e){return function(t){return!Me(t)||Re(t)>=Object(n["unref"])(e)}}function qe(e){return{$validator:Fe(e),$message:function(e){var t=e.$params;return"This field should be at least ".concat(t.min," long")},$params:{min:e,type:"minLength"}}}function Pe(e){return"string"===typeof e&&(e=e.trim()),Me(e)}var He={$validator:Pe,$message:"Value is required",$params:{type:"required"}};var ze=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i;Ie(ze);Ie(/(^[0-9]*$)|(^-[0-9]+$)/),Ie(/^[-]?\d*(\.\d+)?$/);var We={},Ue=Object(n["defineComponent"])({name:"PropertiesComponent",props:{parameters:[],blockId:String,ctx:Object,show:Boolean,botContext:[],uid:Number},setup:function(){var e=Object(n["reactive"])({value:"",tagifySettings:{autoComplete:{enabled:!0},tagTextProp:"value",pattern:"#",mode:"mix",enforceWhitelist:!0,keepInvalidTags:!0,editTags:{keepInvalid:!1},validate:function(e){return"Invalid input"},templates:{dropdownItem:t},transformTag:i,whitelist:[],dropdown:{enabled:0,maxItems:100,position:"text",mapValueTo:"value",highlightFirst:!0,placeAbove:!0}}});function t(e){return'<div class="tagify__dropdown__item">\n        <i class="fas fa-database"></i>\n        <span class="ml-2">'+e.value+"</span>\n      </div>"}function i(e){e.style="--tag-bg: #aee8be"}return{tagifyStuff:e,v$:ye()}},validations:function(){return this.validations},data:function(){return{context:We,form:{},validations:{}}},components:{TextProperty:V},watch:{botContext:{immediate:!0,handler:function(e){e.length?this.tagifyStuff.tagifySettings.whitelist=null===e||void 0===e?void 0:e.map((function(e){return"string"==typeof e?{value:e}:e})):this.tagifyStuff.tagifySettings.whitelist=[]}},parameters:{immediate:!0,handler:function(e){if(0!==e.length){for(var t={form:{}},i=this.$props.parameters,n=0,s=i;n<s.length;n++){var a=s[n];if(a.mandatory&&(t["form"][a.slug]={required:He}),"BOO"===i.type){var o=this.$refs;o[a.slug].click()}}this.validations=t,setTimeout(this.sendErrorStatus,100)}}},ctx:{immediate:!0,handler:function(e){this.form=e}}},methods:{sendErrorStatus:function(){this.v$.$touch(),L["a"].emitter.emit("block-properties-error",this.blockId,this.v$.$error)},change:function(e){var t="",i="";e.target?(t="checkbox"===e.target.type?e.target.checked:e.target.value,i=e.target.id):(t=e.value,i=e.id),this.form[i]=t,this.v$.$touch(),L["a"].emitter.emit("block-properties-change",this.$props.blockId,{id:i,value:t,error:this.v$.$error}),L["a"].emitter.emit("block-properties-error",this.$props.blockId,this.v$.$error)}}});i("545e");Ue.render=B;var Xe=Ue,Ke=Object(n["defineComponent"])({name:"EditorBlockComponent",props:{id:Number,description:String,logo_class:String,nodeData:Object,nuid:String},components:{BlockProperties:Xe},data:function(){return{showProperties:!0,context:{},nodeName:"",output_vars:[],parameters:[],botContext:{},blockOnError:!1,uid:this.$props.nodeData?this.$props.nodeData.id:null}},mounted:function(){var e=this.id,t=this.nuid;setTimeout((function(){L["a"].emitter.emit("editor-block-data-request",t,e)}),40),L["a"].emitter.on("editor-block-data-response-"+t,this.setCtx),L["a"].emitter.on("block-properties-error",this.setError)},watch:{uid:{immediate:!0,handler:function(e){L["a"].emitter.emit("editor-block-data-ctx-add",this.uid,this.output_vars),L["a"].emitter.on("editor-block-bot-context-update-"+e,this.setBotContext)}}},methods:{filterCtx:function(e,t){for(var i=[],n=0;n<e.length;n++)t.indexOf(e[n].value.substring(1,2))>-1&&i.push(e[n]);return i},setBotContext:function(e,t){this.botContext=this.filterCtx(e,t)},setCtx:function(e){if(e){for(var t in this.context={},e.data)this.context[t]=e.data[t];this.nodeName=e.nodeName,this.uid=e.id,this.parameters=e.parameters,this.output_vars=e.output_vars}},setError:function(e,t){e===this.uid&&(this.blockOnError=t)},toggleSettings:function(e){this.showProperties=e||!this.showProperties}}});i("05d4");Ke.render=C;var Je,Ye=Ke,Ge=i("52e1"),Qe=i.n(Ge),Ze=new Uint8Array(16);function et(){if(!Je&&(Je="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!Je))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Je(Ze)}var tt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function it(e){return"string"===typeof e&&tt.test(e)}for(var nt=it,st=[],at=0;at<256;++at)st.push((at+256).toString(16).substr(1));function ot(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(st[e[t+0]]+st[e[t+1]]+st[e[t+2]]+st[e[t+3]]+"-"+st[e[t+4]]+st[e[t+5]]+"-"+st[e[t+6]]+st[e[t+7]]+"-"+st[e[t+8]]+st[e[t+9]]+"-"+st[e[t+10]]+st[e[t+11]]+st[e[t+12]]+st[e[t+13]]+st[e[t+14]]+st[e[t+15]]).toLowerCase();if(!nt(i))throw TypeError("Stringified UUID is invalid");return i}var rt=ot;function lt(e,t,i){e=e||{};var n=e.random||(e.rng||et)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){i=i||0;for(var s=0;s<16;++s)t[i+s]=n[s];return t}return rt(n)}var ct=lt;function dt(e){return-1!==[null,void 0,!1].indexOf(e)}function ut(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t?String(e).toLowerCase().trim():String(e).normalize("NFD").replace(/(?:[\^`\xA8\xAF\xB4\xB7\xB8\u02B0-\u034E\u0350-\u0357\u035D-\u0362\u0374\u0375\u037A\u0384\u0385\u0483-\u0487\u0559\u0591-\u05A1\u05A3-\u05BD\u05BF\u05C1\u05C2\u05C4\u064B-\u0652\u0657\u0658\u06DF\u06E0\u06E5\u06E6\u06EA-\u06EC\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F5\u0818\u0819\u08E3-\u08FE\u093C\u094D\u0951-\u0954\u0971\u09BC\u09CD\u0A3C\u0A4D\u0ABC\u0ACD\u0AFD-\u0AFF\u0B3C\u0B4D\u0B55\u0BCD\u0C4D\u0CBC\u0CCD\u0D3B\u0D3C\u0D4D\u0DCA\u0E47-\u0E4C\u0E4E\u0EBA\u0EC8-\u0ECC\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F82-\u0F84\u0F86\u0F87\u0FC6\u1037\u1039\u103A\u1063\u1064\u1069-\u106D\u1087-\u108D\u108F\u109A\u109B\u135D-\u135F\u17C9-\u17D3\u17DD\u1939-\u193B\u1A75-\u1A7C\u1A7F\u1AB0-\u1ABD\u1B34\u1B44\u1B6B-\u1B73\u1BAA\u1BAB\u1C36\u1C37\u1C78-\u1C7D\u1CD0-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1D2C-\u1D6A\u1DC4-\u1DCF\u1DF5-\u1DF9\u1DFD-\u1DFF\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2CEF-\u2CF1\u2E2F\u302A-\u302F\u3099-\u309C\u30FC\uA66F\uA67C\uA67D\uA67F\uA69C\uA69D\uA6F0\uA6F1\uA700-\uA721\uA788-\uA78A\uA7F8\uA7F9\uA8C4\uA8E0-\uA8F1\uA92B-\uA92E\uA953\uA9B3\uA9C0\uA9E5\uAA7B-\uAA7D\uAABF-\uAAC2\uAAF6\uAB5B-\uAB5F\uAB69-\uAB6B\uABEC\uABED\uFB1E\uFE20-\uFE2F\uFF3E\uFF40\uFF70\uFF9E\uFF9F\uFFE3]|\uD800\uDEE0|\uD802[\uDEE5\uDEE6]|\uD803[\uDD22-\uDD27\uDF46-\uDF50]|\uD804[\uDCB9\uDCBA\uDD33\uDD34\uDD73\uDDC0\uDDCA-\uDDCC\uDE35\uDE36\uDEE9\uDEEA\uDF3C\uDF4D\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC42\uDC46\uDCC2\uDCC3\uDDBF\uDDC0\uDE3F\uDEB6\uDEB7\uDF2B]|\uD806[\uDC39\uDC3A\uDD3D\uDD3E\uDD43\uDDE0\uDE34\uDE47\uDE99]|\uD807[\uDC3F\uDD42\uDD44\uDD45\uDD97]|\uD81A[\uDEF0-\uDEF4\uDF30-\uDF36]|\uD81B[\uDF8F-\uDF9F\uDFF0\uDFF1]|\uD834[\uDD67-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD]|\uD838[\uDD30-\uDD36\uDEEC-\uDEEF]|\uD83A[\uDCD0-\uDCD6\uDD44-\uDD46\uDD48-\uDD4A])/g,"").toLowerCase().trim()}function ht(e){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function gt(e,t,i){var s=Object(n["toRefs"])(e),a=s.options,o=s.mode,r=s.trackBy,l=s.limit,c=s.hideSelected,d=s.createTag,u=s.label,h=s.appendNewTag,p=s.multipleLabel,g=s.object,f=s.loading,m=s.delay,v=s.resolveOnLoad,b=s.minChars,y=s.filterResults,w=s.clearOnSearch,O=s.clearOnSelect,_=s.valueProp,C=s.canDeselect,x=s.max,j=s.strict,T=s.closeOnSelect,N=i.iv,D=i.ev,S=i.search,E=i.clearSearch,k=i.update,B=i.pointer,L=i.blur,$=i.deactivate,A=Object(n["ref"])([]),M=Object(n["ref"])([]),R=Object(n["ref"])(!1),I=Object(n["computed"])((function(){var e,t=M.value||[];return e=t,"[object Object]"===Object.prototype.toString.call(e)&&(t=Object.keys(t).map((function(e){var i,n=t[e];return pt(i={},_.value,e),pt(i,r.value,n),pt(i,u.value,n),i}))),t=t.map((function(e,t){var i;return"object"===ht(e)?e:(pt(i={},_.value,e),pt(i,r.value,e),pt(i,u.value,e),i)})),A.value.length&&(t=t.concat(A.value)),t})),V=Object(n["computed"])((function(){var e=I.value;return z.value.length&&(e=z.value.concat(e)),S.value&&y.value&&(e=e.filter((function(e){return-1!==ut(e[r.value],j.value).indexOf(ut(S.value,j.value))}))),c.value&&(e=e.filter((function(e){return!ne(e)}))),l.value>0&&(e=e.slice(0,l.value)),e})),F=Object(n["computed"])((function(){switch(o.value){case"single":return!dt(N.value[_.value]);case"multiple":case"tags":return!dt(N.value)&&N.value.length>0}})),q=Object(n["computed"])((function(){return void 0!==p&&void 0!==p.value?p.value(N.value):N.value&&N.value.length>1?"".concat(N.value.length," options selected"):"1 option selected"})),P=Object(n["computed"])((function(){return!I.value.length&&!R.value})),H=Object(n["computed"])((function(){return I.value.length>0&&0==V.value.length})),z=Object(n["computed"])((function(){var e;return!1!==d.value&&S.value?-1!==ie(S.value)?[]:[(e={},pt(e,_.value,S.value),pt(e,u.value,S.value),pt(e,r.value,S.value),e)]:[]})),W=Object(n["computed"])((function(){switch(o.value){case"single":return null;case"multiple":case"tags":return[]}})),U=Object(n["computed"])((function(){return f.value||R.value})),X=function(e){switch("object"!==ht(e)&&(e=te(e)),o.value){case"single":k(e);break;case"multiple":case"tags":k(N.value.concat(e))}t.emit("select",J(e),e)},K=function(e){switch("object"!==ht(e)&&(e=te(e)),o.value){case"single":G();break;case"tags":case"multiple":k(N.value.filter((function(t){return t[_.value]!=e[_.value]})))}t.emit("deselect",J(e),e)},J=function(e){return g.value?e:e[_.value]},Y=function(e){K(e)},G=function(){t.emit("clear"),k(W.value)},Q=function(e){switch(o.value){case"single":return!dt(N.value)&&N.value[_.value]==e[_.value];case"tags":case"multiple":return!dt(N.value)&&-1!==N.value.map((function(e){return e[_.value]})).indexOf(e[_.value])}},Z=function(e){return!0===e.disabled},ee=function(){return!(void 0===x||-1===x.value||!F.value&&x.value>0)&&N.value.length>=x.value},te=function(e){return I.value[I.value.map((function(e){return String(e[_.value])})).indexOf(String(e))]},ie=function(e){return I.value.map((function(e){return ut(e[r.value])})).indexOf(ut(e))},ne=function(e){return"tags"===o.value&&c.value&&Q(e)},se=function(e){A.value.push(e)},ae=function(){dt(D.value)||(N.value=re(D.value))},oe=function(e){R.value=!0,a.value(S.value).then((function(t){M.value=t,"function"==typeof e&&e(t),R.value=!1}))},re=function(e){return dt(e)?"single"===o.value?{}:[]:g.value?e:"single"===o.value?te(e)||{}:e.filter((function(e){return!!te(e)})).map((function(e){return te(e)}))};if("single"!==o.value&&!dt(D.value)&&!Array.isArray(D.value))throw new Error('v-model must be an array when using "'.concat(o.value,'" mode'));return a&&"function"==typeof a.value?v.value?oe(ae):1==g.value&&ae():(M.value=a.value,ae()),m.value>-1&&Object(n["watch"])(S,(function(e){e.length<b.value||(R.value=!0,w.value&&(M.value=[]),setTimeout((function(){e==S.value&&a.value(S.value).then((function(t){e==S.value&&(M.value=t,B.value=V.value.filter((function(e){return!0!==e.disabled}))[0]||null,R.value=!1)}))}),m.value))}),{flush:"sync"}),Object(n["watch"])(D,(function(e){var t,i,n;if(dt(e))N.value=re(e);else switch(o.value){case"single":(g.value?e[_.value]!=N.value[_.value]:e!=N.value[_.value])&&(N.value=re(e));break;case"multiple":case"tags":t=g.value?e.map((function(e){return e[_.value]})):e,i=N.value.map((function(e){return e[_.value]})),n=i.slice().sort(),t.length===i.length&&t.slice().sort().every((function(e,t){return e===n[t]}))||(N.value=re(e))}}),{deep:!0}),"function"!=typeof e.options&&Object(n["watch"])(a,(function(t,i){M.value=e.options,Object.keys(N.value).length||ae(),function(){if(F.value)if("single"===o.value){var e=te(N.value[_.value])[u.value];N.value[u.value]=e,g.value&&(D.value[u.value]=e)}else N.value.forEach((function(e,t){var i=te(N.value[t][_.value])[u.value];N.value[t][u.value]=i,g.value&&(D.value[t][u.value]=i)}))}()})),{fo:V,filteredOptions:V,hasSelected:F,multipleLabelText:q,eo:I,extendedOptions:I,noOptions:P,noResults:H,resolving:R,busy:U,select:X,deselect:K,remove:Y,clear:G,isSelected:Q,isDisabled:Z,isMax:ee,getOption:te,handleOptionClick:function(e){if(!Z(e)){switch(o.value){case"single":if(Q(e))return void(C.value&&K(e));L(),X(e);break;case"multiple":if(Q(e))return void K(e);if(ee())return;X(e),O.value&&E();break;case"tags":if(Q(e))return void K(e);if(ee())return;void 0===te(e[_.value])&&d.value&&(t.emit("tag",e[_.value]),h.value&&se(e),E()),O.value&&E(),X(e)}T.value&&$()}},handleTagRemove:function(e,t){0===t.button?Y(e):t.preventDefault()},refreshOptions:function(e){oe(e)},resolveOptions:oe}}function ft(e){return function(e){if(Array.isArray(e))return mt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return mt(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?mt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function vt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function bt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function yt(e,t,i){var s=Object(n["toRefs"])(e),a=s.disabled,o=s.openDirection,r=s.showOptions,l=i.isOpen,c=i.isPointed,d=i.isSelected,u=i.isDisabled,h=i.isActive,p=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?vt(Object(i),!0).forEach((function(t){bt(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):vt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({container:"multiselect",containerDisabled:"is-disabled",containerOpen:"is-open",containerOpenTop:"is-open-top",containerActive:"is-active",singleLabel:"multiselect-single-label",multipleLabel:"multiselect-multiple-label",search:"multiselect-search",tags:"multiselect-tags",tag:"multiselect-tag",tagDisabled:"is-disabled",tagRemove:"multiselect-tag-remove",tagRemoveIcon:"multiselect-tag-remove-icon",tagsSearchWrapper:"multiselect-tags-search-wrapper",tagsSearch:"multiselect-tags-search",tagsSearchCopy:"multiselect-tags-search-copy",placeholder:"multiselect-placeholder",caret:"multiselect-caret",caretOpen:"is-open",clear:"multiselect-clear",clearIcon:"multiselect-clear-icon",spinner:"multiselect-spinner",dropdown:"multiselect-dropdown",dropdownTop:"is-top",dropdownHidden:"is-hidden",options:"multiselect-options",optionsTop:"is-top",option:"multiselect-option",optionPointed:"is-pointed",optionSelected:"is-selected",optionDisabled:"is-disabled",optionSelectedPointed:"is-selected is-pointed",optionSelectedDisabled:"is-selected is-disabled",noOptions:"multiselect-no-options",noResults:"multiselect-no-results",fakeInput:"multiselect-fake-input",spacer:"multiselect-spacer"},s.classes.value);return{classList:Object(n["computed"])((function(){return{container:[p.container].concat(a.value?p.containerDisabled:[]).concat(l.value&&"top"===o.value&&r.value?p.containerOpenTop:[]).concat(l.value&&"top"!==o.value&&r.value?p.containerOpen:[]).concat(h.value?p.containerActive:[]),spacer:p.spacer,singleLabel:p.singleLabel,multipleLabel:p.multipleLabel,search:p.search,tags:p.tags,tag:[p.tag].concat(a.value?p.tagDisabled:[]),tagRemove:p.tagRemove,tagRemoveIcon:p.tagRemoveIcon,tagsSearchWrapper:p.tagsSearchWrapper,tagsSearch:p.tagsSearch,tagsSearchCopy:p.tagsSearchCopy,placeholder:p.placeholder,caret:[p.caret].concat(l.value?p.caretOpen:[]),clear:p.clear,clearIcon:p.clearIcon,spinner:p.spinner,dropdown:[p.dropdown].concat("top"===o.value?p.dropdownTop:[]).concat(l.value&&r.value?[]:p.dropdownHidden),options:[p.options].concat("top"===o.value?p.optionsTop:[]),option:function(e){var t=[p.option];return c(e)?t.push(d(e)?p.optionSelectedPointed:p.optionPointed):d(e)?t.push(u(e)?p.optionSelectedDisabled:p.optionSelected):u(e)&&t.push(p.optionDisabled),t},noOptions:p.noOptions,noResults:p.noResults,fakeInput:p.fakeInput}}))}}var wt={name:"Multiselect",emits:["open","close","select","deselect","input","search-change","tag","update:modelValue","change","clear"],props:{value:{required:!1},modelValue:{required:!1},options:{type:[Array,Object,Function],required:!1,default:()=>[]},id:{type:[String,Number],required:!1},name:{type:[String,Number],required:!1,default:"multiselect"},disabled:{type:Boolean,required:!1,default:!1},label:{type:String,required:!1,default:"label"},trackBy:{type:String,required:!1,default:"label"},valueProp:{type:String,required:!1,default:"value"},placeholder:{type:String,required:!1,default:null},mode:{type:String,required:!1,default:"single"},searchable:{type:Boolean,required:!1,default:!1},limit:{type:Number,required:!1,default:-1},hideSelected:{type:Boolean,required:!1,default:!0},createTag:{type:Boolean,required:!1,default:!1},appendNewTag:{type:Boolean,required:!1,default:!0},caret:{type:Boolean,required:!1,default:!0},loading:{type:Boolean,required:!1,default:!1},noOptionsText:{type:String,required:!1,default:"The list is empty"},noResultsText:{type:String,required:!1,default:"No results found"},multipleLabel:{type:Function,required:!1},object:{type:Boolean,required:!1,default:!1},delay:{type:Number,required:!1,default:-1},minChars:{type:Number,required:!1,default:0},resolveOnLoad:{type:Boolean,required:!1,default:!0},filterResults:{type:Boolean,required:!1,default:!0},clearOnSearch:{type:Boolean,required:!1,default:!1},clearOnSelect:{type:Boolean,required:!1,default:!0},canDeselect:{type:Boolean,required:!1,default:!0},canClear:{type:Boolean,required:!1,default:!0},max:{type:Number,required:!1,default:-1},showOptions:{type:Boolean,required:!1,default:!0},addTagOn:{type:Array,required:!1,default:()=>["enter"]},required:{type:Boolean,required:!1,default:!1},openDirection:{type:String,required:!1,default:"bottom"},nativeSupport:{type:Boolean,required:!1,default:!1},classes:{type:Object,required:!1,default:()=>({})},strict:{type:Boolean,required:!1,default:!0},closeOnSelect:{type:Boolean,required:!1,default:!0}},setup(e,t){const i=function(e,t){var i=Object(n["toRefs"])(e),s=i.value,a=i.modelValue,o=i.mode,r=i.valueProp,l=Object(n["ref"])("single"!==o.value?[]:{}),c=void 0!==t.expose?a:s,d=Object(n["computed"])((function(){return"single"===o.value?l.value[r.value]:l.value.map((function(e){return e[r.value]}))})),u=Object(n["computed"])((function(){return"single"!==o.value?l.value.map((function(e){return e[r.value]})).join(","):l.value[r.value]}));return{iv:l,internalValue:l,ev:c,externalValue:c,textValue:u,plainValue:d}}(e,t),s={pointer:Object(n["ref"])(null)},a=function(e,t,i){var s=Object(n["toRefs"])(e).disabled,a=Object(n["ref"])(!1);return{isOpen:a,open:function(){a.value||s.value||(a.value=!0,t.emit("open"))},close:function(){a.value&&(a.value=!1,t.emit("close"))}}}(e,t),o=function(e,t,i){var s=Object(n["ref"])(null),a=Object(n["ref"])(null);return Object(n["watch"])(s,(function(e){t.emit("search-change",e)})),{search:s,input:a,clearSearch:function(){s.value=""},handleSearchInput:function(e){s.value=e.target.value}}}(0,t),r=function(e,t,i){var s=Object(n["toRefs"])(e),a=s.object,o=s.valueProp,r=s.mode,l=i.iv,c=function(e){return a.value||dt(e)?e:Array.isArray(e)?e.map((function(e){return e[o.value]})):e[o.value]},d=function(e){return dt(e)?"single"===r.value?{}:[]:e};return{update:function(e){l.value=d(e);var i=c(e);t.emit("change",i),t.emit("input",i),t.emit("update:modelValue",i)}}}(e,t,{iv:i.iv}),l=function(e,t,i){var s=Object(n["toRefs"])(e),a=s.searchable,o=s.disabled,r=i.input,l=i.open,c=i.close,d=i.clearSearch,u=Object(n["ref"])(null),h=Object(n["ref"])(!1),p=Object(n["computed"])((function(){return a.value||o.value?-1:0})),g=function(){a.value&&r.value.blur(),u.value.blur()},f=function(){h.value=!1,setTimeout((function(){h.value||(c(),d())}),1)};return{multiselect:u,tabindex:p,isActive:h,blur:g,handleFocus:function(){a.value&&!o.value&&r.value.focus()},activate:function(){o.value||(h.value=!0,l())},deactivate:f,handleCaretClick:function(){f(),g()}}}(e,0,{input:o.input,open:a.open,close:a.close,clearSearch:o.clearSearch}),c=gt(e,t,{ev:i.ev,iv:i.iv,search:o.search,clearSearch:o.clearSearch,update:r.update,pointer:s.pointer,blur:l.blur,deactivate:l.deactivate}),d=function(e,t,i){var s=Object(n["toRefs"])(e),a=s.valueProp,o=s.showOptions,r=s.searchable,l=i.fo,c=i.handleOptionClick,d=i.search,u=i.pointer,h=i.multiselect,p=Object(n["computed"])((function(){return l.value.filter((function(e){return!0!==e.disabled}))})),g=function(e){void 0===e||null!==e&&e.disabled||(u.value=e)},f=function(){g(p.value[0]||null)},m=function(){g(null)},v=function(){var e=h.value.querySelector("[data-pointed]");if(e){var t=e.parentElement.parentElement;e.offsetTop+e.offsetHeight>t.clientHeight+t.scrollTop&&(t.scrollTop=e.offsetTop+e.offsetHeight-t.clientHeight),e.offsetTop<t.scrollTop&&(t.scrollTop=e.offsetTop)}};return Object(n["watch"])(d,(function(e){r.value&&(e.length&&o.value?f():m())})),{pointer:u,isPointed:function(e){return!!u.value&&u.value[a.value]==e[a.value]},setPointer:g,setPointerFirst:f,clearPointer:m,selectPointer:function(){u.value&&!0!==u.value.disabled&&c(u.value)},forwardPointer:function(){if(null===u.value)g(p.value[0]||null);else{var e=p.value.map((function(e){return e[a.value]})).indexOf(u.value[a.value])+1;p.value.length<=e&&(e=0),g(p.value[e]||null)}Object(n["nextTick"])((function(){v()}))},backwardPointer:function(){if(null===u.value)g(p.value[p.value.length-1]||null);else{var e=p.value.map((function(e){return e[a.value]})).indexOf(u.value[a.value])-1;e<0&&(e=p.value.length-1),g(p.value[e]||null)}Object(n["nextTick"])((function(){v()}))}}}(e,0,{fo:c.fo,handleOptionClick:c.handleOptionClick,search:o.search,pointer:s.pointer,multiselect:l.multiselect}),u=function(e,t,i){var s=Object(n["toRefs"])(e),a=s.mode,o=s.addTagOn,r=s.createTag,l=s.openDirection,c=s.searchable,d=s.showOptions,u=s.valueProp,h=i.iv,p=i.update,g=i.search,f=i.setPointer,m=i.selectPointer,v=i.backwardPointer,b=i.forwardPointer,y=i.blur,w=i.fo,O=function(){"tags"===a.value&&!d.value&&r.value&&c.value&&f(w.value[w.value.map((function(e){return e[u.value]})).indexOf(g.value)]),m()};return{handleKeydown:function(e){switch(e.keyCode){case 8:if("single"===a.value)return;if(c.value&&-1===[null,""].indexOf(g.value))return;if(0===h.value.length)return;p(ft(h.value).slice(0,-1));break;case 13:if(e.preventDefault(),"tags"===a.value&&-1===o.value.indexOf("enter"))return;O();break;case 27:y();break;case 32:if("tags"!==a.value&&c.value)return;if("tags"===a.value&&-1===o.value.indexOf("space"))return;e.preventDefault(),O();break;case 38:if(e.preventDefault(),!d.value)return;"top"===l.value?b():v();break;case 40:if(e.preventDefault(),!d.value)return;"top"===l.value?v():b();break;case 186:if("tags"!==a.value)return;if(-1===o.value.indexOf(";")||!r.value)return;O(),e.preventDefault();break;case 188:if("tags"!==a.value)return;if(-1===o.value.indexOf(",")||!r.value)return;O(),e.preventDefault()}}}}(e,0,{iv:i.iv,update:r.update,search:o.search,setPointer:d.setPointer,selectPointer:d.selectPointer,backwardPointer:d.backwardPointer,forwardPointer:d.forwardPointer,blur:l.blur,fo:c.fo}),h=yt(e,0,{isOpen:a.isOpen,isPointed:d.isPointed,isSelected:c.isSelected,isDisabled:c.isDisabled,isActive:l.isActive});return{...i,...a,...l,...s,...r,...o,...c,...d,...u,...h}},render:function(e,t,i,s,a,o){return Object(n["openBlock"])(),Object(n["createBlock"])("div",{ref:"multiselect",tabindex:e.tabindex,class:e.classList.container,id:i.id,onFocusin:t[5]||(t[5]=(...t)=>e.activate&&e.activate(...t)),onFocusout:t[6]||(t[6]=(...t)=>e.deactivate&&e.deactivate(...t)),onKeydown:t[7]||(t[7]=(...t)=>e.handleKeydown&&e.handleKeydown(...t)),onFocus:t[8]||(t[8]=(...t)=>e.handleFocus&&e.handleFocus(...t))},[Object(n["createCommentVNode"])(" Search "),"tags"!==i.mode&&i.searchable&&!i.disabled?(Object(n["openBlock"])(),Object(n["createBlock"])("input",{key:0,modelValue:e.search,value:e.search,class:e.classList.search,onInput:t[1]||(t[1]=(...t)=>e.handleSearchInput&&e.handleSearchInput(...t)),ref:"input"},null,42,["modelValue","value"])):Object(n["createCommentVNode"])("v-if",!0),Object(n["createCommentVNode"])(" Tags (with search) "),"tags"==i.mode?(Object(n["openBlock"])(),Object(n["createBlock"])("div",{key:1,class:e.classList.tags},[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(e.iv,(t,s,a)=>Object(n["renderSlot"])(e.$slots,"tag",{option:t,handleTagRemove:e.handleTagRemove,disabled:i.disabled},()=>[(Object(n["openBlock"])(),Object(n["createBlock"])("span",{class:e.classList.tag,key:a},[Object(n["createTextVNode"])(Object(n["toDisplayString"])(t[i.label])+" ",1),i.disabled?Object(n["createCommentVNode"])("v-if",!0):(Object(n["openBlock"])(),Object(n["createBlock"])("span",{key:0,class:e.classList.tagRemove,onMousedown:Object(n["withModifiers"])(i=>e.handleTagRemove(t,i),["prevent"])},[Object(n["createVNode"])("span",{class:e.classList.tagRemoveIcon},null,2)],42,["onMousedown"]))],2))])),256)),Object(n["createVNode"])("div",{class:e.classList.tagsSearchWrapper},[Object(n["createCommentVNode"])(" Used for measuring search width "),Object(n["createVNode"])("span",{class:e.classList.tagsSearchCopy},Object(n["toDisplayString"])(e.search),3),Object(n["createCommentVNode"])(" Actual search input "),i.searchable&&!i.disabled?(Object(n["openBlock"])(),Object(n["createBlock"])("input",{key:0,modelValue:e.search,value:e.search,class:e.classList.tagsSearch,onInput:t[2]||(t[2]=(...t)=>e.handleSearchInput&&e.handleSearchInput(...t)),ref:"input"},null,42,["modelValue","value"])):Object(n["createCommentVNode"])("v-if",!0)],2)],2)):Object(n["createCommentVNode"])("v-if",!0),Object(n["createCommentVNode"])(" Single label "),"single"==i.mode&&e.hasSelected&&!e.search&&e.iv?Object(n["renderSlot"])(e.$slots,"singlelabel",{key:2,value:e.iv},()=>[Object(n["createVNode"])("div",{class:e.classList.singleLabel},Object(n["toDisplayString"])(e.iv[i.label]),3)]):Object(n["createCommentVNode"])("v-if",!0),Object(n["createCommentVNode"])(" Multiple label "),"multiple"==i.mode&&e.hasSelected&&!e.search?Object(n["renderSlot"])(e.$slots,"multiplelabel",{key:3,values:e.iv},()=>[Object(n["createVNode"])("div",{class:e.classList.multipleLabel},Object(n["toDisplayString"])(e.multipleLabelText),3)]):Object(n["createCommentVNode"])("v-if",!0),Object(n["createCommentVNode"])(" Placeholder "),!i.placeholder||e.hasSelected||e.search?Object(n["createCommentVNode"])("v-if",!0):Object(n["renderSlot"])(e.$slots,"placeholder",{key:4},()=>[Object(n["createVNode"])("div",{class:e.classList.placeholder},Object(n["toDisplayString"])(i.placeholder),3)]),Object(n["createCommentVNode"])(" Spinner "),e.busy?Object(n["renderSlot"])(e.$slots,"spinner",{key:5},()=>[Object(n["createVNode"])("span",{class:e.classList.spinner},null,2)]):Object(n["createCommentVNode"])("v-if",!0),Object(n["createCommentVNode"])(" Clear "),e.hasSelected&&!i.disabled&&i.canClear&&!e.busy?Object(n["renderSlot"])(e.$slots,"clear",{key:6,clear:e.clear},()=>[Object(n["createVNode"])("span",{class:e.classList.clear,onMousedown:t[3]||(t[3]=(...t)=>e.clear&&e.clear(...t))},[Object(n["createVNode"])("span",{class:e.classList.clearIcon},null,2)],34)]):Object(n["createCommentVNode"])("v-if",!0),Object(n["createCommentVNode"])(" Caret "),i.caret?Object(n["renderSlot"])(e.$slots,"caret",{key:7},()=>[Object(n["createVNode"])("span",{class:e.classList.caret,onClick:t[4]||(t[4]=(...t)=>e.handleCaretClick&&e.handleCaretClick(...t))},null,2)]):Object(n["createCommentVNode"])("v-if",!0),Object(n["createCommentVNode"])(" Options "),Object(n["createVNode"])("div",{class:e.classList.dropdown,tabindex:"-1"},[Object(n["renderSlot"])(e.$slots,"beforelist",{options:e.fo}),Object(n["createVNode"])("ul",{class:e.classList.options},[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(e.fo,(t,s,a)=>(Object(n["openBlock"])(),Object(n["createBlock"])("li",{class:e.classList.option(t),key:a,"data-pointed":e.isPointed(t),onMouseenter:i=>e.setPointer(t),onClick:i=>e.handleOptionClick(t)},[Object(n["renderSlot"])(e.$slots,"option",{option:t,search:e.search},()=>[Object(n["createVNode"])("span",null,Object(n["toDisplayString"])(t[i.label]),1)])],42,["data-pointed","onMouseenter","onClick"]))),128))],2),e.noOptions?Object(n["renderSlot"])(e.$slots,"nooptions",{key:0},()=>[Object(n["createVNode"])("div",{class:e.classList.noOptions,innerHTML:i.noOptionsText},null,10,["innerHTML"])]):Object(n["createCommentVNode"])("v-if",!0),e.noResults?Object(n["renderSlot"])(e.$slots,"noresults",{key:1},()=>[Object(n["createVNode"])("div",{class:e.classList.noResults,innerHTML:i.noResultsText},null,10,["innerHTML"])]):Object(n["createCommentVNode"])("v-if",!0),Object(n["renderSlot"])(e.$slots,"afterlist",{options:e.fo})],2),Object(n["createCommentVNode"])(" Hacky input element to show HTML5 required warning "),i.required?(Object(n["openBlock"])(),Object(n["createBlock"])("input",{key:8,class:e.classList.fakeInput,tabindex:"-1",value:e.textValue,required:""},null,10,["value"])):Object(n["createCommentVNode"])("v-if",!0),Object(n["createCommentVNode"])(" Native input support "),i.nativeSupport?(Object(n["openBlock"])(),Object(n["createBlock"])(n["Fragment"],{key:9},["single"==i.mode?(Object(n["openBlock"])(),Object(n["createBlock"])("input",{key:0,type:"hidden",name:i.name,value:void 0!==e.plainValue?e.plainValue:""},null,8,["name","value"])):(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],{key:1},Object(n["renderList"])(e.plainValue,(e,t)=>(Object(n["openBlock"])(),Object(n["createBlock"])("input",{type:"hidden",name:i.name+"[]",value:e,key:t},null,8,["name","value"]))),128))],64)):Object(n["createCommentVNode"])("v-if",!0),Object(n["createCommentVNode"])(" Create height for empty input "),Object(n["createVNode"])("div",{class:e.classList.spacer},null,2)],42,["tabindex","id"])},__file:"src/Multiselect.vue"},Ot=wt,_t=(i("514a"),null),Ct=null,xt={},jt=[],Tt=Object(n["defineComponent"])({name:"DrawFlowComponent",props:{authToken:String,blocks:Array,editorId:String,bot:Object,usesTemplate:Boolean,height:Number,showZoom:Boolean},components:{EditorBlock:Ye,Multiselect:Ot},validations:function(){return{botName:{required:He,minLength:qe(5)}}},setup:function(){return{v$:ye(),appVersion:i("d490").version}},data:function(){return{editor:null,mobile_item_selec:_t,mobile_last_move:Ct,transform:"",isLoading:!1,fieldsContext:jt,nodesStatuses:xt,validationStatus:!1,botId:null,botName:"",botFrequency:10,activation:{show:!1,loading:!1},botFrequencyUnit:"minutes",scheduleOptions:["minutes","days"],calcBotFrequency:10}},mounted:function(){return Object(v["b"])(this,void 0,void 0,(function(){var e,t,i,n,s;return Object(v["c"])(this,(function(a){try{for(this.editor&&this.editor.clear(),this.initDiagram(),this.initContext(),this.bot&&(e=this.bot,t=null===e||void 0===e?void 0:e.json.data,this.botName=null===e||void 0===e?void 0:e.name,this.botFrequencyUnit=(null===e||void 0===e?void 0:e.json.ux)?null===e||void 0===e?void 0:e.json.ux.frequencyUnit:"minutes",this.botFrequency=this.getDisplayFrequency(null===e||void 0===e?void 0:e.frequency,this.botFrequencyUnit),this.updateEditorBot(t,null===e||void 0===e?void 0:e.json.context.nodes,this.botName,this.botFrequency,this.botFrequencyUnit)),i=document.getElementsByClassName("drag-drawflow"),n=0;n<i.length;n++)i[n].addEventListener("touchend",this.drop,!1),i[n].addEventListener("touchmove",this.positionMobile,!1),i[n].addEventListener("touchstart",this.drag,!1);s=this,L["a"].emitter.on("block-properties-change",(function(e,t){var i=s.editor.drawflow.drawflow["Home"];i.data[e]||(i.data[e]={data:{}}),i.data[e].data[t.id]=t.value,s.validationStatusCheck()})),L["a"].emitter.on("editor-block-data-request",(function(e){var t=s.editor.drawflow.drawflow["Home"],i=t.context.nodes[e];if(i){var n=i.id;t.data[n]["parameters"]=i.parameters,t.data[n]["nodeName"]=i.name,t.data[n]["output_vars"]=i.output_vars,L["a"].emitter.emit("editor-block-data-response-"+e,t.data[n])}})),L["a"].emitter.on("editor-block-data-ctx-add",(function(e,t){if(e){var i=function(i){var n=t[i],a="#"+e+"."+n.slug;s.fieldsContext.find((function(e){return e.value===a}))||s.fieldsContext.push({value:a,text:n.name,title:n.description})};for(var n in t)i(n)}})),this.editor.on("connectionCreated",this.sendContext),this.editor.on("connectionRemoved",this.sendContext),this.editor.on("nodeRemoved",this.removeNode),L["a"].emitter.on("block-properties-error",(function(e,t){s.nodesStatuses[e]=t,s.validationStatusCheck()}))}catch(o){console.error(o)}return[2]}))}))},watch:{bot:{immediate:!0,deep:!0,handler:function(e,t){if(t&&e.id!==t.id||!t){var i=e,n=null===i||void 0===i?void 0:i.json.data;n&&this.updateEditorBot(n,null===i||void 0===i?void 0:i.json.context.nodes,null===i||void 0===i?void 0:i.name,null===i||void 0===i?void 0:i.frequency,(null===i||void 0===i?void 0:i.json.ux)?null===i||void 0===i?void 0:i.json.ux.frequencyUntit:"minutes")}}}},methods:{updateEditorBot:function(e,t,i,n,s){var a=this,o=this;this.botName=i,this.botFrequency=n,this.botFrequencyUnit=s||"minutes",setTimeout((function(){a.registerBlocks(e),a.editor.import({drawflow:{Home:{context:{nodes:t},data:e}}}),setTimeout((function(){o.sendBotContext(e),L["a"].emitter.emit("editor-valid-status",!0)}),160)}),10)},export:function(){var e=this.editor.export(),t=e.drawflow.Home;t["ux"]={frequencyUnit:this.botFrequencyUnit};var i={name:this.botName,json:t,frequency:this.calcBotFrequency};return i},registerBlocks:function(e){for(var t=0,i=Object.entries(e);t<i.length;t++){var n=i[t],s=n[1];this.registerBlock(s,s.html)}},calculateRealFrequency:function(){"days"===this.botFrequencyUnit?this.calcBotFrequency=24*this.botFrequency*60:"minutes"===this.botFrequencyUnit&&(this.calcBotFrequency=this.botFrequency)},getDisplayFrequency:function(e,t){var i=e;return"days"===t&&(i=e/24/60),i},frequencyUnitChange:function(e){this.botFrequencyUnit=e,this.calculateRealFrequency()},registerBlock:function(e,t){e["nuid"]=t;var i=e,n={uid:t,parameters:e.parameters};this.editor.registerNode(t,Ye,i,n)},onFrequencyChange:function(e){this.botFrequency=e,this.calculateRealFrequency()},positionMobile:function(e){this.mobile_last_move=e},allowDrop:function(e){e.preventDefault()},drag:function(e){"touchstart"===e.type?this.mobile_item_selec=e.target.closest(".drag-drawflow").getAttribute("data-node"):e.dataTransfer.setData("node",e.target.getAttribute("data-node"))},drop:function(e){if("touchend"===e.type){var t=this.mobile_last_move.touches[0].clientX,i=this.mobile_last_move.touches[0].clientY,n=document.elementFromPoint(t,i),s=n.closest("#"+this.$props.editorId);null!=s&&this.addNodeToDrawFlow(this.mobile_item_selec,JSON.parse(this.mobile_item_selec),t,i),this.mobile_item_selec=""}else{e.preventDefault();var a=e.dataTransfer.getData("node"),o=e.dataTransfer.getData("data");this.addNodeToDrawFlow(a,JSON.parse(o),e.clientX,e.clientY)}},clearBot:function(){this.editor.clear(),this.botName="",this.initContext()},validationStatusCheck:function(){if(this.v$.$invalid)L["a"].emitter.emit("editor-valid-status",!1);else{for(var e=0,t=Object.entries(this.nodesStatuses);e<t.length;e++){var i=t[e],n=i[1];if(n)return this.validationStatus=!1,void L["a"].emitter.emit("editor-valid-status",!1)}this.validationStatus=!0,L["a"].emitter.emit("editor-valid-status",!0)}},getPreviousNodes:function(e,t){var i=this.editor.drawflow.drawflow["Home"].data,n=i[e].inputs,s=[];for(var a in t&&(s=t),n)for(var o=n[a],r=0;r<o.connections.length;r++){var l=o.connections;s.push(l[r].node),this.getPreviousNodes(l[r].node,s)}return Array.from(new Set(s))},getForwardNodesToBeUpdated:function(e,t){var i=this.editor.drawflow.drawflow["Home"].data,n=i[e].outputs,s=[];for(var a in t&&(s=t),n)for(var o=n[a],r=0;r<o.connections.length;r++){var l=o.connections;l[r].node!==e&&(s.push(l[r].node),this.getForwardNodesToBeUpdated(l[r].node,s))}return Array.from(new Set(s))},initContext:function(){this.editor.drawflow.drawflow["Home"].context={},this.editor.drawflow.drawflow["Home"].context.nodes={},this.editor.drawflow.drawflow["Home"].context.appVersion=this.appVersion},initDiagram:function(){var e,t=document.getElementById(this.$props.editorId);this.editor=null,this.editor=new Qe.a(t,n),null===(e=this.editor)||void 0===e||e.start()},addNodeToDrawFlow:function(e,t,i,n){if("fixed"===this.editor.editor_mode)return!1;i=i*(this.editor.precanvas.clientWidth/(this.editor.precanvas.clientWidth*this.editor.zoom))-this.editor.precanvas.getBoundingClientRect().x*(this.editor.precanvas.clientWidth/(this.editor.precanvas.clientWidth*this.editor.zoom)),n=n*(this.editor.precanvas.clientHeight/(this.editor.precanvas.clientHeight*this.editor.zoom))-this.editor.precanvas.getBoundingClientRect().y*(this.editor.precanvas.clientHeight/(this.editor.precanvas.clientHeight*this.editor.zoom));var s=t.id,a=ct();this.registerBlock(t,a);var o=this.editor.addNode(s,t.inputs,t.outputs,i,n,"class",{},a,"vue");this.editor.drawflow.drawflow["Home"].context.nodes[a]={type:s,id:o,parameters:t.parameters,name:t.name,output_vars:t.output_vars}},sendBotContext:function(e){for(var t in e){var i=e[t].id,n=this.getPreviousNodes(parseInt(i));this.updateBlockContext(i,n)}},updateBlockContext:function(e,t){L["a"].emitter.emit("editor-block-bot-context-update-"+e,this.fieldsContext,t)},removeNode:function(e){delete this.nodesStatuses[e],0===Object.keys(this.nodesStatuses).length&&(this.validationStatus=!0)},sendContext:function(e){var t=e.input_id,i=this.getForwardNodesToBeUpdated(t),n=this.getPreviousNodes(parseInt(t));L["a"].emitter.emit("editor-block-bot-context-update-"+t,this.fieldsContext,n);for(var s=0;s<i.length;s++)L["a"].emitter.emit("editor-block-bot-context-update-"+i[s],this.fieldsContext,n)}}});i("250d");Tt.render=m;t["a"]=Tt},8872:function(e,t,i){},"8a14":function(e,t,i){"use strict";var n=i("7a23"),s=Object(n["defineComponent"])({name:"spinner",props:{color:{type:String,default:"#000"},height:{type:Number,default:64},width:{type:Number,default:64}}});
/**
 * Vue 3 Loading Overlay 0.0.0
 * (c) 2020
 * @license MIT
 */const a=Object(n["createVNode"])("g",{fill:"none","fill-rule":"evenodd"},[Object(n["createVNode"])("g",{transform:"translate(1 1)","stroke-width":"2"},[Object(n["createVNode"])("circle",{"stroke-opacity":".25",cx:"18",cy:"18",r:"18"}),Object(n["createVNode"])("path",{d:"M36 18c0-9.94-8.06-18-18-18"},[Object(n["createVNode"])("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"0.8s",repeatCount:"indefinite"})])])],-1);function o(e,t,i,s,o,r){return Object(n["openBlock"])(),Object(n["createBlock"])("svg",{viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",width:e.width,height:e.height,stroke:e.color},[a],8,["width","height","stroke"])}s.render=o,s.__file="src/loaders/Spinner.vue";var r=Object(n["defineComponent"])({name:"dots",props:{color:{type:String,default:"#000"},height:{type:Number,default:240},width:{type:Number,default:60}}});const l=Object(n["createVNode"])("circle",{cx:"15",cy:"15",r:"15"},[Object(n["createVNode"])("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),Object(n["createVNode"])("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})],-1),c=Object(n["createVNode"])("circle",{cx:"60",cy:"15",r:"9","fill-opacity":"0.3"},[Object(n["createVNode"])("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),Object(n["createVNode"])("animate",{attributeName:"fill-opacity",from:"0.5",to:"0.5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})],-1),d=Object(n["createVNode"])("circle",{cx:"105",cy:"15",r:"15"},[Object(n["createVNode"])("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),Object(n["createVNode"])("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})],-1);function u(e,t,i,s,a,o){return Object(n["openBlock"])(),Object(n["createBlock"])("svg",{viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",fill:e.color,width:e.width,height:e.height},[l,c,d],8,["fill","width","height"])}r.render=u,r.__file="src/loaders/Dots.vue";var h=Object(n["defineComponent"])({name:"bars",props:{color:{type:String,default:"#000"},height:{type:Number,default:40},width:{type:Number,default:40}}});const p=Object(n["createVNode"])("rect",{x:"0",y:"13",width:"4",height:"5"},[Object(n["createVNode"])("animate",{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0s",dur:"0.6s",repeatCount:"indefinite"}),Object(n["createVNode"])("animate",{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0s",dur:"0.6s",repeatCount:"indefinite"})],-1),g=Object(n["createVNode"])("rect",{x:"10",y:"13",width:"4",height:"5"},[Object(n["createVNode"])("animate",{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0.15s",dur:"0.6s",repeatCount:"indefinite"}),Object(n["createVNode"])("animate",{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0.15s",dur:"0.6s",repeatCount:"indefinite"})],-1),f=Object(n["createVNode"])("rect",{x:"20",y:"13",width:"4",height:"5"},[Object(n["createVNode"])("animate",{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0.3s",dur:"0.6s",repeatCount:"indefinite"}),Object(n["createVNode"])("animate",{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0.3s",dur:"0.6s",repeatCount:"indefinite"})],-1);function m(e,t,i,s,a,o){return Object(n["openBlock"])(),Object(n["createBlock"])("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",height:e.height,width:e.width,fill:e.color},[p,g,f],8,["height","width","fill"])}h.render=m,h.__file="src/loaders/Bars.vue";var v={Spinner:s,Dots:r,Bars:h},b=Object(n["defineComponent"])({name:"vue-loading",props:{active:Boolean,programmatic:Boolean,container:[Object,Function,HTMLElement],isFullPage:{type:Boolean,default:!0},enforceFocus:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!1},transition:{type:String,default:"fade"},canCancel:Boolean,onCancel:{type:Function,default:()=>{}},color:String,backgroundColor:String,blur:{type:String,default:"2px"},opacity:Number,width:Number,height:Number,zIndex:{type:Number,default:100},loader:{type:String,default:"spinner"}},setup(e,t){const i=Object(n["ref"])(e.active),s=Object(n["computed"])(()=>{let t={background:e.backgroundColor,opacity:e.opacity,backdropFilter:`blur(${e.blur})`};return t}),a=()=>{e.programmatic&&(i.value=!1,setTimeout(()=>{},150))},o=()=>{e.canCancel&&i.value&&(a(),e.onCancel())},r=e=>{27===e.keyCode&&o()},l=()=>{e.isFullPage&&e.lockScroll&&document.body.classList.add("vld-shown")},c=()=>{e.isFullPage&&e.lockScroll&&document.body.classList.remove("vld-shown")};return Object(n["onMounted"])(()=>{e.programmatic&&(i.value=!0,document.addEventListener("keyup",r))}),Object(n["onUnmounted"])(()=>{document.removeEventListener("keyup",r)}),Object(n["watch"])(()=>e.active,()=>{i.value=e.active}),Object(n["watch"])(i,()=>{i.value?l():c()}),{isActive:i,bgStyle:s,hide:a,cancel:o}},components:v});const y={class:"vld-icon"};function w(e,t,i,s,a,o){return Object(n["openBlock"])(),Object(n["createBlock"])(n["Transition"],{ref:"root",name:e.transition},{default:Object(n["withCtx"])(()=>[Object(n["withDirectives"])(Object(n["createVNode"])("div",{tabindex:"0",class:["vld-overlay is-active",{"is-full-page":e.isFullPage}],"aria-busy":e.isActive,"aria-label":"Loading",style:{zIndex:e.zIndex}},[Object(n["createVNode"])("div",{class:"vld-background",onClick:t[1]||(t[1]=Object(n["withModifiers"])((...t)=>e.cancel&&e.cancel(...t),["prevent"])),style:e.bgStyle},null,4),Object(n["createVNode"])("div",y,[Object(n["renderSlot"])(e.$slots,"before"),Object(n["renderSlot"])(e.$slots,"default",{},()=>[(Object(n["openBlock"])(),Object(n["createBlock"])(Object(n["resolveDynamicComponent"])(e.loader),{color:e.color,width:e.width,height:e.height},null,8,["color","width","height"]))]),Object(n["renderSlot"])(e.$slots,"after")])],14,["aria-busy"]),[[n["vShow"],e.isActive]])]),_:3},8,["name"])}b.render=w,b.__file="src/main/Component.vue",t["a"]=b},"8fba":function(e,t,i){"use strict";var n=i("7a23");const s={class:"modal__title"},a={class:"modal__content"},o={class:"modal__action"},r={key:0,class:"fas fa-circle-notch fa-spin"};function l(e,t){const i=Object(n["resolveComponent"])("vue-final-modal");return Object(n["openBlock"])(),Object(n["createBlock"])(i,Object(n["mergeProps"])(e.$attrs,{classes:"modal-container","content-class":"modal-content modal-content-"+e.$attrs.modalSize}),{default:Object(n["withCtx"])(({params:t,close:i})=>[Object(n["createVNode"])("span",s,[Object(n["renderSlot"])(e.$slots,"title")]),Object(n["createVNode"])("div",a,[Object(n["renderSlot"])(e.$slots,"default",{params:t})]),Object(n["createVNode"])("div",o,[e.$attrs.hideCancel?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])("button",{key:0,onClick:t=>e.$emit("cancel",i),class:"boto-button secondary-btn large"},Object(n["toDisplayString"])(e.$attrs.cancelText),9,["onClick"])),e.$attrs.hideConfirm?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])("button",{key:1,onClick:t=>e.$emit("confirm",i),class:["boto-button primary-btn large ml-2",e.$attrs.confirmEnabled?"primary-btn":"btn-secondary"],disabled:!e.$attrs.confirmEnabled},[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.$attrs.confirmText)+" ",1),e.$attrs.loading?(Object(n["openBlock"])(),Object(n["createBlock"])("i",r)):Object(n["createCommentVNode"])("",!0)],10,["onClick","disabled"]))])]),_:3},16,["content-class"])}var c=Object(n["defineComponent"])({name:"BotoModal",inheritAttrs:!0,emits:["confirm","cancel"]});i("eb6e");c.render=l;t["a"]=c},"9dfc":function(e,t,i){},b9cd:function(e,t,i){},d26e:function(e,t,i){!function(t,i){e.exports=i()}(0,(function(){"use strict";function e(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function t(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function i(i){for(var n=1;n<arguments.length;n++){var s=null!=arguments[n]?arguments[n]:{};n%2?t(Object(s),!0).forEach((function(t){e(i,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(s)):t(Object(s)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(s,e))}))}return i}const n=(e,t,i,n)=>(e=""+e,t=""+t,n&&(e=e.trim(),t=t.trim()),i?e==t:e.toLowerCase()==t.toLowerCase());function s(e,t){var i,n={};for(i in e)t.indexOf(i)<0&&(n[i]=e[i]);return n}function a(e){var t=document.createElement("div");return e.replace(/\&#?[0-9a-z]+;/gi,(function(e){return t.innerHTML=e,t.innerText}))}function o(e,t){for(t=t||"previous";e=e[t+"Sibling"];)if(3==e.nodeType)return e}function r(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/`|'/g,"&#039;"):e}function l(e){var t=Object.prototype.toString.call(e).split(" ")[1].slice(0,-1);return e===Object(e)&&"Array"!=t&&"Function"!=t&&"RegExp"!=t&&"HTMLUnknownElement"!=t}function c(e,t,i){function n(e,t){for(var i in t)if(t.hasOwnProperty(i)){if(l(t[i])){l(e[i])?n(e[i],t[i]):e[i]=Object.assign({},t[i]);continue}if(Array.isArray(t[i])){e[i]=Object.assign([],t[i]);continue}e[i]=t[i]}}return e instanceof Object||(e={}),n(e,t),i&&n(e,i),e}function d(e){return String.prototype.normalize?"string"==typeof e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,""):void 0:e}var u=()=>/(?=.*chrome)(?=.*android)/i.test(navigator.userAgent),h={delimiters:",",pattern:null,tagTextProp:"value",maxTags:1/0,callbacks:{},addTagOnBlur:!0,duplicates:!1,whitelist:[],blacklist:[],enforceWhitelist:!1,keepInvalidTags:!1,mixTagsAllowedAfter:/,|\.|\:|\s/,mixTagsInterpolator:["[[","]]"],backspace:!0,skipInvalid:!1,pasteAsTags:!0,editTags:{clicks:2,keepInvalid:!0},transformTag:()=>{},trim:!0,a11y:{focusableTags:!1},mixMode:{insertAfterTag:" "},autoComplete:{enabled:!0,rightKey:!1},classNames:{namespace:"tagify",mixMode:"tagify--mix",selectMode:"tagify--select",input:"tagify__input",focus:"tagify--focus",tag:"tagify__tag",tagNoAnimation:"tagify--noAnim",tagInvalid:"tagify--invalid",tagNotAllowed:"tagify--notAllowed",inputInvalid:"tagify__input--invalid",tagX:"tagify__tag__removeBtn",tagText:"tagify__tag-text",dropdown:"tagify__dropdown",dropdownWrapper:"tagify__dropdown__wrapper",dropdownItem:"tagify__dropdown__item",dropdownItemActive:"tagify__dropdown__item--active",dropdownInital:"tagify__dropdown--initial",scopeLoading:"tagify--loading",tagLoading:"tagify__tag--loading",tagEditing:"tagify__tag--editable",tagFlash:"tagify__tag--flash",tagHide:"tagify__tag--hide",hasMaxTags:"tagify--hasMaxTags",hasNoTags:"tagify--noTags",empty:"tagify--empty"},dropdown:{classname:"",enabled:2,maxItems:10,searchKeys:["value","searchBy"],fuzzySearch:!0,caseSensitive:!1,accentedSearch:!0,highlightFirst:!1,closeOnSelect:!0,clearOnSelect:!0,position:"all",appendTarget:null},hooks:{beforeRemoveTag:()=>Promise.resolve(),beforePaste:()=>Promise.resolve(),suggestionClick:()=>Promise.resolve()}};function p(){this.dropdown={};for(let e in this._dropdown)this.dropdown[e]="function"==typeof this._dropdown[e]?this._dropdown[e].bind(this):this._dropdown[e];this.settings.dropdown.enabled>=0&&this.dropdown.init()}var g,f={init(){this.DOM.dropdown=this.parseTemplate("dropdown",[this.settings]),this.DOM.dropdown.content=this.DOM.dropdown.querySelector(this.settings.classNames.dropdownWrapperSelector)},show(e){var t,i,s,a=this.settings,o="mix"==a.mode&&!a.enforceWhitelist,r=!a.whitelist||!a.whitelist.length,c="manual"==a.dropdown.position;if(e=void 0===e?this.state.inputText:e,(!r||o||a.templates.dropdownItemNoMatch)&&!1!==a.dropdown.enable&&!this.state.isLoading){if(clearTimeout(this.dropdownHide__bindEventsTimeout),this.suggestedListItems=this.dropdown.filterListItems(e),e&&!this.suggestedListItems.length&&(this.trigger("dropdown:noMatch",e),a.templates.dropdownItemNoMatch&&(s=a.templates.dropdownItemNoMatch.call(this,{value:e}))),!s){if(this.suggestedListItems.length)e&&o&&!this.state.editing.scope&&!n(this.suggestedListItems[0].value,e)&&this.suggestedListItems.unshift({value:e});else{if(!e||!o||this.state.editing.scope)return this.input.autocomplete.suggest.call(this),void this.dropdown.hide();this.suggestedListItems=[{value:e}]}i=""+(l(t=this.suggestedListItems[0])?t.value:t),a.autoComplete&&i&&0==i.indexOf(e)&&this.input.autocomplete.suggest.call(this,t)}this.dropdown.fill(s),a.dropdown.highlightFirst&&this.dropdown.highlightOption(this.DOM.dropdown.content.children[0]),this.state.dropdown.visible||setTimeout(this.dropdown.events.binding.bind(this)),this.state.dropdown.visible=e||!0,this.state.dropdown.query=e,this.setStateSelection(),c||setTimeout(()=>{this.dropdown.position(),this.dropdown.render()}),setTimeout(()=>{this.trigger("dropdown:show",this.DOM.dropdown)})}},hide(e){var t=this.DOM,i=t.scope,n=t.dropdown,s="manual"==this.settings.dropdown.position&&!e;if(n&&document.body.contains(n)&&!s)return window.removeEventListener("resize",this.dropdown.position),this.dropdown.events.binding.call(this,!1),i.setAttribute("aria-expanded",!1),n.parentNode.removeChild(n),setTimeout(()=>{this.state.dropdown.visible=!1},100),this.state.dropdown.query=this.state.ddItemData=this.state.ddItemElm=this.state.selection=null,this.state.tag&&this.state.tag.value.length&&(this.state.flaggedTags[this.state.tag.baseOffset]=this.state.tag),this.trigger("dropdown:hide",n),this},render(){var e,t,i,n=(e=this.DOM.dropdown,(i=e.cloneNode(!0)).style.cssText="position:fixed; top:-9999px; opacity:0",document.body.appendChild(i),t=i.clientHeight,i.parentNode.removeChild(i),t),s=this.settings;return this.DOM.scope.setAttribute("aria-expanded",!0),document.body.contains(this.DOM.dropdown)||(this.DOM.dropdown.classList.add(s.classNames.dropdownInital),this.dropdown.position(n),s.dropdown.appendTarget.appendChild(this.DOM.dropdown),setTimeout(()=>this.DOM.dropdown.classList.remove(s.classNames.dropdownInital))),this},fill(e){var t;e="string"==typeof e?e:this.dropdown.createListHTML(e||this.suggestedListItems),this.DOM.dropdown.content.innerHTML=(t=e)?t.replace(/\>[\r\n ]+\</g,"><").replace(/(<.*?>)|\s+/g,(e,t)=>t||" "):""},refilter(e){e=e||this.state.dropdown.query||"",this.suggestedListItems=this.dropdown.filterListItems(e),this.dropdown.fill(),this.suggestedListItems.length||this.dropdown.hide(),this.trigger("dropdown:updated",this.DOM.dropdown)},position(e){var t=this.settings.dropdown;if("manual"!=t.position){var i,n,s,a,o,r,l=this.DOM.dropdown,c=t.placeAbove,d=document.documentElement.clientHeight,u=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)>480?t.position:"all",h=this.DOM["input"==u?"input":"scope"];e=e||l.clientHeight,this.state.dropdown.visible&&("text"==u?(s=(i=this.getCaretGlobalPosition()).bottom,n=i.top,a=i.left,o="auto"):(r=function(e){for(var t=0,i=0;e;)t+=e.offsetLeft||0,i+=e.offsetTop||0,e=e.parentNode;return{left:t,top:i}}(this.settings.dropdown.appendTarget),n=(i=h.getBoundingClientRect()).top-r.top,s=i.bottom-1-r.top,a=i.left-r.left,o=i.width+"px"),n=Math.floor(n),s=Math.ceil(s),c=void 0===c?d-i.bottom<e:c,l.style.cssText="left:"+(a+window.pageXOffset)+"px; width:"+o+";"+(c?"top: "+(n+window.pageYOffset)+"px":"top: "+(s+window.pageYOffset)+"px"),l.setAttribute("placement",c?"top":"bottom"),l.setAttribute("position",u))}},events:{binding(e=!0){var t=this.dropdown.events.callbacks,i=this.listeners.dropdown=this.listeners.dropdown||{position:this.dropdown.position.bind(this),onKeyDown:t.onKeyDown.bind(this),onMouseOver:t.onMouseOver.bind(this),onMouseLeave:t.onMouseLeave.bind(this),onClick:t.onClick.bind(this),onScroll:t.onScroll.bind(this)},n=e?"addEventListener":"removeEventListener";"manual"!=this.settings.dropdown.position&&(window[n]("resize",i.position),window[n]("keydown",i.onKeyDown)),this.DOM.dropdown[n]("mouseover",i.onMouseOver),this.DOM.dropdown[n]("mouseleave",i.onMouseLeave),this.DOM.dropdown[n]("mousedown",i.onClick),this.DOM.dropdown.content[n]("scroll",i.onScroll)},callbacks:{onKeyDown(e){var t=this.DOM.dropdown.querySelector(this.settings.classNames.dropdownItemActiveSelector),i=this.dropdown.getSuggestionDataByNode(t);switch(e.key){case"ArrowDown":case"ArrowUp":case"Down":case"Up":var n;e.preventDefault(),t&&(t=t[("ArrowUp"==e.key||"Up"==e.key?"previous":"next")+"ElementSibling"]),t||(n=this.DOM.dropdown.content.children,t=n["ArrowUp"==e.key||"Up"==e.key?n.length-1:0]),i=this.dropdown.getSuggestionDataByNode(t),this.dropdown.highlightOption(t,!0);break;case"Escape":case"Esc":this.dropdown.hide();break;case"ArrowRight":if(this.state.actions.ArrowLeft)return;case"Tab":if("mix"!=this.settings.mode&&t&&!this.settings.autoComplete.rightKey&&!this.state.editing){e.preventDefault();var s=this.dropdown.getMappedValue(i);return this.input.autocomplete.set.call(this,s),!1}return!0;case"Enter":e.preventDefault(),this.settings.hooks.suggestionClick(e,{tagify:this,tagData:i,suggestionElm:t}).then(()=>{if(t)return this.dropdown.selectOption(t);this.dropdown.hide(),"mix"!=this.settings.mode&&this.addTags(this.state.inputText.trim(),!0)}).catch(e=>e);break;case"Backspace":{if("mix"==this.settings.mode||this.state.editing.scope)return;let e=this.state.inputText.trim();""!=e&&8203!=e.charCodeAt(0)||(!0===this.settings.backspace?this.removeTags():"edit"==this.settings.backspace&&setTimeout(this.editTag.bind(this),0))}}},onMouseOver(e){var t=e.target.closest(this.settings.classNames.dropdownItemSelector);t&&this.dropdown.highlightOption(t)},onMouseLeave(e){this.dropdown.highlightOption()},onClick(e){if(0==e.button&&e.target!=this.DOM.dropdown&&e.target!=this.DOM.dropdown.content){var t=e.target.closest(this.settings.classNames.dropdownItemSelector),i=this.dropdown.getSuggestionDataByNode(t);this.state.actions.selectOption=!0,setTimeout(()=>this.state.actions.selectOption=!1,50),this.settings.hooks.suggestionClick(e,{tagify:this,tagData:i,suggestionElm:t}).then(()=>{t?this.dropdown.selectOption(t):this.dropdown.hide()}).catch(e=>e)}},onScroll(e){var t=e.target,i=t.scrollTop/(t.scrollHeight-t.parentNode.clientHeight)*100;this.trigger("dropdown:scroll",{percentage:Math.round(i)})}}},getSuggestionDataByNode(e){var t=e?+e.getAttribute("tagifySuggestionIdx"):-1;return this.suggestedListItems[t]||null},highlightOption(e,t){var i,n=this.settings.classNames.dropdownItemActive;if(this.state.ddItemElm&&(this.state.ddItemElm.classList.remove(n),this.state.ddItemElm.removeAttribute("aria-selected")),!e)return this.state.ddItemData=null,this.state.ddItemElm=null,void this.input.autocomplete.suggest.call(this);i=this.suggestedListItems[this.getNodeIndex(e)],this.state.ddItemData=i,this.state.ddItemElm=e,e.classList.add(n),e.setAttribute("aria-selected",!0),t&&(e.parentNode.scrollTop=e.clientHeight+e.offsetTop-e.parentNode.clientHeight),this.settings.autoComplete&&(this.input.autocomplete.suggest.call(this,i),this.dropdown.position())},selectOption(e){var t,i=this.settings.dropdown,n=i.clearOnSelect,s=i.closeOnSelect;if(!e)return t=this.addTags(this.state.inputText,!0),void(s&&this.dropdown.hide());var a=e.getAttribute("tagifySuggestionIdx"),o=this.suggestedListItems[+a];this.trigger("dropdown:select",{data:o,elm:e}),a&&o?(this.state.editing?this.onEditTagDone(null,c({__isValid:!0},o)):t=this["mix"==this.settings.mode?"addMixTags":"addTags"]([o],n),this.DOM.input.parentNode&&(setTimeout(()=>{this.DOM.input.focus(),this.toggleFocusClass(!0),this.placeCaretAfterNode(t)}),s?setTimeout(this.dropdown.hide.bind(this)):this.dropdown.refilter())):this.dropdown.hide()},selectAll(){return this.suggestedListItems.length=0,this.dropdown.hide(),this.addTags(this.dropdown.filterListItems(""),!0),this},filterListItems(e,t){var i,n,s,a,o,r=this.settings,c=r.dropdown,u=(t=t||{},e="select"==r.mode&&this.value.length&&this.value[0][r.tagTextProp]==e?"":e,[]),h=r.whitelist,p=c.maxItems||1/0,g=c.searchKeys,f=0;if(!e||!g.length)return(r.duplicates?h:h.filter(e=>!this.isTagDuplicate(l(e)?e.value:e))).slice(0,p);function m(e,t){return t.toLowerCase().split(" ").every(t=>e.includes(t.toLowerCase()))}for(o=c.caseSensitive?""+e:(""+e).toLowerCase();f<h.length;f++){i=h[f]instanceof Object?h[f]:{value:h[f]};let e=Object.keys(i).some(e=>g.includes(e))?g:["value"];if(c.fuzzySearch&&!t.exact?(s=e.reduce((e,t)=>e+" "+(i[t]||""),"").toLowerCase(),c.accentedSearch&&(s=d(s),o=d(o)),n=m(s,o)):n=e.some(e=>{var n=""+(i[e]||"");return c.accentedSearch&&(n=d(n),o=d(o)),c.caseSensitive||(n=n.toLowerCase()),t.exact?n==o:0==n.indexOf(o)}),a=!r.duplicates&&this.isTagDuplicate(l(i)?i.value:i),n&&!a&&p--&&u.push(i),0==p)break}return u},getMappedValue(e){var t=this.settings.dropdown.mapValueTo;return t?"function"==typeof t?t(e):e[t]||e.value:e.value},createListHTML(e){return c([],e).map((e,t)=>{"string"!=typeof e&&"number"!=typeof e||(e={value:e});var i=this.dropdown.getMappedValue(e);e.value=i&&"string"==typeof i?r(i):i;var n=this.settings.templates.dropdownItem.apply(this,[e,this]);return n.replace(/\s*tagifySuggestionIdx=(["'])(.*?)\1/gim,"").replace(">",` tagifySuggestionIdx="${t}">`)}).join("")}},m={empty:"empty",exceed:"number of tags exceeded",pattern:"pattern mismatch",duplicate:"already exists",notAllowed:"not allowed"},v={wrapper:(e,t)=>`<tags class="${t.classNames.namespace} ${t.mode?""+t.classNames[t.mode+"Mode"]:""} ${e.className}"\n                    ${t.readonly?"readonly":""}\n                    ${t.disabled?"disabled":""}\n                    ${t.required?"required":""}\n                    tabIndex="-1">\n            <span ${t.readonly&&"mix"==t.mode?"":"contenteditable"} data-placeholder="${t.placeholder||"&#8203;"}" aria-placeholder="${t.placeholder||""}"\n                class="${t.classNames.input}"\n                role="textbox"\n                aria-autocomplete="both"\n                aria-multiline="${"mix"==t.mode}"></span>\n        </tags>`,tag(e,t){var i=this.settings;return`<tag title="${e.title||e.value}"\n                    contenteditable='false'\n                    spellcheck='false'\n                    tabIndex="${i.a11y.focusableTags?0:-1}"\n                    class="${i.classNames.tag} ${e.class||""}"\n                    ${this.getAttributes(e)}>\n            <x title='' class="${i.classNames.tagX}" role='button' aria-label='remove tag'></x>\n            <div>\n                <span class="${i.classNames.tagText}">${e[i.tagTextProp]||e.value}</span>\n            </div>\n        </tag>`},dropdown(e){var t=e.dropdown,i="manual"==t.position,n=""+e.classNames.dropdown;return`<div class="${i?"":n} ${t.classname}" role="listbox" aria-labelledby="dropdown">\n                    <div class="${e.classNames.dropdownWrapper}"></div>\n                </div>`},dropdownItem(e,t){return`<div ${this.getAttributes(e)}\n                    class='${this.settings.classNames.dropdownItem} ${e.class?e.class:""}'\n                    tabindex="0"\n                    role="option">${e.value}</div>`},dropdownItemNoMatch:null},b={customBinding(){this.customEventsList.forEach(e=>{this.on(e,this.settings.callbacks[e])})},binding(e=!0){var t,i=this.events.callbacks,n=e?"addEventListener":"removeEventListener";if(!this.state.mainEvents||!e)for(var s in this.state.mainEvents=e,e&&!this.listeners.main&&(this.events.bindGlobal.call(this),this.settings.isJQueryPlugin&&jQuery(this.DOM.originalInput).on("tagify.removeAllTags",this.removeAllTags.bind(this))),t=this.listeners.main=this.listeners.main||{focus:["input",i.onFocusBlur.bind(this)],keydown:["input",i.onKeydown.bind(this)],click:["scope",i.onClickScope.bind(this)],dblclick:["scope",i.onDoubleClickScope.bind(this)],paste:["input",i.onPaste.bind(this)]})this.DOM[t[s][0]][n](s,t[s][1])},bindGlobal(e){var t,i=this.events.callbacks,n=e?"removeEventListener":"addEventListener";if(e||!this.listeners.global)for(t of(this.listeners.global=this.listeners&&this.listeners.global||[{type:this.isIE?"keydown":"input",target:this.DOM.input,cb:i[this.isIE?"onInputIE":"onInput"].bind(this)},{type:"keydown",target:window,cb:i.onWindowKeyDown.bind(this)},{type:"blur",target:this.DOM.input,cb:i.onFocusBlur.bind(this)}],this.listeners.global))t.target[n](t.type,t.cb)},unbindGlobal(){this.events.bindGlobal.call(this,!0)},callbacks:{onFocusBlur(e){var t=e.target?this.trim(e.target.textContent):"",i=this.settings,n=e.type,s=i.dropdown.enabled>=0,a={relatedTarget:e.relatedTarget},o=this.state.actions.selectOption&&(s||!i.dropdown.closeOnSelect),r=this.state.actions.addNew&&s,l=e.relatedTarget&&e.relatedTarget.classList.contains(i.classNames.tag)&&this.DOM.scope.contains(e.relatedTarget);if("blur"==n){if(e.relatedTarget===this.DOM.scope)return this.dropdown.hide(),void this.DOM.input.focus();this.postUpdate(),this.triggerChangeEvent()}if(!o&&!r)if(this.state.hasFocus="focus"==n&&+new Date,this.toggleFocusClass(this.state.hasFocus),"mix"!=i.mode){if("focus"==n)return this.trigger("focus",a),void(0===i.dropdown.enabled&&this.dropdown.show());"blur"==n&&(this.trigger("blur",a),this.loading(!1),"select"==this.settings.mode&&l&&(t=""),("select"==this.settings.mode&&t?!this.value.length||this.value[0].value!=t:t&&!this.state.actions.selectOption&&i.addTagOnBlur)&&this.addTags(t,!0),"select"!=this.settings.mode||t||this.removeTags()),this.DOM.input.removeAttribute("style"),this.dropdown.hide()}else"focus"==n?this.trigger("focus",a):"blur"==e.type&&(this.trigger("blur",a),this.loading(!1),this.dropdown.hide(),this.state.dropdown.visible=void 0,this.setStateSelection())},onWindowKeyDown(e){var t,i=document.activeElement;if(i.classList.contains(this.settings.classNames.tag)&&this.DOM.scope.contains(document.activeElement))switch(t=i.nextElementSibling,e.key){case"Backspace":this.removeTags(i),(t||this.DOM.input).focus();break;case"Enter":setTimeout(this.editTag.bind(this),0,i)}},onKeydown(e){var t=this.trim(e.target.textContent);if(this.trigger("keydown",{originalEvent:this.cloneEvent(e)}),"mix"==this.settings.mode){switch(e.key){case"Left":case"ArrowLeft":this.state.actions.ArrowLeft=!0;break;case"Delete":case"Backspace":if(this.state.editing)return;var i,n,s,r=document.getSelection(),l="Delete"==e.key&&r.anchorOffset==(r.anchorNode.length||0),c=1==r.anchorNode.nodeType||!r.anchorOffset&&r.anchorNode.previousElementSibling,d=a(this.DOM.input.innerHTML),h=this.getTagElms();if("edit"==this.settings.backspace&&c)return i=1==r.anchorNode.nodeType?null:r.anchorNode.previousElementSibling,setTimeout(this.editTag.bind(this),0,i),void e.preventDefault();if(u()&&c)return s=o(c),c.hasAttribute("readonly")||c.remove(),this.DOM.input.focus(),void setTimeout(()=>{this.placeCaretAfterNode(s),this.DOM.input.click()});if("BR"==r.anchorNode.nodeName)return;if((l||c)&&1==r.anchorNode.nodeType?n=0==r.anchorOffset?l?h[0]:null:h[r.anchorOffset-1]:l?n=r.anchorNode.nextElementSibling:c&&(n=c),3==r.anchorNode.nodeType&&!r.anchorNode.nodeValue&&r.anchorNode.previousElementSibling&&e.preventDefault(),(c||l)&&!this.settings.backspace)return void e.preventDefault();if("Range"!=r.type&&!r.anchorOffset&&r.anchorNode==this.DOM.input&&"Delete"!=e.key)return void e.preventDefault();if("Range"!=r.type&&n&&n.hasAttribute("readonly"))return void this.placeCaretAfterNode(o(n));clearTimeout(g),g=setTimeout(()=>{var e=document.getSelection(),t=a(this.DOM.input.innerHTML),i=e.anchorNode.previousElementSibling;if(!u()&&t.length>=d.length&&i&&!i.hasAttribute("readonly")&&(this.removeTags(i),this.fixFirefoxLastTagNoCaret(),2==this.DOM.input.children.length&&"BR"==this.DOM.input.children[1].tagName))return this.DOM.input.innerHTML="",this.value.length=0,!0;this.value=[].map.call(h,(e,t)=>{var i=this.tagData(e);if(e.parentNode||i.readonly)return i;this.trigger("remove",{tag:e,index:t,data:i})}).filter(e=>e)},20)}return!0}switch(e.key){case"Backspace":this.state.dropdown.visible&&"manual"!=this.settings.dropdown.position||""!=t&&8203!=t.charCodeAt(0)||(!0===this.settings.backspace?this.removeTags():"edit"==this.settings.backspace&&setTimeout(this.editTag.bind(this),0));break;case"Esc":case"Escape":if(this.state.dropdown.visible)return;e.target.blur();break;case"Down":case"ArrowDown":this.state.dropdown.visible||this.dropdown.show();break;case"ArrowRight":{let e=this.state.inputSuggestion||this.state.ddItemData;if(e&&this.settings.autoComplete.rightKey)return void this.addTags([e],!0);break}case"Tab":{let i="select"==this.settings.mode;if(!t||i)return!0;e.preventDefault()}case"Enter":if(this.state.dropdown.visible||229==e.keyCode)return;e.preventDefault(),setTimeout(()=>{this.state.actions.selectOption||this.addTags(t,!0)})}},onInput(e){if("mix"==this.settings.mode)return this.events.callbacks.onMixTagsInput.call(this,e);var t=this.input.normalize.call(this),i=t.length>=this.settings.dropdown.enabled,n={value:t,inputElm:this.DOM.input};n.isValid=this.validateTag({value:t}),this.state.inputText!=t&&(this.input.set.call(this,t,!1),-1!=t.search(this.settings.delimiters)?this.addTags(t)&&this.input.set.call(this):this.settings.dropdown.enabled>=0&&this.dropdown[i?"show":"hide"](t),this.trigger("input",n))},onMixTagsInput(e){var t,i,n,s,a,o,r,l,d=this.settings,h=this.value.length,p=this.getTagElms(),g=document.createDocumentFragment(),f=window.getSelection().getRangeAt(0),m=[].map.call(p,e=>this.tagData(e).value);if("deleteContentBackward"==e.inputType&&u()&&this.events.callbacks.onKeydown.call(this,{target:e.target,key:"Backspace"}),this.value.slice().forEach(e=>{e.readonly&&!m.includes(e.value)&&g.appendChild(this.createTagElem(e))}),g.childNodes.length&&(f.insertNode(g),this.setRangeAtStartEnd(!1,g.lastChild)),p.length!=h)return this.value=[].map.call(this.getTagElms(),e=>this.tagData(e)),void this.update({withoutChangeEvent:!0});if(this.hasMaxTags())return!0;if(window.getSelection&&(o=window.getSelection()).rangeCount>0&&3==o.anchorNode.nodeType){if((f=o.getRangeAt(0).cloneRange()).collapse(!0),f.setStart(o.focusNode,0),n=(t=f.toString().slice(0,f.endOffset)).split(d.pattern).length-1,(i=t.match(d.pattern))&&(s=t.slice(t.lastIndexOf(i[i.length-1]))),s){if(this.state.actions.ArrowLeft=!1,this.state.tag={prefix:s.match(d.pattern)[0],value:s.replace(d.pattern,"")},this.state.tag.baseOffset=o.baseOffset-this.state.tag.value.length,l=this.state.tag.value.match(d.delimiters))return this.state.tag.value=this.state.tag.value.replace(d.delimiters,""),this.state.tag.delimiters=l[0],this.addTags(this.state.tag.value,d.dropdown.clearOnSelect),void this.dropdown.hide();a=this.state.tag.value.length>=d.dropdown.enabled;try{r=(r=this.state.flaggedTags[this.state.tag.baseOffset]).prefix==this.state.tag.prefix&&r.value[0]==this.state.tag.value[0],this.state.flaggedTags[this.state.tag.baseOffset]&&!this.state.tag.value&&delete this.state.flaggedTags[this.state.tag.baseOffset]}catch(e){}(r||n<this.state.mixMode.matchedPatternCount)&&(a=!1)}else this.state.flaggedTags={};this.state.mixMode.matchedPatternCount=n}setTimeout(()=>{this.update({withoutChangeEvent:!0}),this.trigger("input",c({},this.state.tag,{textContent:this.DOM.input.textContent})),this.state.tag&&this.dropdown[a?"show":"hide"](this.state.tag.value)},10)},onInputIE(e){var t=this;setTimeout((function(){t.events.callbacks.onInput.call(t,e)}))},onClickScope(e){var t=this.settings,i=e.target.closest("."+t.classNames.tag),n=+new Date-this.state.hasFocus;if(e.target!=this.DOM.scope){if(!e.target.classList.contains(t.classNames.tagX))return i?(this.trigger("click",{tag:i,index:this.getNodeIndex(i),data:this.tagData(i),originalEvent:this.cloneEvent(e)}),void(1!==t.editTags&&1!==t.editTags.clicks||this.events.callbacks.onDoubleClickScope.call(this,e))):void(e.target==this.DOM.input&&("mix"==t.mode&&this.fixFirefoxLastTagNoCaret(),n>500)?this.state.dropdown.visible?this.dropdown.hide():0===t.dropdown.enabled&&"mix"!=t.mode&&this.dropdown.show():"select"==t.mode&&!this.state.dropdown.visible&&this.dropdown.show());this.removeTags(e.target.parentNode)}else this.state.hasFocus||this.DOM.input.focus()},onPaste(e){var t,i;e.preventDefault(),this.settings.readonly||(t=e.clipboardData||window.clipboardData,i=t.getData("Text"),this.settings.hooks.beforePaste(e,{tagify:this,pastedText:i,clipboardData:t}).then(t=>{void 0===t&&(t=i),t&&(this.injectAtCaret(t,window.getSelection().getRangeAt(0)),"mix"==this.settings.mode?this.events.callbacks.onMixTagsInput.call(this,e):this.settings.pasteAsTags?this.addTags(t,!0):this.state.inputText=t)}).catch(e=>e))},onEditTagInput(e,t){var i=e.closest("."+this.settings.classNames.tag),n=this.getNodeIndex(i),s=this.tagData(i),a=this.input.normalize.call(this,e),o=i.innerHTML!=i.__tagifyTagData.__originalHTML,r=this.validateTag({[this.settings.tagTextProp]:a});o||!0!==e.originalIsValid||(r=!0),i.classList.toggle(this.settings.classNames.tagInvalid,!0!==r),s.__isValid=r,i.title=!0===r?s.title||s.value:r,a.length>=this.settings.dropdown.enabled&&(this.state.editing&&(this.state.editing.value=a),this.dropdown.show(a)),this.trigger("edit:input",{tag:i,index:n,data:c({},this.value[n],{newValue:a}),originalEvent:this.cloneEvent(t)})},onEditTagFocus(e){this.state.editing={scope:e,input:e.querySelector("[contenteditable]")}},onEditTagBlur(e){if(this.state.hasFocus||this.toggleFocusClass(),this.DOM.scope.contains(e)){var t,i,n=this.settings,s=e.closest("."+n.classNames.tag),a=this.input.normalize.call(this,e),o=this.tagData(s).__originalData,r=s.innerHTML!=s.__tagifyTagData.__originalHTML,l=this.validateTag({[n.tagTextProp]:a});if(a)if(r){if(t=this.hasMaxTags(),i=this.getWhitelistItem(a)||c({},o,{[n.tagTextProp]:a,value:a,__isValid:l}),n.transformTag.call(this,i,o),!0!==(l=!t&&this.validateTag({[n.tagTextProp]:i[n.tagTextProp]}))){if(this.trigger("invalid",{data:i,tag:s,message:l}),n.editTags.keepInvalid)return;n.keepInvalidTags?i.__isValid=l:i=o}else n.keepInvalidTags&&(delete i.title,delete i["aria-invalid"],delete i.class);this.onEditTagDone(s,i)}else this.onEditTagDone(s,o);else this.onEditTagDone(s)}},onEditTagkeydown(e,t){switch(this.trigger("edit:keydown",{originalEvent:this.cloneEvent(e)}),e.key){case"Esc":case"Escape":t.innerHTML=t.__tagifyTagData.__originalHTML;case"Enter":case"Tab":e.preventDefault(),e.target.blur()}},onDoubleClickScope(e){var t,i,n=e.target.closest("."+this.settings.classNames.tag),s=this.settings;n&&(t=n.classList.contains(this.settings.classNames.tagEditing),i=n.hasAttribute("readonly"),"select"==s.mode||s.readonly||t||i||!this.settings.editTags||this.editTag(n),this.toggleFocusClass(!0),this.trigger("dblclick",{tag:n,index:this.getNodeIndex(n),data:this.tagData(n)}))}}};function y(e,t){return e?e.previousElementSibling&&e.previousElementSibling.classList.contains("tagify")?(console.warn("Tagify: ","input element is already Tagified",e),this):(c(this,function(e){var t=document.createTextNode("");function i(e,i,n){n&&i.split(/\s+/g).forEach(i=>t[e+"EventListener"].call(t,i,n))}return{off(e,t){return i("remove",e,t),this},on(e,t){return t&&"function"==typeof t&&i("add",e,t),this},trigger(i,n,s){var a;if(s=s||{cloneData:!0},i)if(e.settings.isJQueryPlugin)"remove"==i&&(i="removeTag"),jQuery(e.DOM.originalInput).triggerHandler(i,[n]);else{try{var o="object"==typeof n?n:{value:n};if((o=s.cloneData?c({},o):o).tagify=this,n instanceof Object)for(var r in n)n[r]instanceof HTMLElement&&(o[r]=n[r]);a=new CustomEvent(i,{detail:o})}catch(e){console.warn(e)}t.dispatchEvent(a)}}}}(this)),this.isFirefox="undefined"!=typeof InstallTrigger,this.isIE=window.document.documentMode,this.applySettings(e,t||{}),this.state={inputText:"",editing:!1,actions:{},mixMode:{},dropdown:{},flaggedTags:{}},this.value=[],this.listeners={},this.DOM={},this.build(e),p.call(this),this.getCSSVars(),this.loadOriginalValues(),this.events.customBinding.call(this),this.events.binding.call(this),void(e.autofocus&&this.DOM.input.focus())):(console.warn("Tagify: ","input element not found",e),this)}return y.prototype={_dropdown:f,customEventsList:["change","add","remove","invalid","input","click","keydown","focus","blur","edit:input","edit:beforeUpdate","edit:updated","edit:start","edit:keydown","dropdown:show","dropdown:hide","dropdown:select","dropdown:updated","dropdown:noMatch","dropdown:scroll"],dataProps:["__isValid","__removed","__originalData","__originalHTML","__tagId"],trim(e){return this.settings.trim&&e&&"string"==typeof e?e.trim():e},parseHTML:function(e){return(new DOMParser).parseFromString(e.trim(),"text/html").body.firstElementChild},templates:v,parseTemplate(e,t){return e=this.settings.templates[e]||e,this.parseHTML(e.apply(this,t))},set whitelist(e){this.settings.whitelist=e&&Array.isArray(e)?e:[]},get whitelist(){return this.settings.whitelist},applySettings(e,t){h.templates=this.templates;var n=this.settings=c({},h,t);n.disabled=e.hasAttribute("disabled"),n.readonly=e.hasAttribute("readonly"),n.placeholder=e.getAttribute("placeholder")||n.placeholder||"",n.required=e.hasAttribute("required");for(let i in n.classNames)Object.defineProperty(n.classNames,i+"Selector",{get(){return"."+this[i].split(" ")[0]}});if(this.isIE&&(n.autoComplete=!1),["whitelist","blacklist"].forEach(t=>{var i=e.getAttribute("data-"+t);i&&(i=i.split(n.delimiters))instanceof Array&&(n[t]=i)}),"autoComplete"in t&&!l(t.autoComplete)&&(n.autoComplete=h.autoComplete,n.autoComplete.enabled=t.autoComplete),"mix"==n.mode&&(n.autoComplete.rightKey=!0,n.delimiters=t.delimiters||null,n.tagTextProp&&!n.dropdown.searchKeys.includes(n.tagTextProp)&&n.dropdown.searchKeys.push(n.tagTextProp)),e.pattern)try{n.pattern=new RegExp(e.pattern)}catch(e){}if(this.settings.delimiters)try{n.delimiters=new RegExp(this.settings.delimiters,"g")}catch(e){}this.TEXTS=i(i({},m),n.texts||{}),"select"==n.mode&&(n.dropdown.enabled=0),n.dropdown.appendTarget=t.dropdown&&t.dropdown.appendTarget?t.dropdown.appendTarget:document.body},getAttributes(e){var t,i=this.getCustomAttributes(e),n="";for(t in i)n+=" "+t+(void 0!==e[t]?`="${i[t]}"`:"");return n},getCustomAttributes(e){if(!l(e))return"";var t,i={};for(t in e)"__"!=t.slice(0,2)&&"class"!=t&&e.hasOwnProperty(t)&&void 0!==e[t]&&(i[t]=r(e[t]));return i},setStateSelection(){var e=window.getSelection(),t={anchorOffset:e.anchorOffset,anchorNode:e.anchorNode,range:e.getRangeAt&&e.rangeCount&&e.getRangeAt(0)};return this.state.selection=t,t},getCaretGlobalPosition(){const e=document.getSelection();if(e.rangeCount){const t=e.getRangeAt(0),i=t.startContainer,n=t.startOffset;let s,a;if(n>0)return a=document.createRange(),a.setStart(i,n-1),a.setEnd(i,n),s=a.getBoundingClientRect(),{left:s.right,top:s.top,bottom:s.bottom};if(i.getBoundingClientRect)return i.getBoundingClientRect()}return{left:-9999,top:-9999}},getCSSVars(){var e,t=getComputedStyle(this.DOM.scope,null);this.CSSVars={tagHideTransition:(({value:e,unit:t})=>"s"==t?1e3*e:e)(function(e){if(!e)return{};var t=(e=e.trim().split(" ")[0]).split(/\d+/g).filter(e=>e).pop().trim();return{value:+e.split(t).filter(e=>e)[0].trim(),unit:t}}((e="tag-hide-transition",t.getPropertyValue("--"+e))))}},build(e){var t=this.DOM;this.settings.mixMode.integrated?(t.originalInput=null,t.scope=e,t.input=e):(t.originalInput=e,t.scope=this.parseTemplate("wrapper",[e,this.settings]),t.input=t.scope.querySelector(this.settings.classNames.inputSelector),e.parentNode.insertBefore(t.scope,e))},destroy(){this.events.unbindGlobal.call(this),this.DOM.scope.parentNode.removeChild(this.DOM.scope),this.dropdown.hide(!0),clearTimeout(this.dropdownHide__bindEventsTimeout)},loadOriginalValues(e){var t,i=this.settings;if(void 0===e&&(e=i.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value),this.removeAllTags({withoutChangeEvent:!0}),e)if("mix"==i.mode)this.parseMixTags(e.trim()),(t=this.DOM.input.lastChild)&&"BR"==t.tagName||this.DOM.input.insertAdjacentHTML("beforeend","<br>");else{try{JSON.parse(e)instanceof Array&&(e=JSON.parse(e))}catch(e){}this.addTags(e).forEach(e=>e&&e.classList.add(i.classNames.tagNoAnimation))}else this.postUpdate();this.state.lastOriginalValueReported=i.mixMode.integrated?"":this.DOM.originalInput.value,this.state.loadedOriginalValues=!0},cloneEvent(e){var t={};for(var i in e)t[i]=e[i];return t},loading(e){return this.state.isLoading=e,this.DOM.scope.classList[e?"add":"remove"](this.settings.classNames.scopeLoading),this},tagLoading(e,t){return e&&e.classList[t?"add":"remove"](this.settings.classNames.tagLoading),this},toggleClass(e,t){"string"==typeof e&&this.DOM.scope.classList.toggle(e,t)},toggleFocusClass(e){this.toggleClass(this.settings.classNames.focus,!!e)},triggerChangeEvent:function(){if(!this.settings.mixMode.integrated){var e=this.DOM.originalInput,t=this.state.lastOriginalValueReported!==e.value,i=new CustomEvent("change",{bubbles:!0});t&&(this.state.lastOriginalValueReported=e.value,i.simulated=!0,e._valueTracker&&e._valueTracker.setValue(Math.random()),e.dispatchEvent(i),this.trigger("change",this.state.lastOriginalValueReported),e.value=this.state.lastOriginalValueReported)}},events:b,fixFirefoxLastTagNoCaret(){},placeCaretAfterNode(e){if(e&&e.parentNode){var t=e.nextSibling,i=window.getSelection(),n=i.getRangeAt(0);i.rangeCount&&(n.setStartBefore(t||e),n.setEndBefore(t||e),i.removeAllRanges(),i.addRange(n))}},insertAfterTag(e,t){if(t=t||this.settings.mixMode.insertAfterTag,e&&e.parentNode&&t)return t="string"==typeof t?document.createTextNode(t):t,e.parentNode.insertBefore(t,e.nextSibling),t},editTag(e,t){e=e||this.getLastTag(),t=t||{},this.dropdown.hide();var i=this.settings;function n(){return e.querySelector(i.classNames.tagTextSelector)}var s=n(),a=this.getNodeIndex(e),o=this.tagData(e),r=this.events.callbacks,l=this,d=!0;if(s){if(!(o instanceof Object&&"editable"in o)||o.editable)return s.setAttribute("contenteditable",!0),e.classList.add(i.classNames.tagEditing),this.tagData(e,{__originalData:c({},o),__originalHTML:e.innerHTML}),s.addEventListener("focus",r.onEditTagFocus.bind(this,e)),s.addEventListener("blur",(function(){setTimeout(()=>r.onEditTagBlur.call(l,n()))})),s.addEventListener("input",r.onEditTagInput.bind(this,s)),s.addEventListener("keydown",t=>r.onEditTagkeydown.call(this,t,e)),s.focus(),this.setRangeAtStartEnd(!1,s),t.skipValidation||(d=this.editTagToggleValidity(e)),s.originalIsValid=d,this.trigger("edit:start",{tag:e,index:a,data:o,isValid:d}),this}else console.warn("Cannot find element in Tag template: .",i.classNames.tagTextSelector)},editTagToggleValidity(e,t){var i;if(t=t||this.tagData(e))return(i=!("__isValid"in t)||!0===t.__isValid)||this.removeTagsFromValue(e),this.update(),e.classList.toggle(this.settings.classNames.tagNotAllowed,!i),t.__isValid;console.warn("tag has no data: ",e,t)},onEditTagDone(e,t){t=t||{};var i={tag:e=e||this.state.editing.scope,index:this.getNodeIndex(e),previousData:this.tagData(e),data:t};this.trigger("edit:beforeUpdate",i,{cloneData:!1}),this.state.editing=!1,delete t.__originalData,delete t.__originalHTML,e&&t[this.settings.tagTextProp]?(e=this.replaceTag(e,t),this.editTagToggleValidity(e,t),this.settings.a11y.focusableTags&&e.focus()):e&&this.removeTags(e),this.trigger("edit:updated",i),this.dropdown.hide(),this.settings.keepInvalidTags&&this.reCheckInvalidTags()},replaceTag(e,t){t&&t.value||(t=e.__tagifyTagData),t.__isValid&&1!=t.__isValid&&c(t,this.getInvalidTagAttrs(t,t.__isValid));var i=this.createTagElem(t);return e.parentNode.replaceChild(i,e),this.updateValueByDOMTags(),i},updateValueByDOMTags(){this.value.length=0,[].forEach.call(this.getTagElms(),e=>{e.classList.contains(this.settings.classNames.tagNotAllowed.split(" ")[0])||this.value.push(this.tagData(e))}),this.update()},setRangeAtStartEnd(e,t){e="number"==typeof e?e:!!e,t=(t=t||this.DOM.input).lastChild||t;var i=document.getSelection();try{i.rangeCount>=1&&["Start","End"].forEach(n=>i.getRangeAt(0)["set"+n](t,e||t.length))}catch(e){console.warn("Tagify: ",e)}},injectAtCaret(e,t){if(t=t||this.state.selection.range)return"string"==typeof e&&(e=document.createTextNode(e)),t.deleteContents(),t.insertNode(e),this.setRangeAtStartEnd(!1,e),this.updateValueByDOMTags(),this.update(),this},input:{set(e="",t=!0){var i=this.settings.dropdown.closeOnSelect;this.state.inputText=e,t&&(this.DOM.input.innerHTML=r(""+e)),!e&&i&&this.dropdown.hide.bind(this),this.input.autocomplete.suggest.call(this),this.input.validate.call(this)},validate(){var e=!this.state.inputText||!0===this.validateTag({value:this.state.inputText});return this.DOM.input.classList.toggle(this.settings.classNames.inputInvalid,!e),e},normalize(e){var t=e||this.DOM.input,i=[];t.childNodes.forEach(e=>3==e.nodeType&&i.push(e.nodeValue)),i=i.join("\n");try{i=i.replace(/(?:\r\n|\r|\n)/g,this.settings.delimiters.source.charAt(0))}catch(e){}return i=i.replace(/\s/g," "),this.settings.trim&&(i=i.replace(/^\s+/,"")),i},autocomplete:{suggest(e){if(this.settings.autoComplete.enabled){"string"==typeof(e=e||{})&&(e={value:e});var t=e.value?""+e.value:"",i=t.substr(0,this.state.inputText.length).toLowerCase(),n=t.substring(this.state.inputText.length);t&&this.state.inputText&&i==this.state.inputText.toLowerCase()?(this.DOM.input.setAttribute("data-suggest",n),this.state.inputSuggestion=e):(this.DOM.input.removeAttribute("data-suggest"),delete this.state.inputSuggestion)}},set(e){var t=this.DOM.input.getAttribute("data-suggest"),i=e||(t?this.state.inputText+t:null);return!!i&&("mix"==this.settings.mode?this.replaceTextWithNode(document.createTextNode(this.state.tag.prefix+i)):(this.input.set.call(this,i),this.setRangeAtStartEnd()),this.input.autocomplete.suggest.call(this),this.dropdown.hide(),!0)}}},getTagIdx(e){return this.value.findIndex(t=>t.__tagId==(e||{}).__tagId)},getNodeIndex(e){var t=0;if(e)for(;e=e.previousElementSibling;)t++;return t},getTagElms(...e){var t="."+[...this.settings.classNames.tag.split(" "),...e].join(".");return[].slice.call(this.DOM.scope.querySelectorAll(t))},getLastTag(){var e=this.DOM.scope.querySelectorAll(`${this.settings.classNames.tagSelector}:not(.${this.settings.classNames.tagHide}):not([readonly])`);return e[e.length-1]},tagData:(e,t,i)=>e?(t&&(e.__tagifyTagData=i?t:c({},e.__tagifyTagData||{},t)),e.__tagifyTagData):(console.warn("tag elment doesn't exist",e,t),t),isTagDuplicate(e,t){var i=this.settings;return"select"!=i.mode&&this.value.reduce((s,a)=>n(this.trim(""+e),a.value,t||i.dropdown.caseSensitive)?s+1:s,0)},getTagIndexByValue(e){var t=[];return this.getTagElms().forEach((i,s)=>{n(this.trim(i.textContent),e,this.settings.dropdown.caseSensitive)&&t.push(s)}),t},getTagElmByValue(e){var t=this.getTagIndexByValue(e)[0];return this.getTagElms()[t]},flashTag(e){e&&(e.classList.add(this.settings.classNames.tagFlash),setTimeout(()=>{e.classList.remove(this.settings.classNames.tagFlash)},100))},isTagBlacklisted(e){return e=this.trim(e.toLowerCase()),this.settings.blacklist.filter(t=>(""+t).toLowerCase()==e).length},isTagWhitelisted(e){return!!this.getWhitelistItem(e)},getWhitelistItem(e,t,i){t=t||"value";var s,a=this.settings;return(i=i||a.whitelist).some(i=>{var o="string"==typeof i?i:i[t]||i.value;if(n(o,e,a.dropdown.caseSensitive,a.trim))return s="string"==typeof i?{value:i}:i,!0}),s||"value"!=t||"value"==a.tagTextProp||(s=this.getWhitelistItem(e,a.tagTextProp,i)),s},validateTag(e){var t=this.settings,i="value"in e?"value":t.tagTextProp,n=this.trim(e[i]+"");return(e[i]+"").trim()?t.pattern&&t.pattern instanceof RegExp&&!t.pattern.test(n)?this.TEXTS.pattern:!t.duplicates&&this.isTagDuplicate(n,this.state.editing)?this.TEXTS.duplicate:this.isTagBlacklisted(n)||t.enforceWhitelist&&!this.isTagWhitelisted(n)?this.TEXTS.notAllowed:!t.validate||t.validate(e):this.TEXTS.empty},getInvalidTagAttrs(e,t){return{"aria-invalid":!0,class:`${e.class||""} ${this.settings.classNames.tagNotAllowed}`.trim(),title:t}},hasMaxTags(){return this.value.length>=this.settings.maxTags&&this.TEXTS.exceed},setReadonly(e,t){var i=this.settings;document.activeElement.blur(),i[t||"readonly"]=e,this.DOM.scope[(e?"set":"remove")+"Attribute"](t||"readonly",!0),"mix"==i.mode&&(this.DOM.input.contentEditable=!e)},setDisabled(e){this.setReadonly(e,"disabled")},normalizeTags(e){var t=this.settings,i=t.whitelist,n=t.delimiters,s=t.mode,a=t.tagTextProp;t.enforceWhitelist;var o=[],r=!!i&&i[0]instanceof Object,l=e instanceof Array,c=e=>(e+"").split(n).filter(e=>e).map(e=>({[a]:this.trim(e),value:this.trim(e)}));if("number"==typeof e&&(e=e.toString()),"string"==typeof e){if(!e.trim())return[];e=c(e)}else l&&(e=[].concat(...e.map(e=>e.value?e:c(e))));return r&&(e.forEach(e=>{var t=o.map(e=>e.value),i=this.dropdown.filterListItems.call(this,e[a],{exact:!0}).filter(e=>!t.includes(e.value)),n=i.length>1?this.getWhitelistItem(e[a],a,i):i[0];n&&n instanceof Object?o.push(n):"mix"!=s&&(null==e.value&&(e.value=e[a]),o.push(e))}),e=o),e},parseMixTags(e){var t=this.settings,i=t.mixTagsInterpolator,n=t.duplicates,s=t.transformTag,a=t.enforceWhitelist,o=t.maxTags,r=t.tagTextProp,l=[];return e=e.split(i[0]).map((e,t)=>{var c,d,u,h=e.split(i[1]),p=h[0],g=l.length==o;try{if(p==+p)throw Error;d=JSON.parse(p)}catch(e){d=this.normalizeTags(p)[0]||{value:p}}if(g||!(h.length>1)||a&&!this.isTagWhitelisted(d.value)||!n&&this.isTagDuplicate(d.value)){if(e)return t?i[0]+e:e}else s.call(this,d),d[c=d[r]?r:"value"]=this.trim(d[c]),u=this.createTagElem(d),l.push(d),u.classList.add(this.settings.classNames.tagNoAnimation),h[0]=u.outerHTML,this.value.push(d);return h.join("")}).join(""),this.DOM.input.innerHTML=e,this.DOM.input.appendChild(document.createTextNode("")),this.DOM.input.normalize(),this.getTagElms().forEach((e,t)=>this.tagData(e,l[t])),this.update({withoutChangeEvent:!0}),e},replaceTextWithNode(e,t){if(this.state.tag||t){t=t||this.state.tag.prefix+this.state.tag.value;var i,n,s=window.getSelection(),a=s.anchorNode,o=this.state.tag.delimiters?this.state.tag.delimiters.length:0;return a.splitText(s.anchorOffset-o),i=a.nodeValue.lastIndexOf(t),n=a.splitText(i),e&&a.parentNode.replaceChild(e,n),!0}},selectTag(e,t){if(!this.settings.enforceWhitelist||this.isTagWhitelisted(t.value)){this.input.set.call(this,t[this.settings.tagTextProp||"value"],!0),this.state.actions.selectOption&&setTimeout(this.setRangeAtStartEnd.bind(this));var i=this.getLastTag();return i?this.replaceTag(i,t):this.appendTag(e),this.value[0]=t,this.trigger("add",{tag:e,data:t}),this.update(),[e]}},addEmptyTag(e){var t=c({value:""},e||{}),i=this.createTagElem(t);this.tagData(i,t),this.appendTag(i),this.editTag(i,{skipValidation:!0})},addTags(e,t,i=this.settings.skipInvalid){var n=[],s=this.settings,a=document.createDocumentFragment();return e&&0!=e.length?(e=this.normalizeTags(e),"mix"==s.mode?this.addMixTags(e):("select"==s.mode&&(t=!1),this.DOM.input.removeAttribute("style"),e.forEach(e=>{var t,o={},r=Object.assign({},e,{value:e.value+""});if((e=Object.assign({},r)).__isValid=this.hasMaxTags()||this.validateTag(e),s.transformTag.call(this,e),!0!==e.__isValid){if(i)return;c(o,this.getInvalidTagAttrs(e,e.__isValid),{__preInvalidData:r}),e.__isValid==this.TEXTS.duplicate&&this.flashTag(this.getTagElmByValue(e.value))}if(e.readonly&&(o["aria-readonly"]=!0),t=this.createTagElem(e,o),n.push(t),"select"==s.mode)return this.selectTag(t,e);a.appendChild(t),e.__isValid&&!0===e.__isValid?(this.value.push(e),this.trigger("add",{tag:t,index:this.value.length-1,data:e})):(this.trigger("invalid",{data:e,index:this.value.length,tag:t,message:e.__isValid}),s.keepInvalidTags||setTimeout(()=>this.removeTags(t,!0),1e3)),this.dropdown.position()}),this.appendTag(a),this.update(),e.length&&t&&this.input.set.call(this),this.dropdown.refilter(),n)):("select"==s.mode&&this.removeAllTags(),n)},addMixTags(e){if(e[0].prefix||this.state.tag)return this.prefixedTextToTag(e[0]);"string"==typeof e&&(e=[{value:e}]);var t=!!this.state.selection,i=document.createDocumentFragment();return e.forEach(e=>{var t=this.createTagElem(e);i.appendChild(t),this.insertAfterTag(t)}),t?this.injectAtCaret(i):(this.DOM.input.focus(),(t=this.setStateSelection()).range.setStart(this.DOM.input,t.range.endOffset),t.range.setEnd(this.DOM.input,t.range.endOffset),this.DOM.input.appendChild(i),this.updateValueByDOMTags(),this.update()),i},prefixedTextToTag(e){var t,i=this.settings,n=this.state.tag.delimiters;if(i.transformTag.call(this,e),e.prefix=e.prefix||this.state.tag?this.state.tag.prefix:(i.pattern.source||i.pattern)[0],t=this.createTagElem(e),this.replaceTextWithNode(t)||this.DOM.input.appendChild(t),setTimeout(()=>t.classList.add(this.settings.classNames.tagNoAnimation),300),this.value.push(e),this.update(),!n){var s=this.insertAfterTag(t)||t;this.placeCaretAfterNode(s)}return this.state.tag=null,this.trigger("add",c({},{tag:t},{data:e})),t},appendTag(e){var t=this.DOM,i=t.scope.lastElementChild;i===t.input?t.scope.insertBefore(e,i):t.scope.appendChild(e)},createTagElem(e,t){e.__tagId=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16));var n,s=c({},e,i({value:r(e.value+"")},t));return function(e){for(var t,i=document.createNodeIterator(e,NodeFilter.SHOW_TEXT,null,!1);t=i.nextNode();)t.textContent.trim()||t.parentNode.removeChild(t)}(n=this.parseTemplate("tag",[s])),this.tagData(n,e),n},reCheckInvalidTags(){var e=this.settings;this.getTagElms(e.classNames.tagNotAllowed).forEach((e,t)=>{var i=this.tagData(e),n=this.hasMaxTags(),s=this.validateTag(i);if(!0===s&&!n)return i=i.__preInvalidData?i.__preInvalidData:{value:i.value},this.replaceTag(e,i);e.title=n||s})},removeTags(e,t,i){var n;e=e&&e instanceof HTMLElement?[e]:e instanceof Array?e:e?[e]:[this.getLastTag()],n=e.reduce((e,t)=>(t&&"string"==typeof t&&(t=this.getTagElmByValue(t)),t&&this.tagData(t)&&e.push({node:t,idx:this.getTagIdx(this.tagData(t)),data:this.tagData(t,{__removed:!0})}),e),[]),i="number"==typeof i?i:this.CSSVars.tagHideTransition,"select"==this.settings.mode&&(i=0,this.input.set.call(this)),1==n.length&&n[0].node.classList.contains(this.settings.classNames.tagNotAllowed)&&(t=!0),n.length&&this.settings.hooks.beforeRemoveTag(n,{tagify:this}).then(()=>{function e(e){e.node.parentNode&&(e.node.parentNode.removeChild(e.node),t?this.settings.keepInvalidTags&&this.trigger("remove",{tag:e.node,index:e.idx}):(this.trigger("remove",{tag:e.node,index:e.idx,data:e.data}),this.dropdown.refilter(),this.dropdown.position(),this.DOM.input.normalize(),this.settings.keepInvalidTags&&this.reCheckInvalidTags()))}i&&i>10&&1==n.length?function(t){t.node.style.width=parseFloat(window.getComputedStyle(t.node).width)+"px",document.body.clientTop,t.node.classList.add(this.settings.classNames.tagHide),setTimeout(e.bind(this),i,t)}.call(this,n[0]):n.forEach(e.bind(this)),t||(this.removeTagsFromValue(n.map(e=>e.node)),this.update())}).catch(e=>{})},removeTagsFromDOM(){[].slice.call(this.getTagElms()).forEach(e=>e.parentNode.removeChild(e))},removeTagsFromValue(e){(e=Array.isArray(e)?e:[e]).forEach(e=>{var t=this.tagData(e),i=this.getTagIdx(t);i>-1&&this.value.splice(i,1)})},removeAllTags(e){e=e||{},this.value=[],"mix"==this.settings.mode?this.DOM.input.innerHTML="":this.removeTagsFromDOM(),this.dropdown.position(),"select"==this.settings.mode&&this.input.set.call(this),this.update(e)},postUpdate(){var e=this.settings.classNames,t="mix"==this.settings.mode?this.settings.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value:this.value.length;this.toggleClass(e.hasMaxTags,this.value.length>=this.settings.maxTags),this.toggleClass(e.hasNoTags,!this.value.length),this.toggleClass(e.empty,!t)},update(e){var t=this.DOM.originalInput;this.settings.mixMode.integrated||(t.value=this.getInputValue()),this.postUpdate(),!(e||{}).withoutChangeEvent&&this.state.loadedOriginalValues&&this.triggerChangeEvent()},getInputValue(){var e=this.getCleanValue();return"mix"==this.settings.mode?this.getMixedTagsAsString(e):e.length?this.settings.originalInputValueFormat?this.settings.originalInputValueFormat(e):JSON.stringify(e):""},getCleanValue(e){return t=e||this.value,i=this.dataProps,t&&Array.isArray(t)&&t.map(e=>s(e,i));var t,i},getMixedTagsAsString(){var e="",t=this,i=this.settings.mixTagsInterpolator;return function n(a){a.childNodes.forEach(a=>{if(1==a.nodeType){const o=t.tagData(a);if(a.classList.contains(t.settings.classNames.tag)&&o){if(o.__removed)return;return void(e+=i[0]+JSON.stringify(s(o,t.dataProps))+i[1])}"BR"!=a.tagName||a.parentNode!=t.DOM.input&&1!=a.parentNode.childNodes.length?"DIV"!=a.tagName&&"P"!=a.tagName||(e+="\r\n",n(a)):e+="\r\n"}else e+=a.textContent})}(this.DOM.input),e}},y.prototype.removeTag=y.prototype.removeTags,y}))},eb6e:function(e,t,i){"use strict";i("8872")},fe26:function(e,t,i){}}]);
//# sourceMappingURL=chunk-00aea5ac.14ac8ccb.js.map