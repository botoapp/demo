(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f1b311b0"],{"05d4":function(t,e,i){"use strict";i("b9cd")},"10d0":function(t,e,i){},2209:function(t,e,i){},"3b5b":function(t,e,i){"use strict";i("5508")},"3db7":function(t,e,i){},"41e3":function(t,e,i){"use strict";i("2209")},"545e":function(t,e,i){"use strict";i("10d0")},5508:function(t,e,i){},6391:function(t,e,i){"use strict";i("93a9")},"6e05":function(t,e,i){"use strict";i("8ff7")},"6f2f":function(t,e,i){},"8ff7":function(t,e,i){},"93a9":function(t,e,i){},b9cd:function(t,e,i){},d26e:function(t,e,i){!function(e,i){t.exports=i()}(0,(function(){"use strict";function t(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function e(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function i(i){for(var n=1;n<arguments.length;n++){var s=null!=arguments[n]?arguments[n]:{};n%2?e(Object(s),!0).forEach((function(e){t(i,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(s)):e(Object(s)).forEach((function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(s,t))}))}return i}const n=(t,e,i,n)=>(t=""+t,e=""+e,n&&(t=t.trim(),e=e.trim()),i?t==e:t.toLowerCase()==e.toLowerCase());function s(t,e){var i,n={};for(i in t)e.indexOf(i)<0&&(n[i]=t[i]);return n}function o(t){var e=document.createElement("div");return t.replace(/\&#?[0-9a-z]+;/gi,(function(t){return e.innerHTML=t,e.innerText}))}function a(t,e){for(e=e||"previous";t=t[e+"Sibling"];)if(3==t.nodeType)return t}function r(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/`|'/g,"&#039;"):t}function l(t){var e=Object.prototype.toString.call(t).split(" ")[1].slice(0,-1);return t===Object(t)&&"Array"!=e&&"Function"!=e&&"RegExp"!=e&&"HTMLUnknownElement"!=e}function c(t,e,i){function n(t,e){for(var i in e)if(e.hasOwnProperty(i)){if(l(e[i])){l(t[i])?n(t[i],e[i]):t[i]=Object.assign({},e[i]);continue}if(Array.isArray(e[i])){t[i]=Object.assign([],e[i]);continue}t[i]=e[i]}}return t instanceof Object||(t={}),n(t,e),i&&n(t,i),t}function d(t){return String.prototype.normalize?"string"==typeof t?t.normalize("NFD").replace(/[\u0300-\u036f]/g,""):void 0:t}var u=()=>/(?=.*chrome)(?=.*android)/i.test(navigator.userAgent),h={delimiters:",",pattern:null,tagTextProp:"value",maxTags:1/0,callbacks:{},addTagOnBlur:!0,duplicates:!1,whitelist:[],blacklist:[],enforceWhitelist:!1,keepInvalidTags:!1,mixTagsAllowedAfter:/,|\.|\:|\s/,mixTagsInterpolator:["[[","]]"],backspace:!0,skipInvalid:!1,pasteAsTags:!0,editTags:{clicks:2,keepInvalid:!0},transformTag:()=>{},trim:!0,a11y:{focusableTags:!1},mixMode:{insertAfterTag:"Â "},autoComplete:{enabled:!0,rightKey:!1},classNames:{namespace:"tagify",mixMode:"tagify--mix",selectMode:"tagify--select",input:"tagify__input",focus:"tagify--focus",tag:"tagify__tag",tagNoAnimation:"tagify--noAnim",tagInvalid:"tagify--invalid",tagNotAllowed:"tagify--notAllowed",inputInvalid:"tagify__input--invalid",tagX:"tagify__tag__removeBtn",tagText:"tagify__tag-text",dropdown:"tagify__dropdown",dropdownWrapper:"tagify__dropdown__wrapper",dropdownItem:"tagify__dropdown__item",dropdownItemActive:"tagify__dropdown__item--active",dropdownInital:"tagify__dropdown--initial",scopeLoading:"tagify--loading",tagLoading:"tagify__tag--loading",tagEditing:"tagify__tag--editable",tagFlash:"tagify__tag--flash",tagHide:"tagify__tag--hide",hasMaxTags:"tagify--hasMaxTags",hasNoTags:"tagify--noTags",empty:"tagify--empty"},dropdown:{classname:"",enabled:2,maxItems:10,searchKeys:["value","searchBy"],fuzzySearch:!0,caseSensitive:!1,accentedSearch:!0,highlightFirst:!1,closeOnSelect:!0,clearOnSelect:!0,position:"all",appendTarget:null},hooks:{beforeRemoveTag:()=>Promise.resolve(),beforePaste:()=>Promise.resolve(),suggestionClick:()=>Promise.resolve()}};function p(){this.dropdown={};for(let t in this._dropdown)this.dropdown[t]="function"==typeof this._dropdown[t]?this._dropdown[t].bind(this):this._dropdown[t];this.settings.dropdown.enabled>=0&&this.dropdown.init()}var g,f={init(){this.DOM.dropdown=this.parseTemplate("dropdown",[this.settings]),this.DOM.dropdown.content=this.DOM.dropdown.querySelector(this.settings.classNames.dropdownWrapperSelector)},show(t){var e,i,s,o=this.settings,a="mix"==o.mode&&!o.enforceWhitelist,r=!o.whitelist||!o.whitelist.length,c="manual"==o.dropdown.position;if(t=void 0===t?this.state.inputText:t,(!r||a||o.templates.dropdownItemNoMatch)&&!1!==o.dropdown.enable&&!this.state.isLoading){if(clearTimeout(this.dropdownHide__bindEventsTimeout),this.suggestedListItems=this.dropdown.filterListItems(t),t&&!this.suggestedListItems.length&&(this.trigger("dropdown:noMatch",t),o.templates.dropdownItemNoMatch&&(s=o.templates.dropdownItemNoMatch.call(this,{value:t}))),!s){if(this.suggestedListItems.length)t&&a&&!this.state.editing.scope&&!n(this.suggestedListItems[0].value,t)&&this.suggestedListItems.unshift({value:t});else{if(!t||!a||this.state.editing.scope)return this.input.autocomplete.suggest.call(this),void this.dropdown.hide();this.suggestedListItems=[{value:t}]}i=""+(l(e=this.suggestedListItems[0])?e.value:e),o.autoComplete&&i&&0==i.indexOf(t)&&this.input.autocomplete.suggest.call(this,e)}this.dropdown.fill(s),o.dropdown.highlightFirst&&this.dropdown.highlightOption(this.DOM.dropdown.content.children[0]),this.state.dropdown.visible||setTimeout(this.dropdown.events.binding.bind(this)),this.state.dropdown.visible=t||!0,this.state.dropdown.query=t,this.setStateSelection(),c||setTimeout(()=>{this.dropdown.position(),this.dropdown.render()}),setTimeout(()=>{this.trigger("dropdown:show",this.DOM.dropdown)})}},hide(t){var e=this.DOM,i=e.scope,n=e.dropdown,s="manual"==this.settings.dropdown.position&&!t;if(n&&document.body.contains(n)&&!s)return window.removeEventListener("resize",this.dropdown.position),this.dropdown.events.binding.call(this,!1),i.setAttribute("aria-expanded",!1),n.parentNode.removeChild(n),setTimeout(()=>{this.state.dropdown.visible=!1},100),this.state.dropdown.query=this.state.ddItemData=this.state.ddItemElm=this.state.selection=null,this.state.tag&&this.state.tag.value.length&&(this.state.flaggedTags[this.state.tag.baseOffset]=this.state.tag),this.trigger("dropdown:hide",n),this},render(){var t,e,i,n=(t=this.DOM.dropdown,(i=t.cloneNode(!0)).style.cssText="position:fixed; top:-9999px; opacity:0",document.body.appendChild(i),e=i.clientHeight,i.parentNode.removeChild(i),e),s=this.settings;return this.DOM.scope.setAttribute("aria-expanded",!0),document.body.contains(this.DOM.dropdown)||(this.DOM.dropdown.classList.add(s.classNames.dropdownInital),this.dropdown.position(n),s.dropdown.appendTarget.appendChild(this.DOM.dropdown),setTimeout(()=>this.DOM.dropdown.classList.remove(s.classNames.dropdownInital))),this},fill(t){var e;t="string"==typeof t?t:this.dropdown.createListHTML(t||this.suggestedListItems),this.DOM.dropdown.content.innerHTML=(e=t)?e.replace(/\>[\r\n ]+\</g,"><").replace(/(<.*?>)|\s+/g,(t,e)=>e||" "):""},refilter(t){t=t||this.state.dropdown.query||"",this.suggestedListItems=this.dropdown.filterListItems(t),this.dropdown.fill(),this.suggestedListItems.length||this.dropdown.hide(),this.trigger("dropdown:updated",this.DOM.dropdown)},position(t){var e=this.settings.dropdown;if("manual"!=e.position){var i,n,s,o,a,r,l=this.DOM.dropdown,c=e.placeAbove,d=document.documentElement.clientHeight,u=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)>480?e.position:"all",h=this.DOM["input"==u?"input":"scope"];t=t||l.clientHeight,this.state.dropdown.visible&&("text"==u?(s=(i=this.getCaretGlobalPosition()).bottom,n=i.top,o=i.left,a="auto"):(r=function(t){for(var e=0,i=0;t;)e+=t.offsetLeft||0,i+=t.offsetTop||0,t=t.parentNode;return{left:e,top:i}}(this.settings.dropdown.appendTarget),n=(i=h.getBoundingClientRect()).top-r.top,s=i.bottom-1-r.top,o=i.left-r.left,a=i.width+"px"),n=Math.floor(n),s=Math.ceil(s),c=void 0===c?d-i.bottom<t:c,l.style.cssText="left:"+(o+window.pageXOffset)+"px; width:"+a+";"+(c?"top: "+(n+window.pageYOffset)+"px":"top: "+(s+window.pageYOffset)+"px"),l.setAttribute("placement",c?"top":"bottom"),l.setAttribute("position",u))}},events:{binding(t=!0){var e=this.dropdown.events.callbacks,i=this.listeners.dropdown=this.listeners.dropdown||{position:this.dropdown.position.bind(this),onKeyDown:e.onKeyDown.bind(this),onMouseOver:e.onMouseOver.bind(this),onMouseLeave:e.onMouseLeave.bind(this),onClick:e.onClick.bind(this),onScroll:e.onScroll.bind(this)},n=t?"addEventListener":"removeEventListener";"manual"!=this.settings.dropdown.position&&(window[n]("resize",i.position),window[n]("keydown",i.onKeyDown)),this.DOM.dropdown[n]("mouseover",i.onMouseOver),this.DOM.dropdown[n]("mouseleave",i.onMouseLeave),this.DOM.dropdown[n]("mousedown",i.onClick),this.DOM.dropdown.content[n]("scroll",i.onScroll)},callbacks:{onKeyDown(t){var e=this.DOM.dropdown.querySelector(this.settings.classNames.dropdownItemActiveSelector),i=this.dropdown.getSuggestionDataByNode(e);switch(t.key){case"ArrowDown":case"ArrowUp":case"Down":case"Up":var n;t.preventDefault(),e&&(e=e[("ArrowUp"==t.key||"Up"==t.key?"previous":"next")+"ElementSibling"]),e||(n=this.DOM.dropdown.content.children,e=n["ArrowUp"==t.key||"Up"==t.key?n.length-1:0]),i=this.dropdown.getSuggestionDataByNode(e),this.dropdown.highlightOption(e,!0);break;case"Escape":case"Esc":this.dropdown.hide();break;case"ArrowRight":if(this.state.actions.ArrowLeft)return;case"Tab":if("mix"!=this.settings.mode&&e&&!this.settings.autoComplete.rightKey&&!this.state.editing){t.preventDefault();var s=this.dropdown.getMappedValue(i);return this.input.autocomplete.set.call(this,s),!1}return!0;case"Enter":t.preventDefault(),this.settings.hooks.suggestionClick(t,{tagify:this,tagData:i,suggestionElm:e}).then(()=>{if(e)return this.dropdown.selectOption(e);this.dropdown.hide(),"mix"!=this.settings.mode&&this.addTags(this.state.inputText.trim(),!0)}).catch(t=>t);break;case"Backspace":{if("mix"==this.settings.mode||this.state.editing.scope)return;let t=this.state.inputText.trim();""!=t&&8203!=t.charCodeAt(0)||(!0===this.settings.backspace?this.removeTags():"edit"==this.settings.backspace&&setTimeout(this.editTag.bind(this),0))}}},onMouseOver(t){var e=t.target.closest(this.settings.classNames.dropdownItemSelector);e&&this.dropdown.highlightOption(e)},onMouseLeave(t){this.dropdown.highlightOption()},onClick(t){if(0==t.button&&t.target!=this.DOM.dropdown&&t.target!=this.DOM.dropdown.content){var e=t.target.closest(this.settings.classNames.dropdownItemSelector),i=this.dropdown.getSuggestionDataByNode(e);this.state.actions.selectOption=!0,setTimeout(()=>this.state.actions.selectOption=!1,50),this.settings.hooks.suggestionClick(t,{tagify:this,tagData:i,suggestionElm:e}).then(()=>{e?this.dropdown.selectOption(e):this.dropdown.hide()}).catch(t=>t)}},onScroll(t){var e=t.target,i=e.scrollTop/(e.scrollHeight-e.parentNode.clientHeight)*100;this.trigger("dropdown:scroll",{percentage:Math.round(i)})}}},getSuggestionDataByNode(t){var e=t?+t.getAttribute("tagifySuggestionIdx"):-1;return this.suggestedListItems[e]||null},highlightOption(t,e){var i,n=this.settings.classNames.dropdownItemActive;if(this.state.ddItemElm&&(this.state.ddItemElm.classList.remove(n),this.state.ddItemElm.removeAttribute("aria-selected")),!t)return this.state.ddItemData=null,this.state.ddItemElm=null,void this.input.autocomplete.suggest.call(this);i=this.suggestedListItems[this.getNodeIndex(t)],this.state.ddItemData=i,this.state.ddItemElm=t,t.classList.add(n),t.setAttribute("aria-selected",!0),e&&(t.parentNode.scrollTop=t.clientHeight+t.offsetTop-t.parentNode.clientHeight),this.settings.autoComplete&&(this.input.autocomplete.suggest.call(this,i),this.dropdown.position())},selectOption(t){var e,i=this.settings.dropdown,n=i.clearOnSelect,s=i.closeOnSelect;if(!t)return e=this.addTags(this.state.inputText,!0),void(s&&this.dropdown.hide());var o=t.getAttribute("tagifySuggestionIdx"),a=this.suggestedListItems[+o];this.trigger("dropdown:select",{data:a,elm:t}),o&&a?(this.state.editing?this.onEditTagDone(null,c({__isValid:!0},a)):e=this["mix"==this.settings.mode?"addMixTags":"addTags"]([a],n),this.DOM.input.parentNode&&(setTimeout(()=>{this.DOM.input.focus(),this.toggleFocusClass(!0),this.placeCaretAfterNode(e)}),s?setTimeout(this.dropdown.hide.bind(this)):this.dropdown.refilter())):this.dropdown.hide()},selectAll(){return this.suggestedListItems.length=0,this.dropdown.hide(),this.addTags(this.dropdown.filterListItems(""),!0),this},filterListItems(t,e){var i,n,s,o,a,r=this.settings,c=r.dropdown,u=(e=e||{},t="select"==r.mode&&this.value.length&&this.value[0][r.tagTextProp]==t?"":t,[]),h=r.whitelist,p=c.maxItems||1/0,g=c.searchKeys,f=0;if(!t||!g.length)return(r.duplicates?h:h.filter(t=>!this.isTagDuplicate(l(t)?t.value:t))).slice(0,p);function m(t,e){return e.toLowerCase().split(" ").every(e=>t.includes(e.toLowerCase()))}for(a=c.caseSensitive?""+t:(""+t).toLowerCase();f<h.length;f++){i=h[f]instanceof Object?h[f]:{value:h[f]};let t=Object.keys(i).some(t=>g.includes(t))?g:["value"];if(c.fuzzySearch&&!e.exact?(s=t.reduce((t,e)=>t+" "+(i[e]||""),"").toLowerCase(),c.accentedSearch&&(s=d(s),a=d(a)),n=m(s,a)):n=t.some(t=>{var n=""+(i[t]||"");return c.accentedSearch&&(n=d(n),a=d(a)),c.caseSensitive||(n=n.toLowerCase()),e.exact?n==a:0==n.indexOf(a)}),o=!r.duplicates&&this.isTagDuplicate(l(i)?i.value:i),n&&!o&&p--&&u.push(i),0==p)break}return u},getMappedValue(t){var e=this.settings.dropdown.mapValueTo;return e?"function"==typeof e?e(t):t[e]||t.value:t.value},createListHTML(t){return c([],t).map((t,e)=>{"string"!=typeof t&&"number"!=typeof t||(t={value:t});var i=this.dropdown.getMappedValue(t);t.value=i&&"string"==typeof i?r(i):i;var n=this.settings.templates.dropdownItem.apply(this,[t,this]);return n.replace(/\s*tagifySuggestionIdx=(["'])(.*?)\1/gim,"").replace(">",` tagifySuggestionIdx="${e}">`)}).join("")}},m={empty:"empty",exceed:"number of tags exceeded",pattern:"pattern mismatch",duplicate:"already exists",notAllowed:"not allowed"},v={wrapper:(t,e)=>`<tags class="${e.classNames.namespace} ${e.mode?""+e.classNames[e.mode+"Mode"]:""} ${t.className}"\n                    ${e.readonly?"readonly":""}\n                    ${e.disabled?"disabled":""}\n                    ${e.required?"required":""}\n                    tabIndex="-1">\n            <span ${e.readonly&&"mix"==e.mode?"":"contenteditable"} data-placeholder="${e.placeholder||"&#8203;"}" aria-placeholder="${e.placeholder||""}"\n                class="${e.classNames.input}"\n                role="textbox"\n                aria-autocomplete="both"\n                aria-multiline="${"mix"==e.mode}"></span>\n        </tags>`,tag(t,e){var i=this.settings;return`<tag title="${t.title||t.value}"\n                    contenteditable='false'\n                    spellcheck='false'\n                    tabIndex="${i.a11y.focusableTags?0:-1}"\n                    class="${i.classNames.tag} ${t.class||""}"\n                    ${this.getAttributes(t)}>\n            <x title='' class="${i.classNames.tagX}" role='button' aria-label='remove tag'></x>\n            <div>\n                <span class="${i.classNames.tagText}">${t[i.tagTextProp]||t.value}</span>\n            </div>\n        </tag>`},dropdown(t){var e=t.dropdown,i="manual"==e.position,n=""+t.classNames.dropdown;return`<div class="${i?"":n} ${e.classname}" role="listbox" aria-labelledby="dropdown">\n                    <div class="${t.classNames.dropdownWrapper}"></div>\n                </div>`},dropdownItem(t,e){return`<div ${this.getAttributes(t)}\n                    class='${this.settings.classNames.dropdownItem} ${t.class?t.class:""}'\n                    tabindex="0"\n                    role="option">${t.value}</div>`},dropdownItemNoMatch:null},b={customBinding(){this.customEventsList.forEach(t=>{this.on(t,this.settings.callbacks[t])})},binding(t=!0){var e,i=this.events.callbacks,n=t?"addEventListener":"removeEventListener";if(!this.state.mainEvents||!t)for(var s in this.state.mainEvents=t,t&&!this.listeners.main&&(this.events.bindGlobal.call(this),this.settings.isJQueryPlugin&&jQuery(this.DOM.originalInput).on("tagify.removeAllTags",this.removeAllTags.bind(this))),e=this.listeners.main=this.listeners.main||{focus:["input",i.onFocusBlur.bind(this)],keydown:["input",i.onKeydown.bind(this)],click:["scope",i.onClickScope.bind(this)],dblclick:["scope",i.onDoubleClickScope.bind(this)],paste:["input",i.onPaste.bind(this)]})this.DOM[e[s][0]][n](s,e[s][1])},bindGlobal(t){var e,i=this.events.callbacks,n=t?"removeEventListener":"addEventListener";if(t||!this.listeners.global)for(e of(this.listeners.global=this.listeners&&this.listeners.global||[{type:this.isIE?"keydown":"input",target:this.DOM.input,cb:i[this.isIE?"onInputIE":"onInput"].bind(this)},{type:"keydown",target:window,cb:i.onWindowKeyDown.bind(this)},{type:"blur",target:this.DOM.input,cb:i.onFocusBlur.bind(this)}],this.listeners.global))e.target[n](e.type,e.cb)},unbindGlobal(){this.events.bindGlobal.call(this,!0)},callbacks:{onFocusBlur(t){var e=t.target?this.trim(t.target.textContent):"",i=this.settings,n=t.type,s=i.dropdown.enabled>=0,o={relatedTarget:t.relatedTarget},a=this.state.actions.selectOption&&(s||!i.dropdown.closeOnSelect),r=this.state.actions.addNew&&s,l=t.relatedTarget&&t.relatedTarget.classList.contains(i.classNames.tag)&&this.DOM.scope.contains(t.relatedTarget);if("blur"==n){if(t.relatedTarget===this.DOM.scope)return this.dropdown.hide(),void this.DOM.input.focus();this.postUpdate(),this.triggerChangeEvent()}if(!a&&!r)if(this.state.hasFocus="focus"==n&&+new Date,this.toggleFocusClass(this.state.hasFocus),"mix"!=i.mode){if("focus"==n)return this.trigger("focus",o),void(0===i.dropdown.enabled&&this.dropdown.show());"blur"==n&&(this.trigger("blur",o),this.loading(!1),"select"==this.settings.mode&&l&&(e=""),("select"==this.settings.mode&&e?!this.value.length||this.value[0].value!=e:e&&!this.state.actions.selectOption&&i.addTagOnBlur)&&this.addTags(e,!0),"select"!=this.settings.mode||e||this.removeTags()),this.DOM.input.removeAttribute("style"),this.dropdown.hide()}else"focus"==n?this.trigger("focus",o):"blur"==t.type&&(this.trigger("blur",o),this.loading(!1),this.dropdown.hide(),this.state.dropdown.visible=void 0,this.setStateSelection())},onWindowKeyDown(t){var e,i=document.activeElement;if(i.classList.contains(this.settings.classNames.tag)&&this.DOM.scope.contains(document.activeElement))switch(e=i.nextElementSibling,t.key){case"Backspace":this.removeTags(i),(e||this.DOM.input).focus();break;case"Enter":setTimeout(this.editTag.bind(this),0,i)}},onKeydown(t){var e=this.trim(t.target.textContent);if(this.trigger("keydown",{originalEvent:this.cloneEvent(t)}),"mix"==this.settings.mode){switch(t.key){case"Left":case"ArrowLeft":this.state.actions.ArrowLeft=!0;break;case"Delete":case"Backspace":if(this.state.editing)return;var i,n,s,r=document.getSelection(),l="Delete"==t.key&&r.anchorOffset==(r.anchorNode.length||0),c=1==r.anchorNode.nodeType||!r.anchorOffset&&r.anchorNode.previousElementSibling,d=o(this.DOM.input.innerHTML),h=this.getTagElms();if("edit"==this.settings.backspace&&c)return i=1==r.anchorNode.nodeType?null:r.anchorNode.previousElementSibling,setTimeout(this.editTag.bind(this),0,i),void t.preventDefault();if(u()&&c)return s=a(c),c.hasAttribute("readonly")||c.remove(),this.DOM.input.focus(),void setTimeout(()=>{this.placeCaretAfterNode(s),this.DOM.input.click()});if("BR"==r.anchorNode.nodeName)return;if((l||c)&&1==r.anchorNode.nodeType?n=0==r.anchorOffset?l?h[0]:null:h[r.anchorOffset-1]:l?n=r.anchorNode.nextElementSibling:c&&(n=c),3==r.anchorNode.nodeType&&!r.anchorNode.nodeValue&&r.anchorNode.previousElementSibling&&t.preventDefault(),(c||l)&&!this.settings.backspace)return void t.preventDefault();if("Range"!=r.type&&!r.anchorOffset&&r.anchorNode==this.DOM.input&&"Delete"!=t.key)return void t.preventDefault();if("Range"!=r.type&&n&&n.hasAttribute("readonly"))return void this.placeCaretAfterNode(a(n));clearTimeout(g),g=setTimeout(()=>{var t=document.getSelection(),e=o(this.DOM.input.innerHTML),i=t.anchorNode.previousElementSibling;if(!u()&&e.length>=d.length&&i&&!i.hasAttribute("readonly")&&(this.removeTags(i),this.fixFirefoxLastTagNoCaret(),2==this.DOM.input.children.length&&"BR"==this.DOM.input.children[1].tagName))return this.DOM.input.innerHTML="",this.value.length=0,!0;this.value=[].map.call(h,(t,e)=>{var i=this.tagData(t);if(t.parentNode||i.readonly)return i;this.trigger("remove",{tag:t,index:e,data:i})}).filter(t=>t)},20)}return!0}switch(t.key){case"Backspace":this.state.dropdown.visible&&"manual"!=this.settings.dropdown.position||""!=e&&8203!=e.charCodeAt(0)||(!0===this.settings.backspace?this.removeTags():"edit"==this.settings.backspace&&setTimeout(this.editTag.bind(this),0));break;case"Esc":case"Escape":if(this.state.dropdown.visible)return;t.target.blur();break;case"Down":case"ArrowDown":this.state.dropdown.visible||this.dropdown.show();break;case"ArrowRight":{let t=this.state.inputSuggestion||this.state.ddItemData;if(t&&this.settings.autoComplete.rightKey)return void this.addTags([t],!0);break}case"Tab":{let i="select"==this.settings.mode;if(!e||i)return!0;t.preventDefault()}case"Enter":if(this.state.dropdown.visible||229==t.keyCode)return;t.preventDefault(),setTimeout(()=>{this.state.actions.selectOption||this.addTags(e,!0)})}},onInput(t){if("mix"==this.settings.mode)return this.events.callbacks.onMixTagsInput.call(this,t);var e=this.input.normalize.call(this),i=e.length>=this.settings.dropdown.enabled,n={value:e,inputElm:this.DOM.input};n.isValid=this.validateTag({value:e}),this.state.inputText!=e&&(this.input.set.call(this,e,!1),-1!=e.search(this.settings.delimiters)?this.addTags(e)&&this.input.set.call(this):this.settings.dropdown.enabled>=0&&this.dropdown[i?"show":"hide"](e),this.trigger("input",n))},onMixTagsInput(t){var e,i,n,s,o,a,r,l,d=this.settings,h=this.value.length,p=this.getTagElms(),g=document.createDocumentFragment(),f=window.getSelection().getRangeAt(0),m=[].map.call(p,t=>this.tagData(t).value);if("deleteContentBackward"==t.inputType&&u()&&this.events.callbacks.onKeydown.call(this,{target:t.target,key:"Backspace"}),this.value.slice().forEach(t=>{t.readonly&&!m.includes(t.value)&&g.appendChild(this.createTagElem(t))}),g.childNodes.length&&(f.insertNode(g),this.setRangeAtStartEnd(!1,g.lastChild)),p.length!=h)return this.value=[].map.call(this.getTagElms(),t=>this.tagData(t)),void this.update({withoutChangeEvent:!0});if(this.hasMaxTags())return!0;if(window.getSelection&&(a=window.getSelection()).rangeCount>0&&3==a.anchorNode.nodeType){if((f=a.getRangeAt(0).cloneRange()).collapse(!0),f.setStart(a.focusNode,0),n=(e=f.toString().slice(0,f.endOffset)).split(d.pattern).length-1,(i=e.match(d.pattern))&&(s=e.slice(e.lastIndexOf(i[i.length-1]))),s){if(this.state.actions.ArrowLeft=!1,this.state.tag={prefix:s.match(d.pattern)[0],value:s.replace(d.pattern,"")},this.state.tag.baseOffset=a.baseOffset-this.state.tag.value.length,l=this.state.tag.value.match(d.delimiters))return this.state.tag.value=this.state.tag.value.replace(d.delimiters,""),this.state.tag.delimiters=l[0],this.addTags(this.state.tag.value,d.dropdown.clearOnSelect),void this.dropdown.hide();o=this.state.tag.value.length>=d.dropdown.enabled;try{r=(r=this.state.flaggedTags[this.state.tag.baseOffset]).prefix==this.state.tag.prefix&&r.value[0]==this.state.tag.value[0],this.state.flaggedTags[this.state.tag.baseOffset]&&!this.state.tag.value&&delete this.state.flaggedTags[this.state.tag.baseOffset]}catch(t){}(r||n<this.state.mixMode.matchedPatternCount)&&(o=!1)}else this.state.flaggedTags={};this.state.mixMode.matchedPatternCount=n}setTimeout(()=>{this.update({withoutChangeEvent:!0}),this.trigger("input",c({},this.state.tag,{textContent:this.DOM.input.textContent})),this.state.tag&&this.dropdown[o?"show":"hide"](this.state.tag.value)},10)},onInputIE(t){var e=this;setTimeout((function(){e.events.callbacks.onInput.call(e,t)}))},onClickScope(t){var e=this.settings,i=t.target.closest("."+e.classNames.tag),n=+new Date-this.state.hasFocus;if(t.target!=this.DOM.scope){if(!t.target.classList.contains(e.classNames.tagX))return i?(this.trigger("click",{tag:i,index:this.getNodeIndex(i),data:this.tagData(i),originalEvent:this.cloneEvent(t)}),void(1!==e.editTags&&1!==e.editTags.clicks||this.events.callbacks.onDoubleClickScope.call(this,t))):void(t.target==this.DOM.input&&("mix"==e.mode&&this.fixFirefoxLastTagNoCaret(),n>500)?this.state.dropdown.visible?this.dropdown.hide():0===e.dropdown.enabled&&"mix"!=e.mode&&this.dropdown.show():"select"==e.mode&&!this.state.dropdown.visible&&this.dropdown.show());this.removeTags(t.target.parentNode)}else this.state.hasFocus||this.DOM.input.focus()},onPaste(t){var e,i;t.preventDefault(),this.settings.readonly||(e=t.clipboardData||window.clipboardData,i=e.getData("Text"),this.settings.hooks.beforePaste(t,{tagify:this,pastedText:i,clipboardData:e}).then(e=>{void 0===e&&(e=i),e&&(this.injectAtCaret(e,window.getSelection().getRangeAt(0)),"mix"==this.settings.mode?this.events.callbacks.onMixTagsInput.call(this,t):this.settings.pasteAsTags?this.addTags(e,!0):this.state.inputText=e)}).catch(t=>t))},onEditTagInput(t,e){var i=t.closest("."+this.settings.classNames.tag),n=this.getNodeIndex(i),s=this.tagData(i),o=this.input.normalize.call(this,t),a=i.innerHTML!=i.__tagifyTagData.__originalHTML,r=this.validateTag({[this.settings.tagTextProp]:o});a||!0!==t.originalIsValid||(r=!0),i.classList.toggle(this.settings.classNames.tagInvalid,!0!==r),s.__isValid=r,i.title=!0===r?s.title||s.value:r,o.length>=this.settings.dropdown.enabled&&(this.state.editing&&(this.state.editing.value=o),this.dropdown.show(o)),this.trigger("edit:input",{tag:i,index:n,data:c({},this.value[n],{newValue:o}),originalEvent:this.cloneEvent(e)})},onEditTagFocus(t){this.state.editing={scope:t,input:t.querySelector("[contenteditable]")}},onEditTagBlur(t){if(this.state.hasFocus||this.toggleFocusClass(),this.DOM.scope.contains(t)){var e,i,n=this.settings,s=t.closest("."+n.classNames.tag),o=this.input.normalize.call(this,t),a=this.tagData(s).__originalData,r=s.innerHTML!=s.__tagifyTagData.__originalHTML,l=this.validateTag({[n.tagTextProp]:o});if(o)if(r){if(e=this.hasMaxTags(),i=this.getWhitelistItem(o)||c({},a,{[n.tagTextProp]:o,value:o,__isValid:l}),n.transformTag.call(this,i,a),!0!==(l=!e&&this.validateTag({[n.tagTextProp]:i[n.tagTextProp]}))){if(this.trigger("invalid",{data:i,tag:s,message:l}),n.editTags.keepInvalid)return;n.keepInvalidTags?i.__isValid=l:i=a}else n.keepInvalidTags&&(delete i.title,delete i["aria-invalid"],delete i.class);this.onEditTagDone(s,i)}else this.onEditTagDone(s,a);else this.onEditTagDone(s)}},onEditTagkeydown(t,e){switch(this.trigger("edit:keydown",{originalEvent:this.cloneEvent(t)}),t.key){case"Esc":case"Escape":e.innerHTML=e.__tagifyTagData.__originalHTML;case"Enter":case"Tab":t.preventDefault(),t.target.blur()}},onDoubleClickScope(t){var e,i,n=t.target.closest("."+this.settings.classNames.tag),s=this.settings;n&&(e=n.classList.contains(this.settings.classNames.tagEditing),i=n.hasAttribute("readonly"),"select"==s.mode||s.readonly||e||i||!this.settings.editTags||this.editTag(n),this.toggleFocusClass(!0),this.trigger("dblclick",{tag:n,index:this.getNodeIndex(n),data:this.tagData(n)}))}}};function w(t,e){return t?t.previousElementSibling&&t.previousElementSibling.classList.contains("tagify")?(console.warn("Tagify: ","input element is already Tagified",t),this):(c(this,function(t){var e=document.createTextNode("");function i(t,i,n){n&&i.split(/\s+/g).forEach(i=>e[t+"EventListener"].call(e,i,n))}return{off(t,e){return i("remove",t,e),this},on(t,e){return e&&"function"==typeof e&&i("add",t,e),this},trigger(i,n,s){var o;if(s=s||{cloneData:!0},i)if(t.settings.isJQueryPlugin)"remove"==i&&(i="removeTag"),jQuery(t.DOM.originalInput).triggerHandler(i,[n]);else{try{var a="object"==typeof n?n:{value:n};if((a=s.cloneData?c({},a):a).tagify=this,n instanceof Object)for(var r in n)n[r]instanceof HTMLElement&&(a[r]=n[r]);o=new CustomEvent(i,{detail:a})}catch(t){console.warn(t)}e.dispatchEvent(o)}}}}(this)),this.isFirefox="undefined"!=typeof InstallTrigger,this.isIE=window.document.documentMode,this.applySettings(t,e||{}),this.state={inputText:"",editing:!1,actions:{},mixMode:{},dropdown:{},flaggedTags:{}},this.value=[],this.listeners={},this.DOM={},this.build(t),p.call(this),this.getCSSVars(),this.loadOriginalValues(),this.events.customBinding.call(this),this.events.binding.call(this),void(t.autofocus&&this.DOM.input.focus())):(console.warn("Tagify: ","input element not found",t),this)}return w.prototype={_dropdown:f,customEventsList:["change","add","remove","invalid","input","click","keydown","focus","blur","edit:input","edit:beforeUpdate","edit:updated","edit:start","edit:keydown","dropdown:show","dropdown:hide","dropdown:select","dropdown:updated","dropdown:noMatch","dropdown:scroll"],dataProps:["__isValid","__removed","__originalData","__originalHTML","__tagId"],trim(t){return this.settings.trim&&t&&"string"==typeof t?t.trim():t},parseHTML:function(t){return(new DOMParser).parseFromString(t.trim(),"text/html").body.firstElementChild},templates:v,parseTemplate(t,e){return t=this.settings.templates[t]||t,this.parseHTML(t.apply(this,e))},set whitelist(t){this.settings.whitelist=t&&Array.isArray(t)?t:[]},get whitelist(){return this.settings.whitelist},applySettings(t,e){h.templates=this.templates;var n=this.settings=c({},h,e);n.disabled=t.hasAttribute("disabled"),n.readonly=t.hasAttribute("readonly"),n.placeholder=t.getAttribute("placeholder")||n.placeholder||"",n.required=t.hasAttribute("required");for(let i in n.classNames)Object.defineProperty(n.classNames,i+"Selector",{get(){return"."+this[i].split(" ")[0]}});if(this.isIE&&(n.autoComplete=!1),["whitelist","blacklist"].forEach(e=>{var i=t.getAttribute("data-"+e);i&&(i=i.split(n.delimiters))instanceof Array&&(n[e]=i)}),"autoComplete"in e&&!l(e.autoComplete)&&(n.autoComplete=h.autoComplete,n.autoComplete.enabled=e.autoComplete),"mix"==n.mode&&(n.autoComplete.rightKey=!0,n.delimiters=e.delimiters||null,n.tagTextProp&&!n.dropdown.searchKeys.includes(n.tagTextProp)&&n.dropdown.searchKeys.push(n.tagTextProp)),t.pattern)try{n.pattern=new RegExp(t.pattern)}catch(t){}if(this.settings.delimiters)try{n.delimiters=new RegExp(this.settings.delimiters,"g")}catch(t){}this.TEXTS=i(i({},m),n.texts||{}),"select"==n.mode&&(n.dropdown.enabled=0),n.dropdown.appendTarget=e.dropdown&&e.dropdown.appendTarget?e.dropdown.appendTarget:document.body},getAttributes(t){var e,i=this.getCustomAttributes(t),n="";for(e in i)n+=" "+e+(void 0!==t[e]?`="${i[e]}"`:"");return n},getCustomAttributes(t){if(!l(t))return"";var e,i={};for(e in t)"__"!=e.slice(0,2)&&"class"!=e&&t.hasOwnProperty(e)&&void 0!==t[e]&&(i[e]=r(t[e]));return i},setStateSelection(){var t=window.getSelection(),e={anchorOffset:t.anchorOffset,anchorNode:t.anchorNode,range:t.getRangeAt&&t.rangeCount&&t.getRangeAt(0)};return this.state.selection=e,e},getCaretGlobalPosition(){const t=document.getSelection();if(t.rangeCount){const e=t.getRangeAt(0),i=e.startContainer,n=e.startOffset;let s,o;if(n>0)return o=document.createRange(),o.setStart(i,n-1),o.setEnd(i,n),s=o.getBoundingClientRect(),{left:s.right,top:s.top,bottom:s.bottom};if(i.getBoundingClientRect)return i.getBoundingClientRect()}return{left:-9999,top:-9999}},getCSSVars(){var t,e=getComputedStyle(this.DOM.scope,null);this.CSSVars={tagHideTransition:(({value:t,unit:e})=>"s"==e?1e3*t:t)(function(t){if(!t)return{};var e=(t=t.trim().split(" ")[0]).split(/\d+/g).filter(t=>t).pop().trim();return{value:+t.split(e).filter(t=>t)[0].trim(),unit:e}}((t="tag-hide-transition",e.getPropertyValue("--"+t))))}},build(t){var e=this.DOM;this.settings.mixMode.integrated?(e.originalInput=null,e.scope=t,e.input=t):(e.originalInput=t,e.scope=this.parseTemplate("wrapper",[t,this.settings]),e.input=e.scope.querySelector(this.settings.classNames.inputSelector),t.parentNode.insertBefore(e.scope,t))},destroy(){this.events.unbindGlobal.call(this),this.DOM.scope.parentNode.removeChild(this.DOM.scope),this.dropdown.hide(!0),clearTimeout(this.dropdownHide__bindEventsTimeout)},loadOriginalValues(t){var e,i=this.settings;if(void 0===t&&(t=i.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value),this.removeAllTags({withoutChangeEvent:!0}),t)if("mix"==i.mode)this.parseMixTags(t.trim()),(e=this.DOM.input.lastChild)&&"BR"==e.tagName||this.DOM.input.insertAdjacentHTML("beforeend","<br>");else{try{JSON.parse(t)instanceof Array&&(t=JSON.parse(t))}catch(t){}this.addTags(t).forEach(t=>t&&t.classList.add(i.classNames.tagNoAnimation))}else this.postUpdate();this.state.lastOriginalValueReported=i.mixMode.integrated?"":this.DOM.originalInput.value,this.state.loadedOriginalValues=!0},cloneEvent(t){var e={};for(var i in t)e[i]=t[i];return e},loading(t){return this.state.isLoading=t,this.DOM.scope.classList[t?"add":"remove"](this.settings.classNames.scopeLoading),this},tagLoading(t,e){return t&&t.classList[e?"add":"remove"](this.settings.classNames.tagLoading),this},toggleClass(t,e){"string"==typeof t&&this.DOM.scope.classList.toggle(t,e)},toggleFocusClass(t){this.toggleClass(this.settings.classNames.focus,!!t)},triggerChangeEvent:function(){if(!this.settings.mixMode.integrated){var t=this.DOM.originalInput,e=this.state.lastOriginalValueReported!==t.value,i=new CustomEvent("change",{bubbles:!0});e&&(this.state.lastOriginalValueReported=t.value,i.simulated=!0,t._valueTracker&&t._valueTracker.setValue(Math.random()),t.dispatchEvent(i),this.trigger("change",this.state.lastOriginalValueReported),t.value=this.state.lastOriginalValueReported)}},events:b,fixFirefoxLastTagNoCaret(){},placeCaretAfterNode(t){if(t&&t.parentNode){var e=t.nextSibling,i=window.getSelection(),n=i.getRangeAt(0);i.rangeCount&&(n.setStartBefore(e||t),n.setEndBefore(e||t),i.removeAllRanges(),i.addRange(n))}},insertAfterTag(t,e){if(e=e||this.settings.mixMode.insertAfterTag,t&&t.parentNode&&e)return e="string"==typeof e?document.createTextNode(e):e,t.parentNode.insertBefore(e,t.nextSibling),e},editTag(t,e){t=t||this.getLastTag(),e=e||{},this.dropdown.hide();var i=this.settings;function n(){return t.querySelector(i.classNames.tagTextSelector)}var s=n(),o=this.getNodeIndex(t),a=this.tagData(t),r=this.events.callbacks,l=this,d=!0;if(s){if(!(a instanceof Object&&"editable"in a)||a.editable)return s.setAttribute("contenteditable",!0),t.classList.add(i.classNames.tagEditing),this.tagData(t,{__originalData:c({},a),__originalHTML:t.innerHTML}),s.addEventListener("focus",r.onEditTagFocus.bind(this,t)),s.addEventListener("blur",(function(){setTimeout(()=>r.onEditTagBlur.call(l,n()))})),s.addEventListener("input",r.onEditTagInput.bind(this,s)),s.addEventListener("keydown",e=>r.onEditTagkeydown.call(this,e,t)),s.focus(),this.setRangeAtStartEnd(!1,s),e.skipValidation||(d=this.editTagToggleValidity(t)),s.originalIsValid=d,this.trigger("edit:start",{tag:t,index:o,data:a,isValid:d}),this}else console.warn("Cannot find element in Tag template: .",i.classNames.tagTextSelector)},editTagToggleValidity(t,e){var i;if(e=e||this.tagData(t))return(i=!("__isValid"in e)||!0===e.__isValid)||this.removeTagsFromValue(t),this.update(),t.classList.toggle(this.settings.classNames.tagNotAllowed,!i),e.__isValid;console.warn("tag has no data: ",t,e)},onEditTagDone(t,e){e=e||{};var i={tag:t=t||this.state.editing.scope,index:this.getNodeIndex(t),previousData:this.tagData(t),data:e};this.trigger("edit:beforeUpdate",i,{cloneData:!1}),this.state.editing=!1,delete e.__originalData,delete e.__originalHTML,t&&e[this.settings.tagTextProp]?(t=this.replaceTag(t,e),this.editTagToggleValidity(t,e),this.settings.a11y.focusableTags&&t.focus()):t&&this.removeTags(t),this.trigger("edit:updated",i),this.dropdown.hide(),this.settings.keepInvalidTags&&this.reCheckInvalidTags()},replaceTag(t,e){e&&e.value||(e=t.__tagifyTagData),e.__isValid&&1!=e.__isValid&&c(e,this.getInvalidTagAttrs(e,e.__isValid));var i=this.createTagElem(e);return t.parentNode.replaceChild(i,t),this.updateValueByDOMTags(),i},updateValueByDOMTags(){this.value.length=0,[].forEach.call(this.getTagElms(),t=>{t.classList.contains(this.settings.classNames.tagNotAllowed.split(" ")[0])||this.value.push(this.tagData(t))}),this.update()},setRangeAtStartEnd(t,e){t="number"==typeof t?t:!!t,e=(e=e||this.DOM.input).lastChild||e;var i=document.getSelection();try{i.rangeCount>=1&&["Start","End"].forEach(n=>i.getRangeAt(0)["set"+n](e,t||e.length))}catch(t){console.warn("Tagify: ",t)}},injectAtCaret(t,e){if(e=e||this.state.selection.range)return"string"==typeof t&&(t=document.createTextNode(t)),e.deleteContents(),e.insertNode(t),this.setRangeAtStartEnd(!1,t),this.updateValueByDOMTags(),this.update(),this},input:{set(t="",e=!0){var i=this.settings.dropdown.closeOnSelect;this.state.inputText=t,e&&(this.DOM.input.innerHTML=r(""+t)),!t&&i&&this.dropdown.hide.bind(this),this.input.autocomplete.suggest.call(this),this.input.validate.call(this)},validate(){var t=!this.state.inputText||!0===this.validateTag({value:this.state.inputText});return this.DOM.input.classList.toggle(this.settings.classNames.inputInvalid,!t),t},normalize(t){var e=t||this.DOM.input,i=[];e.childNodes.forEach(t=>3==t.nodeType&&i.push(t.nodeValue)),i=i.join("\n");try{i=i.replace(/(?:\r\n|\r|\n)/g,this.settings.delimiters.source.charAt(0))}catch(t){}return i=i.replace(/\s/g," "),this.settings.trim&&(i=i.replace(/^\s+/,"")),i},autocomplete:{suggest(t){if(this.settings.autoComplete.enabled){"string"==typeof(t=t||{})&&(t={value:t});var e=t.value?""+t.value:"",i=e.substr(0,this.state.inputText.length).toLowerCase(),n=e.substring(this.state.inputText.length);e&&this.state.inputText&&i==this.state.inputText.toLowerCase()?(this.DOM.input.setAttribute("data-suggest",n),this.state.inputSuggestion=t):(this.DOM.input.removeAttribute("data-suggest"),delete this.state.inputSuggestion)}},set(t){var e=this.DOM.input.getAttribute("data-suggest"),i=t||(e?this.state.inputText+e:null);return!!i&&("mix"==this.settings.mode?this.replaceTextWithNode(document.createTextNode(this.state.tag.prefix+i)):(this.input.set.call(this,i),this.setRangeAtStartEnd()),this.input.autocomplete.suggest.call(this),this.dropdown.hide(),!0)}}},getTagIdx(t){return this.value.findIndex(e=>e.__tagId==(t||{}).__tagId)},getNodeIndex(t){var e=0;if(t)for(;t=t.previousElementSibling;)e++;return e},getTagElms(...t){var e="."+[...this.settings.classNames.tag.split(" "),...t].join(".");return[].slice.call(this.DOM.scope.querySelectorAll(e))},getLastTag(){var t=this.DOM.scope.querySelectorAll(`${this.settings.classNames.tagSelector}:not(.${this.settings.classNames.tagHide}):not([readonly])`);return t[t.length-1]},tagData:(t,e,i)=>t?(e&&(t.__tagifyTagData=i?e:c({},t.__tagifyTagData||{},e)),t.__tagifyTagData):(console.warn("tag elment doesn't exist",t,e),e),isTagDuplicate(t,e){var i=this.settings;return"select"!=i.mode&&this.value.reduce((s,o)=>n(this.trim(""+t),o.value,e||i.dropdown.caseSensitive)?s+1:s,0)},getTagIndexByValue(t){var e=[];return this.getTagElms().forEach((i,s)=>{n(this.trim(i.textContent),t,this.settings.dropdown.caseSensitive)&&e.push(s)}),e},getTagElmByValue(t){var e=this.getTagIndexByValue(t)[0];return this.getTagElms()[e]},flashTag(t){t&&(t.classList.add(this.settings.classNames.tagFlash),setTimeout(()=>{t.classList.remove(this.settings.classNames.tagFlash)},100))},isTagBlacklisted(t){return t=this.trim(t.toLowerCase()),this.settings.blacklist.filter(e=>(""+e).toLowerCase()==t).length},isTagWhitelisted(t){return!!this.getWhitelistItem(t)},getWhitelistItem(t,e,i){e=e||"value";var s,o=this.settings;return(i=i||o.whitelist).some(i=>{var a="string"==typeof i?i:i[e]||i.value;if(n(a,t,o.dropdown.caseSensitive,o.trim))return s="string"==typeof i?{value:i}:i,!0}),s||"value"!=e||"value"==o.tagTextProp||(s=this.getWhitelistItem(t,o.tagTextProp,i)),s},validateTag(t){var e=this.settings,i="value"in t?"value":e.tagTextProp,n=this.trim(t[i]+"");return(t[i]+"").trim()?e.pattern&&e.pattern instanceof RegExp&&!e.pattern.test(n)?this.TEXTS.pattern:!e.duplicates&&this.isTagDuplicate(n,this.state.editing)?this.TEXTS.duplicate:this.isTagBlacklisted(n)||e.enforceWhitelist&&!this.isTagWhitelisted(n)?this.TEXTS.notAllowed:!e.validate||e.validate(t):this.TEXTS.empty},getInvalidTagAttrs(t,e){return{"aria-invalid":!0,class:`${t.class||""} ${this.settings.classNames.tagNotAllowed}`.trim(),title:e}},hasMaxTags(){return this.value.length>=this.settings.maxTags&&this.TEXTS.exceed},setReadonly(t,e){var i=this.settings;document.activeElement.blur(),i[e||"readonly"]=t,this.DOM.scope[(t?"set":"remove")+"Attribute"](e||"readonly",!0),"mix"==i.mode&&(this.DOM.input.contentEditable=!t)},setDisabled(t){this.setReadonly(t,"disabled")},normalizeTags(t){var e=this.settings,i=e.whitelist,n=e.delimiters,s=e.mode,o=e.tagTextProp;e.enforceWhitelist;var a=[],r=!!i&&i[0]instanceof Object,l=t instanceof Array,c=t=>(t+"").split(n).filter(t=>t).map(t=>({[o]:this.trim(t),value:this.trim(t)}));if("number"==typeof t&&(t=t.toString()),"string"==typeof t){if(!t.trim())return[];t=c(t)}else l&&(t=[].concat(...t.map(t=>t.value?t:c(t))));return r&&(t.forEach(t=>{var e=a.map(t=>t.value),i=this.dropdown.filterListItems.call(this,t[o],{exact:!0}).filter(t=>!e.includes(t.value)),n=i.length>1?this.getWhitelistItem(t[o],o,i):i[0];n&&n instanceof Object?a.push(n):"mix"!=s&&(null==t.value&&(t.value=t[o]),a.push(t))}),t=a),t},parseMixTags(t){var e=this.settings,i=e.mixTagsInterpolator,n=e.duplicates,s=e.transformTag,o=e.enforceWhitelist,a=e.maxTags,r=e.tagTextProp,l=[];return t=t.split(i[0]).map((t,e)=>{var c,d,u,h=t.split(i[1]),p=h[0],g=l.length==a;try{if(p==+p)throw Error;d=JSON.parse(p)}catch(t){d=this.normalizeTags(p)[0]||{value:p}}if(g||!(h.length>1)||o&&!this.isTagWhitelisted(d.value)||!n&&this.isTagDuplicate(d.value)){if(t)return e?i[0]+t:t}else s.call(this,d),d[c=d[r]?r:"value"]=this.trim(d[c]),u=this.createTagElem(d),l.push(d),u.classList.add(this.settings.classNames.tagNoAnimation),h[0]=u.outerHTML,this.value.push(d);return h.join("")}).join(""),this.DOM.input.innerHTML=t,this.DOM.input.appendChild(document.createTextNode("")),this.DOM.input.normalize(),this.getTagElms().forEach((t,e)=>this.tagData(t,l[e])),this.update({withoutChangeEvent:!0}),t},replaceTextWithNode(t,e){if(this.state.tag||e){e=e||this.state.tag.prefix+this.state.tag.value;var i,n,s=window.getSelection(),o=s.anchorNode,a=this.state.tag.delimiters?this.state.tag.delimiters.length:0;return o.splitText(s.anchorOffset-a),i=o.nodeValue.lastIndexOf(e),n=o.splitText(i),t&&o.parentNode.replaceChild(t,n),!0}},selectTag(t,e){if(!this.settings.enforceWhitelist||this.isTagWhitelisted(e.value)){this.input.set.call(this,e[this.settings.tagTextProp||"value"],!0),this.state.actions.selectOption&&setTimeout(this.setRangeAtStartEnd.bind(this));var i=this.getLastTag();return i?this.replaceTag(i,e):this.appendTag(t),this.value[0]=e,this.trigger("add",{tag:t,data:e}),this.update(),[t]}},addEmptyTag(t){var e=c({value:""},t||{}),i=this.createTagElem(e);this.tagData(i,e),this.appendTag(i),this.editTag(i,{skipValidation:!0})},addTags(t,e,i=this.settings.skipInvalid){var n=[],s=this.settings,o=document.createDocumentFragment();return t&&0!=t.length?(t=this.normalizeTags(t),"mix"==s.mode?this.addMixTags(t):("select"==s.mode&&(e=!1),this.DOM.input.removeAttribute("style"),t.forEach(t=>{var e,a={},r=Object.assign({},t,{value:t.value+""});if((t=Object.assign({},r)).__isValid=this.hasMaxTags()||this.validateTag(t),s.transformTag.call(this,t),!0!==t.__isValid){if(i)return;c(a,this.getInvalidTagAttrs(t,t.__isValid),{__preInvalidData:r}),t.__isValid==this.TEXTS.duplicate&&this.flashTag(this.getTagElmByValue(t.value))}if(t.readonly&&(a["aria-readonly"]=!0),e=this.createTagElem(t,a),n.push(e),"select"==s.mode)return this.selectTag(e,t);o.appendChild(e),t.__isValid&&!0===t.__isValid?(this.value.push(t),this.trigger("add",{tag:e,index:this.value.length-1,data:t})):(this.trigger("invalid",{data:t,index:this.value.length,tag:e,message:t.__isValid}),s.keepInvalidTags||setTimeout(()=>this.removeTags(e,!0),1e3)),this.dropdown.position()}),this.appendTag(o),this.update(),t.length&&e&&this.input.set.call(this),this.dropdown.refilter(),n)):("select"==s.mode&&this.removeAllTags(),n)},addMixTags(t){if(t[0].prefix||this.state.tag)return this.prefixedTextToTag(t[0]);"string"==typeof t&&(t=[{value:t}]);var e=!!this.state.selection,i=document.createDocumentFragment();return t.forEach(t=>{var e=this.createTagElem(t);i.appendChild(e),this.insertAfterTag(e)}),e?this.injectAtCaret(i):(this.DOM.input.focus(),(e=this.setStateSelection()).range.setStart(this.DOM.input,e.range.endOffset),e.range.setEnd(this.DOM.input,e.range.endOffset),this.DOM.input.appendChild(i),this.updateValueByDOMTags(),this.update()),i},prefixedTextToTag(t){var e,i=this.settings,n=this.state.tag.delimiters;if(i.transformTag.call(this,t),t.prefix=t.prefix||this.state.tag?this.state.tag.prefix:(i.pattern.source||i.pattern)[0],e=this.createTagElem(t),this.replaceTextWithNode(e)||this.DOM.input.appendChild(e),setTimeout(()=>e.classList.add(this.settings.classNames.tagNoAnimation),300),this.value.push(t),this.update(),!n){var s=this.insertAfterTag(e)||e;this.placeCaretAfterNode(s)}return this.state.tag=null,this.trigger("add",c({},{tag:e},{data:t})),e},appendTag(t){var e=this.DOM,i=e.scope.lastElementChild;i===e.input?e.scope.insertBefore(t,i):e.scope.appendChild(t)},createTagElem(t,e){t.__tagId=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16));var n,s=c({},t,i({value:r(t.value+"")},e));return function(t){for(var e,i=document.createNodeIterator(t,NodeFilter.SHOW_TEXT,null,!1);e=i.nextNode();)e.textContent.trim()||e.parentNode.removeChild(e)}(n=this.parseTemplate("tag",[s])),this.tagData(n,t),n},reCheckInvalidTags(){var t=this.settings;this.getTagElms(t.classNames.tagNotAllowed).forEach((t,e)=>{var i=this.tagData(t),n=this.hasMaxTags(),s=this.validateTag(i);if(!0===s&&!n)return i=i.__preInvalidData?i.__preInvalidData:{value:i.value},this.replaceTag(t,i);t.title=n||s})},removeTags(t,e,i){var n;t=t&&t instanceof HTMLElement?[t]:t instanceof Array?t:t?[t]:[this.getLastTag()],n=t.reduce((t,e)=>(e&&"string"==typeof e&&(e=this.getTagElmByValue(e)),e&&this.tagData(e)&&t.push({node:e,idx:this.getTagIdx(this.tagData(e)),data:this.tagData(e,{__removed:!0})}),t),[]),i="number"==typeof i?i:this.CSSVars.tagHideTransition,"select"==this.settings.mode&&(i=0,this.input.set.call(this)),1==n.length&&n[0].node.classList.contains(this.settings.classNames.tagNotAllowed)&&(e=!0),n.length&&this.settings.hooks.beforeRemoveTag(n,{tagify:this}).then(()=>{function t(t){t.node.parentNode&&(t.node.parentNode.removeChild(t.node),e?this.settings.keepInvalidTags&&this.trigger("remove",{tag:t.node,index:t.idx}):(this.trigger("remove",{tag:t.node,index:t.idx,data:t.data}),this.dropdown.refilter(),this.dropdown.position(),this.DOM.input.normalize(),this.settings.keepInvalidTags&&this.reCheckInvalidTags()))}i&&i>10&&1==n.length?function(e){e.node.style.width=parseFloat(window.getComputedStyle(e.node).width)+"px",document.body.clientTop,e.node.classList.add(this.settings.classNames.tagHide),setTimeout(t.bind(this),i,e)}.call(this,n[0]):n.forEach(t.bind(this)),e||(this.removeTagsFromValue(n.map(t=>t.node)),this.update())}).catch(t=>{})},removeTagsFromDOM(){[].slice.call(this.getTagElms()).forEach(t=>t.parentNode.removeChild(t))},removeTagsFromValue(t){(t=Array.isArray(t)?t:[t]).forEach(t=>{var e=this.tagData(t),i=this.getTagIdx(e);i>-1&&this.value.splice(i,1)})},removeAllTags(t){t=t||{},this.value=[],"mix"==this.settings.mode?this.DOM.input.innerHTML="":this.removeTagsFromDOM(),this.dropdown.position(),"select"==this.settings.mode&&this.input.set.call(this),this.update(t)},postUpdate(){var t=this.settings.classNames,e="mix"==this.settings.mode?this.settings.mixMode.integrated?this.DOM.input.textContent:this.DOM.originalInput.value:this.value.length;this.toggleClass(t.hasMaxTags,this.value.length>=this.settings.maxTags),this.toggleClass(t.hasNoTags,!this.value.length),this.toggleClass(t.empty,!e)},update(t){var e=this.DOM.originalInput;this.settings.mixMode.integrated||(e.value=this.getInputValue()),this.postUpdate(),!(t||{}).withoutChangeEvent&&this.state.loadedOriginalValues&&this.triggerChangeEvent()},getInputValue(){var t=this.getCleanValue();return"mix"==this.settings.mode?this.getMixedTagsAsString(t):t.length?this.settings.originalInputValueFormat?this.settings.originalInputValueFormat(t):JSON.stringify(t):""},getCleanValue(t){return e=t||this.value,i=this.dataProps,e&&Array.isArray(e)&&e.map(t=>s(t,i));var e,i},getMixedTagsAsString(){var t="",e=this,i=this.settings.mixTagsInterpolator;return function n(o){o.childNodes.forEach(o=>{if(1==o.nodeType){const a=e.tagData(o);if(o.classList.contains(e.settings.classNames.tag)&&a){if(a.__removed)return;return void(t+=i[0]+JSON.stringify(s(a,e.dataProps))+i[1])}"BR"!=o.tagName||o.parentNode!=e.DOM.input&&1!=o.parentNode.childNodes.length?"DIV"!=o.tagName&&"P"!=o.tagName||(t+="\r\n",n(o)):t+="\r\n"}else t+=o.textContent})}(this.DOM.input),t}},w.prototype.removeTag=w.prototype.removeTags,w}))},d300:function(t,e,i){"use strict";i.r(e);var n=i("7a23");const s=Object(n["createVNode"])("div",{class:"col-auto d-none d-sm-block"},[Object(n["createVNode"])("h3",null,"Editor")],-1),o={class:"container text-start"},a={class:"row"},r={class:"col-3"},l={class:"col-9"},c={class:"float-start"},d={class:"row g-3 align-items-center"},u=Object(n["createVNode"])("div",{class:"col-auto"},[Object(n["createVNode"])("label",{for:"inputPassword6",class:"col-form-label"},"Bot Name:")],-1),h={class:"col-auto"},p={key:1,class:"text-success"},g={key:0,class:"col-auto"},f=Object(n["createVNode"])("div",{class:"col-auto"},[Object(n["createVNode"])("label",{for:"inputPassword6",class:"col-form-label"},"Every")],-1),m={class:"col-auto"},v=Object(n["createVNode"])("div",{class:"col-auto"},[Object(n["createVNode"])("span",{id:"botNameHelp",class:"form-text"}," minutes ")],-1),b={class:"float-end"},w=Object(n["createVNode"])("i",{class:"fas fa-eraser"},null,-1),y=Object(n["createTextVNode"])(" Clear "),O={class:"text-end mt-2"},_={key:0,class:"text-success mr-2"},x={key:1,class:"text-danger mr-2"},C={key:0},j={key:1},T={key:2,class:"fas fa-check"},N={key:3,class:"fas fa-circle-notch fa-spin"},k={key:4,class:"fas fa-exclamation-circle"};function S(t,e){const i=Object(n["resolveComponent"])("loading"),S=Object(n["resolveComponent"])("blocks-menu"),E=Object(n["resolveComponent"])("vue-number-input"),L=Object(n["resolveComponent"])("admin-layout");return Object(n["openBlock"])(),Object(n["createBlock"])(L,null,{default:Object(n["withCtx"])(()=>[s,Object(n["createVNode"])(i,{active:t.isLoading,"can-cancel":!1,color:"#66B861","is-full-page":t.fullPage},null,8,["active","is-full-page"]),Object(n["createVNode"])("div",o,[Object(n["createVNode"])("div",a,[Object(n["createVNode"])("div",r,[Object(n["createVNode"])(S,{blocks:t.blocks},null,8,["blocks"])]),Object(n["createVNode"])("div",l,[Object(n["createVNode"])("div",null,[Object(n["createVNode"])("div",c,[Object(n["createVNode"])("div",d,[u,Object(n["createVNode"])("div",h,[t.botId?Object(n["createCommentVNode"])("",!0):Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createBlock"])("input",{key:0,class:[t.v$.botName.$invalid?"border-warning":"","form-control"],type:"text","onUpdate:modelValue":e[1]||(e[1]=e=>t.botName=e),placeholder:"bot name...",id:"botName","aria-describedby":"botNameHelp"},null,2)),[[n["vModelText"],t.botName]]),t.botId?(Object(n["openBlock"])(),Object(n["createBlock"])("span",p,Object(n["toDisplayString"])(t.botName),1)):Object(n["createCommentVNode"])("",!0)]),t.botId?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])("div",g,[Object(n["createVNode"])("span",{id:"botNameHelp",class:t.v$.botName.$invalid?"form-text text-warning":"form-text"}," Must be 5-20 characters long. ",2)])),f,Object(n["createVNode"])("div",m,[Object(n["createVNode"])(E,{"model-value":t.botFrequency,"onUpdate:modelValue":t.onFrequencyChange,min:1,max:120,size:t.small,inputtable:!0,inline:"",controls:""},null,8,["model-value","onUpdate:modelValue","size"])]),v])]),Object(n["createVNode"])("div",b,[Object(n["createVNode"])("button",{onClick:e[2]||(e[2]=(...e)=>t.clearBot&&t.clearBot(...e)),type:"button",class:"boto-button medium muted"},[w,y])])]),Object(n["createVNode"])("div",{ref:"botoEditor",id:"botoEditor",class:"drawflowContainer",onDrop:e[3]||(e[3]=(...e)=>t.drop&&t.drop(...e)),onDragover:e[4]||(e[4]=(...e)=>t.allowDrop&&t.allowDrop(...e))},null,544),Object(n["createVNode"])("div",O,[t.saveSuccess?(Object(n["openBlock"])(),Object(n["createBlock"])("span",_,"Saved!")):Object(n["createCommentVNode"])("",!0),t.saveError?(Object(n["openBlock"])(),Object(n["createBlock"])("span",x,Object(n["toDisplayString"])(t.saveErrorText),1)):Object(n["createCommentVNode"])("",!0),t.botId?(Object(n["openBlock"])(),Object(n["createBlock"])("button",{key:2,onClick:e[5]||(e[5]=(...e)=>t.cancelSaveBot&&t.cancelSaveBot(...e)),type:"button",class:"boto-button large secondary-btn mr-2"}," Cancel ")):Object(n["createCommentVNode"])("",!0),Object(n["createVNode"])("button",{onClick:e[6]||(e[6]=(...e)=>t.saveBot&&t.saveBot(...e)),type:"button",class:["boto-button large",t.v$.botName.$invalid?"btn-secondary":"primary-btn"],disabled:t.v$.botName.$invalid},[this.botId?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])("span",C,"Create Boto")),this.botId?(Object(n["openBlock"])(),Object(n["createBlock"])("span",j,"Update Boto")):Object(n["createCommentVNode"])("",!0),t.saveSuccess?(Object(n["openBlock"])(),Object(n["createBlock"])("i",T)):Object(n["createCommentVNode"])("",!0),t.saveLoading?(Object(n["openBlock"])(),Object(n["createBlock"])("i",N)):Object(n["createCommentVNode"])("",!0),t.saveError?(Object(n["openBlock"])(),Object(n["createBlock"])("i",k)):Object(n["createCommentVNode"])("",!0)],10,["disabled"])])])])])]),_:1})}var E=i("9ab4");const L={class:"title-box px-2 pt-1"},B={class:"text-muted"},$={class:"text-right px-2"};function D(t,e){const i=Object(n["resolveComponent"])("block-properties");return Object(n["openBlock"])(),Object(n["createBlock"])("div",null,[Object(n["createVNode"])("div",L,[Object(n["createVNode"])("i",{class:t.logo_class},null,2),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(t.name)+" ",1),Object(n["createVNode"])("small",B,"("+Object(n["toDisplayString"])(t.uid)+")",1)]),Object(n["createVNode"])("div",$,[Object(n["createVNode"])("a",{onClick:e[1]||(e[1]=e=>t.toggleSettings()),class:"fas fa-cog text-white"})]),t.showProperties?(Object(n["openBlock"])(),Object(n["createBlock"])(i,{key:t.id,blockId:t.uid,type:t.type,uid:t.uid,ctx:t.context,botContext:t.botContext,parameters:t.parameters,onClose:e[2]||(e[2]=e=>t.toggleSettings(!1))},null,8,["blockId","type","uid","ctx","botContext","parameters"])):Object(n["createCommentVNode"])("",!0)])}const M={class:"modal-mask p-2"},A={key:0,class:"form-group mt-2"},I={key:1,class:"form-group mt-2"},V={key:2,class:"form-group mt-2"},R=Object(n["createVNode"])("br",null,null,-1),H=Object(n["createVNode"])("br",null,null,-1),z={key:3,class:"form-group mt-2"},P=Object(n["createVNode"])("br",null,null,-1),F={key:4,class:"form-group mt-2"},q={key:5,class:"form-group mt-2"};function W(t,e){const i=Object(n["resolveComponent"])("TextProperty");return Object(n["openBlock"])(),Object(n["createBlock"])(n["Transition"],{name:"modal"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])("div",M,[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(t.parameters,s=>(Object(n["openBlock"])(),Object(n["createBlock"])("div",null,["STR"===s.type?(Object(n["openBlock"])(),Object(n["createBlock"])("div",A,[Object(n["createVNode"])("label",{for:s.slug,class:"text-left primary"},Object(n["toDisplayString"])(s.name),9,["for"]),Object(n["createVNode"])(i,{settings:t.tagifyStuff.tagifySettings,class:"form-control",mode:"input",name:s.slug,id:s.slug,value:t.form[s.slug],placeholder:s.placeholder,onChange:t.change},null,8,["settings","name","id","value","placeholder","onChange"]),Object(n["createVNode"])("small",{id:s.name+"Help",class:"form-text text-muted"},Object(n["toDisplayString"])(s.description),9,["id"])])):Object(n["createCommentVNode"])("",!0),"TXT"===s.type?(Object(n["openBlock"])(),Object(n["createBlock"])("div",I,[Object(n["createVNode"])("label",{for:s.slug,class:"text-left primary"},Object(n["toDisplayString"])(s.name),9,["for"]),Object(n["createVNode"])(i,{settings:t.tagifyStuff.tagifySettings,mode:"textarea",name:s.slug,id:s.slug,value:t.form[s.slug],onChange:t.change},null,8,["settings","name","id","value","onChange"]),Object(n["createVNode"])("small",{id:s.name+"Help",class:"form-text text-muted"},Object(n["toDisplayString"])(s.description),9,["id"])])):Object(n["createCommentVNode"])("",!0),"LIS"===s.type?(Object(n["openBlock"])(),Object(n["createBlock"])("div",V,[Object(n["createVNode"])("label",{for:s.slug,class:"text-left primary"},Object(n["toDisplayString"])(s.name),9,["for"]),R,Object(n["withDirectives"])(Object(n["createVNode"])("select",{"onUpdate:modelValue":e=>t.form[s.slug]=e,id:s.slug,onChange:e[1]||(e[1]=(...e)=>t.change&&t.change(...e))},[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(s.list_values,t=>(Object(n["openBlock"])(),Object(n["createBlock"])("option",{value:t.value},Object(n["toDisplayString"])(t.label),9,["value"]))),256))],40,["onUpdate:modelValue","id"]),[[n["vModelSelect"],t.form[s.slug]]]),H,Object(n["createVNode"])("small",{id:s.slug+"Help",class:"form-text text-muted"},Object(n["toDisplayString"])(s.description),9,["id"])])):Object(n["createCommentVNode"])("",!0),"BOO"===s.type?(Object(n["openBlock"])(),Object(n["createBlock"])("div",z,[Object(n["createVNode"])("label",{for:s.slug,class:"text-left primary"},Object(n["toDisplayString"])(s.name),9,["for"]),P,Object(n["withDirectives"])(Object(n["createVNode"])("input",{onChange:e[2]||(e[2]=(...e)=>t.change&&t.change(...e)),ref:s.slug,"onUpdate:modelValue":e=>t.form[s.slug]=e,value:"true",type:"checkbox",name:s.slug,id:s.slug,"aria-describedby":s.name},null,40,["onUpdate:modelValue","name","id","aria-describedby"]),[[n["vModelCheckbox"],t.form[s.slug]]])])):Object(n["createCommentVNode"])("",!0),"DAT"===s.type?(Object(n["openBlock"])(),Object(n["createBlock"])("div",F,[Object(n["createVNode"])("label",{for:s.slug,class:"text-left primary"},Object(n["toDisplayString"])(s.name),9,["for"]),Object(n["withDirectives"])(Object(n["createVNode"])("input",{onInput:e[3]||(e[3]=(...e)=>t.change&&t.change(...e)),"onUpdate:modelValue":e=>t.form[s.slug]=e,type:"date",class:"form-control",name:s.slug,id:s.slug,"aria-describedby":s.name,placeholder:s.placeholder},null,40,["onUpdate:modelValue","name","id","aria-describedby","placeholder"]),[[n["vModelText"],t.form[s.slug]]]),Object(n["createVNode"])("small",{id:s.name+"Help",class:"form-text text-muted"},Object(n["toDisplayString"])(s.description),9,["id"])])):Object(n["createCommentVNode"])("",!0),"NUM"===s.type?(Object(n["openBlock"])(),Object(n["createBlock"])("div",q,[Object(n["createVNode"])("label",{for:s.slug,class:"text-left primary"},Object(n["toDisplayString"])(s.name),9,["for"]),Object(n["withDirectives"])(Object(n["createVNode"])("input",{onInput:e[4]||(e[4]=(...e)=>t.change&&t.change(...e)),"onUpdate:modelValue":e=>t.form[s.slug]=e,type:"number",class:"form-control",name:s.slug,id:s.slug,"aria-describedby":s.name,placeholder:s.placeholder},null,40,["onUpdate:modelValue","name","id","aria-describedby","placeholder"]),[[n["vModelText"],t.form[s.slug]]]),Object(n["createVNode"])("small",{id:s.name+"Help",class:"form-text text-muted"},Object(n["toDisplayString"])(s.description),9,["id"])])):Object(n["createCommentVNode"])("",!0)]))),256))])]),_:1})}var U=i("94c2");function X(t,e){return"textarea"===t.mode?Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createBlock"])("textarea",{key:0,"onUpdate:modelValue":e[1]||(e[1]=e=>t.value=e),onChange:e[2]||(e[2]=(...e)=>t.onChange&&t.onChange(...e))},null,544)),[[n["vModelText"],t.value]]):(Object(n["openBlock"])(),Object(n["createBlock"])("input",{key:1,value:t.value,class:"textPropertyInput",onChange:e[3]||(e[3]=(...e)=>t.onChange&&t.onChange(...e))},null,40,["value"]))}var J=i("d26e"),K=i.n(J),Y=(i("3db7"),null),G=Object(n["defineComponent"])({name:"Tags",props:{mode:String,settings:Object,value:[String,Array],onChange:Function},data:function(){return{tagify:Y}},watch:{value:function(t){this.tagify.loadOriginalValues(t)},settings:{deep:!0,handler:function(t){this.tagify.settings.whitelist=t.whitelist}}},mounted:function(){this.tagify=new K.a(this.$el,this.settings)}});i("41e3");G.render=X;var Q=G,Z={},tt={},et=Object(n["defineComponent"])({name:"PropertiesComponent",props:{parameters:[],blockId:String,ctx:Object,botContext:[],uid:Number},setup:function(){var t=Object(n["reactive"])({value:"",tagifySettings:{autoComplete:{enabled:!0},tagTextProp:"value",pattern:"@",mode:"mix",enforceWhitelist:!0,templates:{dropdownItem:e},transformTag:i,whitelist:[],dropdown:{enabled:0,position:"text",mapValueTo:"value",highlightFirst:!0,placeAbove:!0}}});function e(t){return'<div class="tagify__dropdown__item">\n        <i class="fas fa-database"></i>\n        <span class="ml-2">'+t.value+"</span>\n      </div>"}function i(t){t.style="--tag-bg: #aee8be"}return{tagifyStuff:t}},data:function(){return{context:tt,form:Z}},components:{TextProperty:Q},mounted:function(){this.form=this.$props.ctx;for(var t=this.$props.parameters,e=0;e<t.length;e++)if("BOO"===t[e].type){var i=this.$refs;i[t[e].slug].click()}},watch:{botContext:{immediate:!0,handler:function(t){t.length?this.tagifyStuff.tagifySettings.whitelist=t.map((function(t){return"string"==typeof t?{value:t}:t})):this.tagifyStuff.tagifySettings.whitelist=[],this.context=this.$props.ctx}}},methods:{change:function(t){U["a"].emitter.emit("block-properties-change",this.$props.blockId,{id:t.target.id,value:"checkbox"===t.target.type?t.target.checked:t.target.value})}}});i("545e");et.render=W;var it,nt=et,st=new Uint8Array(16);function ot(){if(!it&&(it="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!it))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return it(st)}var at=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function rt(t){return"string"===typeof t&&at.test(t)}for(var lt=rt,ct=[],dt=0;dt<256;++dt)ct.push((dt+256).toString(16).substr(1));function ut(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(ct[t[e+0]]+ct[t[e+1]]+ct[t[e+2]]+ct[t[e+3]]+"-"+ct[t[e+4]]+ct[t[e+5]]+"-"+ct[t[e+6]]+ct[t[e+7]]+"-"+ct[t[e+8]]+ct[t[e+9]]+"-"+ct[t[e+10]]+ct[t[e+11]]+ct[t[e+12]]+ct[t[e+13]]+ct[t[e+14]]+ct[t[e+15]]).toLowerCase();if(!lt(i))throw TypeError("Stringified UUID is invalid");return i}var ht=ut;function pt(t,e,i){t=t||{};var n=t.random||(t.rng||ot)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){i=i||0;for(var s=0;s<16;++s)e[i+s]=n[s];return e}return ht(n)}var gt=pt,ft=Object(n["defineComponent"])({name:"EditorBlockComponent",props:{id:Number,name:String,description:String,logo_class:String,output_vars:[],parameters:[],nodeData:Object},components:{BlockProperties:nt},setup:function(){return{uiid:gt()}},data:function(){return{showProperties:!1,context:{},botContext:{},uid:this.$props.nodeData?this.$props.nodeData.id:null}},mounted:function(){var t=this.uiid,e=this.id,i=this.uid;console.log("this.$props.nodeData",this.$props),setTimeout((function(){U["a"].emitter.emit("editor-block-data-request",i,e,t)}),40),U["a"].emitter.on("editor-block-data-response-"+t,this.setCtx)},watch:{uid:{immediate:!0,handler:function(t){var e=this;U["a"].emitter.emit("editor-block-data-ctx-add",this.uid,this.output_vars),U["a"].emitter.on("editor-block-context-update-"+t,(function(t,i){console.log("context",t,"nodes",i),e.botContext=e.filterCtx(t,i),console.log("vm.filterCtx(context, nodes)",e.filterCtx(t,i))}))}}},methods:{filterCtx:function(t,e){for(var i=[],n=0;n<t.length;n++)e.indexOf(t[n].value.substring(1,2))>-1&&i.push(t[n]);return i},setCtx:function(t){if(console.log("setCtx",t),t){for(var e in this.context={},t.data)this.context[e]=t.data[e];this.uid?U["a"].emitter.emit("editor-block-data-ctx-add",this.uid,this.output_vars):this.uid=t.id}console.log("nodeData",this.nodeData)},toggleSettings:function(t){this.showProperties=t||!this.showProperties}}});i("05d4");ft.render=D;var mt=ft;class vt{constructor(t,e=null,i=null){this.events={},this.container=t,this.precanvas=null,this.nodeId=1,this.ele_selected=null,this.node_selected=null,this.drag=!1,this.reroute=!1,this.reroute_fix_curvature=!1,this.curvature=.5,this.reroute_curvature_start_end=.5,this.reroute_curvature=.5,this.reroute_width=6,this.drag_point=!1,this.editor_selected=!1,this.connection=!1,this.connection_ele=null,this.connection_selected=null,this.canvas_x=0,this.canvas_y=0,this.pos_x=0,this.pos_x_start=0,this.pos_y=0,this.pos_y_start=0,this.mouse_x=0,this.mouse_y=0,this.line_path=5,this.first_click=null,this.force_first_input=!1,this.draggable_inputs=!0,this.useuuid=!1,this.parent=i,this.noderegister={},this.render=e,this.drawflow={drawflow:{Home:{data:{}}}},this.module="Home",this.editor_mode="edit",this.zoom=1,this.zoom_max=1.6,this.zoom_min=.5,this.zoom_value=.1,this.zoom_last_value=1,this.evCache=new Array,this.prevDiff=-1}start(){this.container.classList.add("parent-drawflow"),this.container.tabIndex=0,this.precanvas=document.createElement("div"),this.precanvas.classList.add("drawflow"),this.container.appendChild(this.precanvas),this.container.addEventListener("mouseup",this.dragEnd.bind(this)),this.container.addEventListener("mousemove",this.position.bind(this)),this.container.addEventListener("mousedown",this.click.bind(this)),this.container.addEventListener("touchend",this.dragEnd.bind(this)),this.container.addEventListener("touchmove",this.position.bind(this)),this.container.addEventListener("touchstart",this.click.bind(this)),this.container.addEventListener("contextmenu",this.contextmenu.bind(this)),this.container.addEventListener("keydown",this.key.bind(this)),this.container.addEventListener("wheel",this.zoom_enter.bind(this)),this.container.addEventListener("input",this.updateNodeValue.bind(this)),this.container.addEventListener("dblclick",this.dblclick.bind(this)),this.container.onpointerdown=this.pointerdown_handler.bind(this),this.container.onpointermove=this.pointermove_handler.bind(this),this.container.onpointerup=this.pointerup_handler.bind(this),this.container.onpointercancel=this.pointerup_handler.bind(this),this.container.onpointerout=this.pointerup_handler.bind(this),this.container.onpointerleave=this.pointerup_handler.bind(this),this.load()}pointerdown_handler(t){this.evCache.push(t)}pointermove_handler(t){for(var e=0;e<this.evCache.length;e++)if(t.pointerId==this.evCache[e].pointerId){this.evCache[e]=t;break}if(2==this.evCache.length){var i=Math.abs(this.evCache[0].clientX-this.evCache[1].clientX);this.prevDiff>100&&(i>this.prevDiff&&this.zoom_in(),i<this.prevDiff&&this.zoom_out()),this.prevDiff=i}}pointerup_handler(t){this.remove_event(t),this.evCache.length<2&&(this.prevDiff=-1)}remove_event(t){for(var e=0;e<this.evCache.length;e++)if(this.evCache[e].pointerId==t.pointerId){this.evCache.splice(e,1);break}}load(){for(var t in this.drawflow.drawflow[this.module].data)this.addNodeImport(this.drawflow.drawflow[this.module].data[t],this.precanvas);if(this.reroute)for(var t in this.drawflow.drawflow[this.module].data)this.addRerouteImport(this.drawflow.drawflow[this.module].data[t]);for(var t in this.drawflow.drawflow[this.module].data)this.updateConnectionNodes("node-"+t);const e=this.drawflow.drawflow;let i=1;Object.keys(e).map((function(t,n){Object.keys(e[t].data).map((function(t,e){parseInt(t)>=i&&(i=parseInt(t)+1)}))})),this.nodeId=i}removeReouteConnectionSelected(){this.dispatch("connectionUnselected",!0),this.reroute_fix_curvature&&this.connection_selected.parentElement.querySelectorAll(".main-path").forEach((t,e)=>{t.classList.remove("selected")})}click(t){if(this.dispatch("click",t),"fixed"===this.editor_mode){if("parent-drawflow"!==t.target.classList[0]&&"drawflow"!==t.target.classList[0])return!1;this.ele_selected=t.target.closest(".parent-drawflow")}else"view"===this.editor_mode?(null!=t.target.closest(".drawflow")||t.target.matches(".parent-drawflow"))&&(this.ele_selected=t.target.closest(".parent-drawflow"),t.preventDefault()):(this.first_click=t.target,this.ele_selected=t.target,0===t.button&&this.contextmenuDel(),null!=t.target.closest(".drawflow_content_node")&&(this.ele_selected=t.target.closest(".drawflow_content_node").parentElement));switch(this.ele_selected.classList[0]){case"drawflow-node":null!=this.node_selected&&(this.node_selected.classList.remove("selected"),this.node_selected!=this.ele_selected&&this.dispatch("nodeUnselected",!0)),null!=this.connection_selected&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.node_selected!=this.ele_selected&&this.dispatch("nodeSelected",this.ele_selected.id.slice(5)),this.node_selected=this.ele_selected,this.node_selected.classList.add("selected"),this.draggable_inputs?"SELECT"!==t.target.tagName&&(this.drag=!0):"INPUT"!==t.target.tagName&&"TEXTAREA"!==t.target.tagName&&"SELECT"!==t.target.tagName&&!0!==t.target.hasAttribute("contenteditable")&&(this.drag=!0);break;case"output":this.connection=!0,null!=this.node_selected&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),null!=this.connection_selected&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.drawConnection(t.target);break;case"parent-drawflow":null!=this.node_selected&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),null!=this.connection_selected&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.editor_selected=!0;break;case"drawflow":null!=this.node_selected&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),null!=this.connection_selected&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.editor_selected=!0;break;case"main-path":null!=this.node_selected&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),null!=this.connection_selected&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null),this.connection_selected=this.ele_selected,this.connection_selected.classList.add("selected");const e=this.connection_selected.parentElement.classList;this.dispatch("connectionSelected",{output_id:e[2].slice(14),input_id:e[1].slice(13),output_class:e[3],input_class:e[4]}),this.reroute_fix_curvature&&this.connection_selected.parentElement.querySelectorAll(".main-path").forEach((t,e)=>{t.classList.add("selected")});break;case"point":this.drag_point=!0,this.ele_selected.classList.add("selected");break;case"drawflow-delete":this.node_selected&&this.removeNodeId(this.node_selected.id),this.connection_selected&&this.removeConnection(),null!=this.node_selected&&(this.node_selected.classList.remove("selected"),this.node_selected=null,this.dispatch("nodeUnselected",!0)),null!=this.connection_selected&&(this.connection_selected.classList.remove("selected"),this.removeReouteConnectionSelected(),this.connection_selected=null);break;default:}"touchstart"===t.type?(this.pos_x=t.touches[0].clientX,this.pos_x_start=t.touches[0].clientX,this.pos_y=t.touches[0].clientY,this.pos_y_start=t.touches[0].clientY):(this.pos_x=t.clientX,this.pos_x_start=t.clientX,this.pos_y=t.clientY,this.pos_y_start=t.clientY),this.dispatch("clickEnd",t)}position(t){if("touchmove"===t.type)var e=t.touches[0].clientX,i=t.touches[0].clientY;else e=t.clientX,i=t.clientY;if(this.connection&&this.updateConnection(e,i),this.editor_selected&&(n=this.canvas_x+-(this.pos_x-e),s=this.canvas_y+-(this.pos_y-i),this.dispatch("translate",{x:n,y:s}),this.precanvas.style.transform="translate("+n+"px, "+s+"px) scale("+this.zoom+")"),this.drag){var n=(this.pos_x-e)*this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom),s=(this.pos_y-i)*this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom);this.pos_x=e,this.pos_y=i,this.ele_selected.style.top=this.ele_selected.offsetTop-s+"px",this.ele_selected.style.left=this.ele_selected.offsetLeft-n+"px",this.drawflow.drawflow[this.module].data[this.ele_selected.id.slice(5)].pos_x=this.ele_selected.offsetLeft-n,this.drawflow.drawflow[this.module].data[this.ele_selected.id.slice(5)].pos_y=this.ele_selected.offsetTop-s,this.updateConnectionNodes(this.ele_selected.id)}if(this.drag_point){n=(this.pos_x-e)*this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom),s=(this.pos_y-i)*this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom);this.pos_x=e,this.pos_y=i;var o=this.pos_x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom)),a=this.pos_y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom));this.ele_selected.setAttributeNS(null,"cx",o),this.ele_selected.setAttributeNS(null,"cy",a);const t=this.ele_selected.parentElement.classList[2].slice(9),r=this.ele_selected.parentElement.classList[1].slice(13),l=this.ele_selected.parentElement.classList[3],c=this.ele_selected.parentElement.classList[4];let d=Array.from(this.ele_selected.parentElement.children).indexOf(this.ele_selected)-1;if(this.reroute_fix_curvature){const t=this.ele_selected.parentElement.querySelectorAll(".main-path").length-1;d-=t,d<0&&(d=0)}const u=t.slice(5),h=this.drawflow.drawflow[this.module].data[u].outputs[l].connections.findIndex((function(t,e){return t.node===r&&t.output===c}));this.drawflow.drawflow[this.module].data[u].outputs[l].connections[h].points[d]={pos_x:o,pos_y:a};const p=this.ele_selected.parentElement.classList[2].slice(9);this.updateConnectionNodes(p)}"touchmove"===t.type&&(this.mouse_x=e,this.mouse_y=i),this.dispatch("mouseMove",{x:e,y:i})}dragEnd(t){if("touchend"===t.type)var e=this.mouse_x,i=this.mouse_y,n=document.elementFromPoint(e,i);else e=t.clientX,i=t.clientY,n=t.target;if(this.drag&&(this.pos_x_start==e&&this.pos_y_start==i||this.dispatch("nodeMoved",this.ele_selected.id.slice(5))),this.drag_point&&(this.ele_selected.classList.remove("selected"),this.pos_x_start==e&&this.pos_y_start==i||this.dispatch("rerouteMoved",this.ele_selected.parentElement.classList[2].slice(14))),this.editor_selected&&(this.canvas_x=this.canvas_x+-(this.pos_x-e),this.canvas_y=this.canvas_y+-(this.pos_y-i),this.editor_selected=!1),!0===this.connection)if("input"===n.classList[0]||this.force_first_input&&(null!=n.closest(".drawflow_content_node")||"drawflow-node"===n.classList[0])){if(!this.force_first_input||null==n.closest(".drawflow_content_node")&&"drawflow-node"!==n.classList[0])s=n.parentElement.parentElement.id,o=n.classList[1];else{if(null!=n.closest(".drawflow_content_node"))var s=n.closest(".drawflow_content_node").parentElement.id;else var s=n.id;if(0===Object.keys(this.getNodeFromId(s.slice(5)).inputs).length)var o=!1;else var o="input_1"}var a=this.ele_selected.parentElement.parentElement.id,r=this.ele_selected.classList[1];if(a!==s&&!1!==o){if(0===this.container.querySelectorAll(".connection.node_in_"+s+".node_out_"+a+"."+r+"."+o).length){this.connection_ele.classList.add("node_in_"+s),this.connection_ele.classList.add("node_out_"+a),this.connection_ele.classList.add(r),this.connection_ele.classList.add(o);var l=s.slice(5),c=a.slice(5);this.drawflow.drawflow[this.module].data[c].outputs[r].connections.push({node:l,output:o}),this.drawflow.drawflow[this.module].data[l].inputs[o].connections.push({node:c,input:r}),this.updateConnectionNodes("node-"+c),this.updateConnectionNodes("node-"+l),this.dispatch("connectionCreated",{output_id:c,input_id:l,output_class:r,input_class:o})}else this.dispatch("connectionCancel",!0),this.connection_ele.remove();this.connection_ele=null}else this.dispatch("connectionCancel",!0),this.connection_ele.remove(),this.connection_ele=null}else this.dispatch("connectionCancel",!0),this.connection_ele.remove(),this.connection_ele=null;this.drag=!1,this.drag_point=!1,this.connection=!1,this.ele_selected=null,this.editor_selected=!1}contextmenu(t){if(this.dispatch("contextmenu",t),t.preventDefault(),"fixed"===this.editor_mode||"view"===this.editor_mode)return!1;if(this.precanvas.getElementsByClassName("drawflow-delete").length&&this.precanvas.getElementsByClassName("drawflow-delete")[0].remove(),this.node_selected||this.connection_selected){var e=document.createElement("div");e.classList.add("drawflow-delete"),e.innerHTML="x",this.node_selected&&this.node_selected.appendChild(e),this.connection_selected&&(e.style.top=t.clientY*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))+"px",e.style.left=t.clientX*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))+"px",this.precanvas.appendChild(e))}}contextmenuDel(){this.precanvas.getElementsByClassName("drawflow-delete").length&&this.precanvas.getElementsByClassName("drawflow-delete")[0].remove()}key(t){if(this.dispatch("keydown",t),"fixed"===this.editor_mode||"view"===this.editor_mode)return!1;("Delete"===t.key||"Backspace"===t.key&&t.metaKey)&&(null!=this.node_selected&&"INPUT"!==this.first_click.tagName&&"TEXTAREA"!==this.first_click.tagName&&!0!==this.first_click.hasAttribute("contenteditable")&&this.removeNodeId(this.node_selected.id),null!=this.connection_selected&&this.removeConnection())}zoom_enter(t,e){t.ctrlKey&&(t.preventDefault(),t.deltaY>0?this.zoom_out():this.zoom_in())}zoom_refresh(){this.dispatch("zoom",this.zoom),this.canvas_x=this.canvas_x/this.zoom_last_value*this.zoom,this.canvas_y=this.canvas_y/this.zoom_last_value*this.zoom,this.zoom_last_value=this.zoom,this.precanvas.style.transform="translate("+this.canvas_x+"px, "+this.canvas_y+"px) scale("+this.zoom+")"}zoom_in(){this.zoom<this.zoom_max&&(this.zoom+=this.zoom_value,this.zoom_refresh())}zoom_out(){this.zoom>this.zoom_min&&(this.zoom-=this.zoom_value,this.zoom_refresh())}zoom_reset(){1!=this.zoom&&(this.zoom=1,this.zoom_refresh())}createCurvature(t,e,i,n,s,o){var a=t,r=e,l=i,c=n,d=s;switch(o){case"open":if(t>=i)var u=a+Math.abs(l-a)*d,h=l-Math.abs(l-a)*(-1*d);else u=a+Math.abs(l-a)*d,h=l-Math.abs(l-a)*d;return" M "+a+" "+r+" C "+u+" "+r+" "+h+" "+c+" "+l+"  "+c;case"close":if(t>=i)u=a+Math.abs(l-a)*(-1*d),h=l-Math.abs(l-a)*d;else u=a+Math.abs(l-a)*d,h=l-Math.abs(l-a)*d;return" M "+a+" "+r+" C "+u+" "+r+" "+h+" "+c+" "+l+"  "+c;case"other":if(t>=i)u=a+Math.abs(l-a)*(-1*d),h=l-Math.abs(l-a)*(-1*d);else u=a+Math.abs(l-a)*d,h=l-Math.abs(l-a)*d;return" M "+a+" "+r+" C "+u+" "+r+" "+h+" "+c+" "+l+"  "+c;default:u=a+Math.abs(l-a)*d,h=l-Math.abs(l-a)*d;return" M "+a+" "+r+" C "+u+" "+r+" "+h+" "+c+" "+l+"  "+c}}drawConnection(t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");this.connection_ele=e;var i=document.createElementNS("http://www.w3.org/2000/svg","path");i.classList.add("main-path"),i.setAttributeNS(null,"d",""),e.classList.add("connection"),e.appendChild(i),this.precanvas.appendChild(e);var n=t.parentElement.parentElement.id.slice(5),s=t.classList[1];this.dispatch("connectionStart",{output_id:n,output_class:s})}updateConnection(t,e){const i=this.precanvas,n=this.zoom;let s=i.clientWidth/(i.clientWidth*n);s=s||0;let o=i.clientHeight/(i.clientHeight*n);o=o||0;var a=this.connection_ele.children[0],r=this.ele_selected.offsetWidth/2+(this.ele_selected.getBoundingClientRect().x-i.getBoundingClientRect().x)*s,l=this.ele_selected.offsetHeight/2+(this.ele_selected.getBoundingClientRect().y-i.getBoundingClientRect().y)*o,c=t*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom)),d=e*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom)),u=this.curvature,h=this.createCurvature(r,l,c,d,u,"openclose");a.setAttributeNS(null,"d",h)}addConnection(t,e,i,n){var s=this.getModuleFromNodeId(t),o=this.getModuleFromNodeId(e);if(s===o){var a=this.getNodeFromId(t),r=!1;for(var l in a.outputs[i].connections){var c=a.outputs[i].connections[l];c.node==e&&c.output==n&&(r=!0)}if(!1===r){if(this.drawflow.drawflow[s].data[t].outputs[i].connections.push({node:e.toString(),output:n}),this.drawflow.drawflow[s].data[e].inputs[n].connections.push({node:t.toString(),input:i}),this.module===s){var d=document.createElementNS("http://www.w3.org/2000/svg","svg"),u=document.createElementNS("http://www.w3.org/2000/svg","path");u.classList.add("main-path"),u.setAttributeNS(null,"d",""),d.classList.add("connection"),d.classList.add("node_in_node-"+e),d.classList.add("node_out_node-"+t),d.classList.add(i),d.classList.add(n),d.appendChild(u),this.precanvas.appendChild(d),this.updateConnectionNodes("node-"+t),this.updateConnectionNodes("node-"+e)}this.dispatch("connectionCreated",{output_id:t,input_id:e,output_class:i,input_class:n})}}}updateConnectionNodes(t){const e="node_in_"+t,i="node_out_"+t;this.line_path;const n=this.container,s=this.precanvas,o=this.curvature,a=this.createCurvature,r=this.reroute_curvature,l=this.reroute_curvature_start_end,c=this.reroute_fix_curvature,d=this.reroute_width,u=this.zoom;let h=s.clientWidth/(s.clientWidth*u);h=h||0;let p=s.clientHeight/(s.clientHeight*u);p=p||0;const g=n.querySelectorAll("."+i);Object.keys(g).map((function(e,i){if(null===g[e].querySelector(".point")){var f=n.querySelector("#"+t),m=g[e].classList[1].replace("node_in_",""),v=n.querySelector("#"+m),b=v.querySelectorAll("."+g[e].classList[4])[0],w=b.offsetWidth/2+(b.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,y=b.offsetHeight/2+(b.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,O=f.querySelectorAll("."+g[e].classList[3])[0],_=O.offsetWidth/2+(O.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,x=O.offsetHeight/2+(O.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,C=w,j=y;const i=a(_,x,C,j,o,"openclose");g[e].children[0].setAttributeNS(null,"d",i)}else{const i=g[e].querySelectorAll(".point");let o="";const f=[];i.forEach((e,c)=>{if(0===c&&i.length-1===0){var g=n.querySelector("#"+t),m=e,v=(m.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,b=(m.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,w=g.querySelectorAll("."+e.parentElement.classList[3])[0],y=w.offsetWidth/2+(w.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,O=w.offsetHeight/2+(w.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,_=v,x=b,C=a(y,O,_,x,l,"open");o+=C,f.push(C);g=e;var j=e.parentElement.classList[1].replace("node_in_",""),T=n.querySelector("#"+j),N=(m=T.querySelectorAll("."+e.parentElement.classList[4])[0],T.querySelectorAll("."+e.parentElement.classList[4])[0]);v=N.offsetWidth/2+(N.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,b=N.offsetHeight/2+(N.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,y=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,O=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,_=v,x=b,C=a(y,O,_,x,l,"close");o+=C,f.push(C)}else if(0===c){g=n.querySelector("#"+t),m=e,v=(m.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,b=(m.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,w=g.querySelectorAll("."+e.parentElement.classList[3])[0],y=w.offsetWidth/2+(w.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,O=w.offsetHeight/2+(w.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,_=v,x=b,C=a(y,O,_,x,l,"open");o+=C,f.push(C);g=e,m=i[c+1],v=(m.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,b=(m.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,y=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,O=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,_=v,x=b,C=a(y,O,_,x,r,"other");o+=C,f.push(C)}else if(c===i.length-1){g=e,j=e.parentElement.classList[1].replace("node_in_",""),T=n.querySelector("#"+j),m=T.querySelectorAll("."+e.parentElement.classList[4])[0],N=T.querySelectorAll("."+e.parentElement.classList[4])[0],v=N.offsetWidth/2+(N.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,b=N.offsetHeight/2+(N.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,y=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*(s.clientWidth/(s.clientWidth*u))+d,O=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*(s.clientHeight/(s.clientHeight*u))+d,_=v,x=b,C=a(y,O,_,x,l,"close");o+=C,f.push(C)}else{g=e,m=i[c+1],v=(m.getBoundingClientRect().x-s.getBoundingClientRect().x)*(s.clientWidth/(s.clientWidth*u))+d,b=(m.getBoundingClientRect().y-s.getBoundingClientRect().y)*(s.clientHeight/(s.clientHeight*u))+d,y=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*(s.clientWidth/(s.clientWidth*u))+d,O=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*(s.clientHeight/(s.clientHeight*u))+d,_=v,x=b,C=a(y,O,_,x,r,"other");o+=C,f.push(C)}}),c?f.forEach((t,i)=>{g[e].children[i].setAttributeNS(null,"d",t)}):g[e].children[0].setAttributeNS(null,"d",o)}}));const f=n.querySelectorAll("."+e);Object.keys(f).map((function(e,i){if(null===f[e].querySelector(".point")){var u=n.querySelector("#"+t),g=f[e].classList[2].replace("node_out_",""),m=n.querySelector("#"+g),v=m.querySelectorAll("."+f[e].classList[3])[0],b=v.offsetWidth/2+(v.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,w=v.offsetHeight/2+(v.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,y=(u=u.querySelectorAll("."+f[e].classList[4])[0],u.offsetWidth/2+(u.getBoundingClientRect().x-s.getBoundingClientRect().x)*h),O=u.offsetHeight/2+(u.getBoundingClientRect().y-s.getBoundingClientRect().y)*p;const i=a(b,w,y,O,o,"openclose");f[e].children[0].setAttributeNS(null,"d",i)}else{const i=f[e].querySelectorAll(".point");let o="";const u=[];i.forEach((e,c)=>{if(0===c&&i.length-1===0){var g=n.querySelector("#"+t),f=e,m=(f.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,v=(f.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,b=g.querySelectorAll("."+e.parentElement.classList[4])[0],w=b.offsetWidth/2+(b.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,y=b.offsetHeight/2+(b.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,O=w,_=y,x=a(m,v,O,_,l,"close");o+=x,u.push(x);g=e;var C=e.parentElement.classList[2].replace("node_out_",""),j=n.querySelector("#"+C),T=(f=j.querySelectorAll("."+e.parentElement.classList[3])[0],j.querySelectorAll("."+e.parentElement.classList[3])[0]);m=T.offsetWidth/2+(T.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,v=T.offsetHeight/2+(T.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,w=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,y=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,O=w,_=y,x=a(m,v,O,_,l,"open");o+=x,u.push(x)}else if(0===c){g=e,C=e.parentElement.classList[2].replace("node_out_",""),j=n.querySelector("#"+C),f=j.querySelectorAll("."+e.parentElement.classList[3])[0],T=j.querySelectorAll("."+e.parentElement.classList[3])[0],m=T.offsetWidth/2+(T.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,v=T.offsetHeight/2+(T.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,w=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,y=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,O=w,_=y,x=a(m,v,O,_,l,"open");o+=x,u.push(x);g=e,f=i[c+1],w=(f.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,y=(f.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,m=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,v=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,O=w,_=y,x=a(m,v,O,_,r,"other");o+=x,u.push(x)}else if(c===i.length-1){g=e,C=e.parentElement.classList[1].replace("node_in_",""),j=n.querySelector("#"+C),f=j.querySelectorAll("."+e.parentElement.classList[4])[0],b=j.querySelectorAll("."+e.parentElement.classList[4])[0],w=b.offsetWidth/2+(b.getBoundingClientRect().x-s.getBoundingClientRect().x)*h,y=b.offsetHeight/2+(b.getBoundingClientRect().y-s.getBoundingClientRect().y)*p,m=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,v=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,O=w,_=y,x=a(m,v,O,_,l,"close");o+=x,u.push(x)}else{g=e,f=i[c+1],w=(f.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,y=(f.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,m=(g.getBoundingClientRect().x-s.getBoundingClientRect().x)*h+d,v=(g.getBoundingClientRect().y-s.getBoundingClientRect().y)*p+d,O=w,_=y,x=a(m,v,O,_,r,"other");o+=x,u.push(x)}}),c?u.forEach((t,i)=>{f[e].children[i].setAttributeNS(null,"d",t)}):f[e].children[0].setAttributeNS(null,"d",o)}}))}dblclick(t){null!=this.connection_selected&&this.reroute&&this.createReroutePoint(this.connection_selected),"point"===t.target.classList[0]&&this.removeReroutePoint(t.target)}createReroutePoint(t){this.connection_selected.classList.remove("selected");const e=this.connection_selected.parentElement.classList[2].slice(9),i=this.connection_selected.parentElement.classList[1].slice(13),n=this.connection_selected.parentElement.classList[3],s=this.connection_selected.parentElement.classList[4];this.connection_selected=null;const o=document.createElementNS("http://www.w3.org/2000/svg","circle");o.classList.add("point");var a=this.pos_x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom))-this.precanvas.getBoundingClientRect().x*(this.precanvas.clientWidth/(this.precanvas.clientWidth*this.zoom)),r=this.pos_y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom))-this.precanvas.getBoundingClientRect().y*(this.precanvas.clientHeight/(this.precanvas.clientHeight*this.zoom));o.setAttributeNS(null,"cx",a),o.setAttributeNS(null,"cy",r),o.setAttributeNS(null,"r",this.reroute_width);let l=0;if(this.reroute_fix_curvature){const e=t.parentElement.querySelectorAll(".main-path").length;var c=document.createElementNS("http://www.w3.org/2000/svg","path");if(c.classList.add("main-path"),c.setAttributeNS(null,"d",""),t.parentElement.insertBefore(c,t.parentElement.children[e]),1===e)t.parentElement.appendChild(o);else{const i=Array.from(t.parentElement.children).indexOf(t);l=i,t.parentElement.insertBefore(o,t.parentElement.children[i+e+1])}}else t.parentElement.appendChild(o);const d=e.slice(5),u=this.drawflow.drawflow[this.module].data[d].outputs[n].connections.findIndex((function(t,e){return t.node===i&&t.output===s}));void 0===this.drawflow.drawflow[this.module].data[d].outputs[n].connections[u].points&&(this.drawflow.drawflow[this.module].data[d].outputs[n].connections[u].points=[]),this.reroute_fix_curvature?(l>0?this.drawflow.drawflow[this.module].data[d].outputs[n].connections[u].points.splice(l,0,{pos_x:a,pos_y:r}):this.drawflow.drawflow[this.module].data[d].outputs[n].connections[u].points.push({pos_x:a,pos_y:r}),t.parentElement.querySelectorAll(".main-path").forEach((t,e)=>{t.classList.remove("selected")})):this.drawflow.drawflow[this.module].data[d].outputs[n].connections[u].points.push({pos_x:a,pos_y:r}),this.dispatch("addReroute",d),this.updateConnectionNodes(e)}removeReroutePoint(t){const e=t.parentElement.classList[2].slice(9),i=t.parentElement.classList[1].slice(13),n=t.parentElement.classList[3],s=t.parentElement.classList[4];let o=Array.from(t.parentElement.children).indexOf(t)-1;const a=e.slice(5),r=this.drawflow.drawflow[this.module].data[a].outputs[n].connections.findIndex((function(t,e){return t.node===i&&t.output===s}));if(this.reroute_fix_curvature){const e=t.parentElement.querySelectorAll(".main-path").length;t.parentElement.children[e-1].remove(),o-=e,o<0&&(o=0)}this.drawflow.drawflow[this.module].data[a].outputs[n].connections[r].points.splice(o,1),t.remove(),this.dispatch("removeReroute",a),this.updateConnectionNodes(e)}registerNode(t,e,i=null,n=null){this.noderegister[t]={html:e,props:i,options:n}}getNodeFromId(t){var e=this.getModuleFromNodeId(t);return JSON.parse(JSON.stringify(this.drawflow.drawflow[e].data[t]))}getNodesFromName(t){var e=[];const i=this.drawflow.drawflow;return Object.keys(i).map((function(n,s){for(var o in i[n].data)i[n].data[o].name==t&&e.push(i[n].data[o].id)})),e}addNode(t,e,i,n,s,o,a,r,l=!1){if(this.useuuid)var c=this.getUuid();else c=this.nodeId;const d=document.createElement("div");d.classList.add("parent-node");const u=document.createElement("div");u.innerHTML="",u.setAttribute("id","node-"+c),u.classList.add("drawflow-node"),""!=o&&u.classList.add(o);const h=document.createElement("div");h.classList.add("inputs");const p=document.createElement("div");p.classList.add("outputs");const g={};for(var f=0;f<e;f++){const t=document.createElement("div");t.classList.add("input"),t.classList.add("input_"+(f+1)),g["input_"+(f+1)]={connections:[]},h.appendChild(t)}const m={};for(f=0;f<i;f++){const t=document.createElement("div");t.classList.add("output"),t.classList.add("output_"+(f+1)),m["output_"+(f+1)]={connections:[]},p.appendChild(t)}const v=document.createElement("div");if(v.classList.add("drawflow_content_node"),!1===l)v.innerHTML=r;else if(!0===l)v.appendChild(this.noderegister[r].html.cloneNode(!0));else if(3===parseInt(this.render.version)){const t=this.noderegister[r];t.props["nodeData"]={id:this.nodeId};this.render.createApp({parent:this.parent,render:e=>this.render.h(this.noderegister[r].html,t.props,t.options)}).mount(v)}else{let t=new this.render({parent:this.parent,render:t=>t(u.html,{props:u.props}),...u.options}).$mount();v.appendChild(t.$el)}function b(t,e,i){if(null===t)t=a[e];else t=t[e];null!==t&&Object.entries(t).forEach((function(e,n){if("object"===typeof e[1])b(t,e[0],i+"-"+e[0]);else for(var s=v.querySelectorAll("[df-"+i+"-"+e[0]+"]"),o=0;o<s.length;o++)s[o].value=e[1]}))}Object.entries(a).forEach((function(t,e){if("object"===typeof t[1])b(null,t[0],t[0]);else for(var i=v.querySelectorAll("[df-"+t[0]+"]"),n=0;n<i.length;n++)i[n].value=t[1]})),u.appendChild(h),u.appendChild(v),u.appendChild(p),u.style.top=s+"px",u.style.left=n+"px",d.appendChild(u),this.precanvas.appendChild(d);var w={id:c,name:t,data:a,class:o,html:r,typenode:l,inputs:g,outputs:m,pos_x:n,pos_y:s};return this.drawflow.drawflow[this.module].data[c]=w,this.dispatch("nodeCreated",c),this.useuuid||this.nodeId++,c}addNodeImport(t,e){const i=document.createElement("div");i.classList.add("parent-node");const n=document.createElement("div");n.innerHTML="",n.setAttribute("id","node-"+t.id),n.classList.add("drawflow-node"),""!=t.class&&n.classList.add(t.class);const s=document.createElement("div");s.classList.add("inputs");const o=document.createElement("div");o.classList.add("outputs"),Object.keys(t.inputs).map((function(i,n){const o=document.createElement("div");o.classList.add("input"),o.classList.add(i),s.appendChild(o),Object.keys(t.inputs[i].connections).map((function(n,s){var o=document.createElementNS("http://www.w3.org/2000/svg","svg"),a=document.createElementNS("http://www.w3.org/2000/svg","path");a.classList.add("main-path"),a.setAttributeNS(null,"d",""),o.classList.add("connection"),o.classList.add("node_in_node-"+t.id),o.classList.add("node_out_node-"+t.inputs[i].connections[n].node),o.classList.add(t.inputs[i].connections[n].input),o.classList.add(i),o.appendChild(a),e.appendChild(o)}))}));for(var a=0;a<Object.keys(t.outputs).length;a++){const t=document.createElement("div");t.classList.add("output"),t.classList.add("output_"+(a+1)),o.appendChild(t)}const r=document.createElement("div");if(r.classList.add("drawflow_content_node"),!1===t.typenode)r.innerHTML=t.html;else if(!0===t.typenode)r.appendChild(this.noderegister[t.html].html.cloneNode(!0));else if(3===parseInt(this.render.version)){const e=this.noderegister[t.html];e.props["nodeData"]=t;this.render.createApp({parent:this.parent,render:t=>this.render.h(e.html,e.props,e.options)}).mount(r)}else{let t=new this.render({parent:this.parent,render:t=>t(n.html,{props:n.props}),...n.options}).$mount();r.appendChild(t.$el)}function l(e,i,n){if(null===e)e=t.data[i];else e=e[i];null!==e&&Object.entries(e).forEach((function(t,i){if("object"===typeof t[1])l(e,t[0],n+"-"+t[0]);else for(var s=r.querySelectorAll("[df-"+n+"-"+t[0]+"]"),o=0;o<s.length;o++)s[o].value=t[1]}))}Object.entries(t.data).forEach((function(t,e){if("object"===typeof t[1])l(null,t[0],t[0]);else for(var i=r.querySelectorAll("[df-"+t[0]+"]"),n=0;n<i.length;n++)i[n].value=t[1]})),n.appendChild(s),n.appendChild(r),n.appendChild(o),n.style.top=t.pos_y+"px",n.style.left=t.pos_x+"px",i.appendChild(n),this.precanvas.appendChild(i)}addRerouteImport(t){const e=this.reroute_width,i=this.reroute_fix_curvature,n=this.container;Object.keys(t.outputs).map((function(s,o){Object.keys(t.outputs[s].connections).map((function(o,a){const r=t.outputs[s].connections[o].points;void 0!==r&&r.forEach((a,l)=>{const c=t.outputs[s].connections[o].node,d=t.outputs[s].connections[o].output,u=n.querySelector(".connection.node_in_node-"+c+".node_out_node-"+t.id+"."+s+"."+d);if(i&&0===l)for(var h=0;h<r.length;h++){var p=document.createElementNS("http://www.w3.org/2000/svg","path");p.classList.add("main-path"),p.setAttributeNS(null,"d",""),u.appendChild(p)}const g=document.createElementNS("http://www.w3.org/2000/svg","circle");g.classList.add("point");var f=a.pos_x,m=a.pos_y;g.setAttributeNS(null,"cx",f),g.setAttributeNS(null,"cy",m),g.setAttributeNS(null,"r",e),u.appendChild(g)})}))}))}updateNodeValue(t){for(var e=t.target.attributes,i=0;i<e.length;i++)if(e[i].nodeName.startsWith("df-")){for(var n=e[i].nodeName.slice(3).split("-"),s=this.drawflow.drawflow[this.module].data[t.target.closest(".drawflow_content_node").parentElement.id.slice(5)].data,o=0;o<n.length-1;o+=1)null==s[n[o]]&&(s[n[o]]={}),s=s[n[o]];s[n[n.length-1]]=t.target.value,this.dispatch("nodeDataChanged",t.target.closest(".drawflow_content_node").parentElement.id.slice(5))}}updateNodeDataFromId(t,e){var i=this.getModuleFromNodeId(t);if(this.drawflow.drawflow[i].data[t].data=e,this.module===i){const i=this.container.querySelector("#node-"+t);function n(t,s,o){if(null===t)t=e[s];else t=t[s];null!==t&&Object.entries(t).forEach((function(e,s){if("object"===typeof e[1])n(t,e[0],o+"-"+e[0]);else for(var a=i.querySelectorAll("[df-"+o+"-"+e[0]+"]"),r=0;r<a.length;r++)a[r].value=e[1]}))}Object.entries(e).forEach((function(t,e){if("object"===typeof t[1])n(null,t[0],t[0]);else for(var s=i.querySelectorAll("[df-"+t[0]+"]"),o=0;o<s.length;o++)s[o].value=t[1]}))}}addNodeInput(t){var e=this.getModuleFromNodeId(t);const i=this.getNodeFromId(t),n=Object.keys(i.inputs).length;if(this.module===e){const e=document.createElement("div");e.classList.add("input"),e.classList.add("input_"+(n+1));const i=this.container.querySelector("#node-"+t+" .inputs");i.appendChild(e),this.updateConnectionNodes("node-"+t)}this.drawflow.drawflow[e].data[t].inputs["input_"+(n+1)]={connections:[]}}addNodeOutput(t){var e=this.getModuleFromNodeId(t);const i=this.getNodeFromId(t),n=Object.keys(i.outputs).length;if(this.module===e){const e=document.createElement("div");e.classList.add("output"),e.classList.add("output_"+(n+1));const i=this.container.querySelector("#node-"+t+" .outputs");i.appendChild(e),this.updateConnectionNodes("node-"+t)}this.drawflow.drawflow[e].data[t].outputs["output_"+(n+1)]={connections:[]}}removeNodeInput(t,e){var i=this.getModuleFromNodeId(t);const n=this.getNodeFromId(t);this.module===i&&this.container.querySelector("#node-"+t+" .inputs .input."+e).remove();const s=[];Object.keys(n.inputs[e].connections).map((function(i,o){const a=n.inputs[e].connections[o].node,r=n.inputs[e].connections[o].input;s.push({id_output:a,id:t,output_class:r,input_class:e})})),s.forEach((t,e)=>{this.removeSingleConnection(t.id_output,t.id,t.output_class,t.input_class)}),delete this.drawflow.drawflow[i].data[t].inputs[e];const o=[],a=this.drawflow.drawflow[i].data[t].inputs;Object.keys(a).map((function(t,e){o.push(a[t])})),this.drawflow.drawflow[i].data[t].inputs={};const r=e.slice(6);let l=[];if(o.forEach((e,n)=>{e.connections.forEach((t,e)=>{l.push(t)}),this.drawflow.drawflow[i].data[t].inputs["input_"+(n+1)]=e}),l=new Set(l.map(t=>JSON.stringify(t))),l=Array.from(l).map(t=>JSON.parse(t)),this.module===i){const e=this.container.querySelectorAll("#node-"+t+" .inputs .input");e.forEach((t,e)=>{const i=t.classList[1].slice(6);parseInt(r)<parseInt(i)&&(t.classList.remove("input_"+i),t.classList.add("input_"+(i-1)))})}l.forEach((e,n)=>{this.drawflow.drawflow[i].data[e.node].outputs[e.input].connections.forEach((n,s)=>{if(n.node==t){const o=n.output.slice(6);if(parseInt(r)<parseInt(o)){if(this.module===i){const i=this.container.querySelector(".connection.node_in_node-"+t+".node_out_node-"+e.node+"."+e.input+".input_"+o);i.classList.remove("input_"+o),i.classList.add("input_"+(o-1))}n.points?this.drawflow.drawflow[i].data[e.node].outputs[e.input].connections[s]={node:n.node,output:"input_"+(o-1),points:n.points}:this.drawflow.drawflow[i].data[e.node].outputs[e.input].connections[s]={node:n.node,output:"input_"+(o-1)}}}})}),this.updateConnectionNodes("node-"+t)}removeNodeOutput(t,e){var i=this.getModuleFromNodeId(t);const n=this.getNodeFromId(t);this.module===i&&this.container.querySelector("#node-"+t+" .outputs .output."+e).remove();const s=[];Object.keys(n.outputs[e].connections).map((function(i,o){const a=n.outputs[e].connections[o].node,r=n.outputs[e].connections[o].output;s.push({id:t,id_input:a,output_class:e,input_class:r})})),s.forEach((t,e)=>{this.removeSingleConnection(t.id,t.id_input,t.output_class,t.input_class)}),delete this.drawflow.drawflow[i].data[t].outputs[e];const o=[],a=this.drawflow.drawflow[i].data[t].outputs;Object.keys(a).map((function(t,e){o.push(a[t])})),this.drawflow.drawflow[i].data[t].outputs={};const r=e.slice(7);let l=[];if(o.forEach((e,n)=>{e.connections.forEach((t,e)=>{l.push({node:t.node,output:t.output})}),this.drawflow.drawflow[i].data[t].outputs["output_"+(n+1)]=e}),l=new Set(l.map(t=>JSON.stringify(t))),l=Array.from(l).map(t=>JSON.parse(t)),this.module===i){const e=this.container.querySelectorAll("#node-"+t+" .outputs .output");e.forEach((t,e)=>{const i=t.classList[1].slice(7);parseInt(r)<parseInt(i)&&(t.classList.remove("output_"+i),t.classList.add("output_"+(i-1)))})}l.forEach((e,n)=>{this.drawflow.drawflow[i].data[e.node].inputs[e.output].connections.forEach((n,s)=>{if(n.node==t){const o=n.input.slice(7);if(parseInt(r)<parseInt(o)){if(this.module===i){const i=this.container.querySelector(".connection.node_in_node-"+e.node+".node_out_node-"+t+".output_"+o+"."+e.output);i.classList.remove("output_"+o),i.classList.remove(e.output),i.classList.add("output_"+(o-1)),i.classList.add(e.output)}n.points?this.drawflow.drawflow[i].data[e.node].inputs[e.output].connections[s]={node:n.node,input:"output_"+(o-1),points:n.points}:this.drawflow.drawflow[i].data[e.node].inputs[e.output].connections[s]={node:n.node,input:"output_"+(o-1)}}}})}),this.updateConnectionNodes("node-"+t)}removeNodeId(t){this.removeConnectionNodeId(t);var e=this.getModuleFromNodeId(t.slice(5));this.module===e&&this.container.querySelector("#"+t).remove(),delete this.drawflow.drawflow[e].data[t.slice(5)],this.dispatch("nodeRemoved",t.slice(5))}removeConnection(){if(null!=this.connection_selected){var t=this.connection_selected.parentElement.classList;this.connection_selected.parentElement.remove();var e=this.drawflow.drawflow[this.module].data[t[2].slice(14)].outputs[t[3]].connections.findIndex((function(e,i){return e.node===t[1].slice(13)&&e.output===t[4]}));this.drawflow.drawflow[this.module].data[t[2].slice(14)].outputs[t[3]].connections.splice(e,1);var i=this.drawflow.drawflow[this.module].data[t[1].slice(13)].inputs[t[4]].connections.findIndex((function(e,i){return e.node===t[2].slice(14)&&e.input===t[3]}));this.drawflow.drawflow[this.module].data[t[1].slice(13)].inputs[t[4]].connections.splice(i,1),this.dispatch("connectionRemoved",{output_id:t[2].slice(14),input_id:t[1].slice(13),output_class:t[3],input_class:t[4]}),this.connection_selected=null}}removeSingleConnection(t,e,i,n){var s=this.getModuleFromNodeId(t),o=this.getModuleFromNodeId(e);if(s===o){var a=this.drawflow.drawflow[s].data[t].outputs[i].connections.findIndex((function(t,i){return t.node==e&&t.output===n}));if(a>-1){this.module===s&&this.container.querySelector(".connection.node_in_node-"+e+".node_out_node-"+t+"."+i+"."+n).remove();var r=this.drawflow.drawflow[s].data[t].outputs[i].connections.findIndex((function(t,i){return t.node==e&&t.output===n}));this.drawflow.drawflow[s].data[t].outputs[i].connections.splice(r,1);var l=this.drawflow.drawflow[s].data[e].inputs[n].connections.findIndex((function(e,n){return e.node==t&&e.input===i}));return this.drawflow.drawflow[s].data[e].inputs[n].connections.splice(l,1),this.dispatch("connectionRemoved",{output_id:t,input_id:e,output_class:i,input_class:n}),!0}return!1}return!1}removeConnectionNodeId(t){const e="node_in_"+t,i="node_out_"+t,n=this.container.querySelectorAll("."+i);for(var s=n.length-1;s>=0;s--){var o=n[s].classList,a=this.drawflow.drawflow[this.module].data[o[1].slice(13)].inputs[o[4]].connections.findIndex((function(t,e){return t.node===o[2].slice(14)&&t.input===o[3]}));this.drawflow.drawflow[this.module].data[o[1].slice(13)].inputs[o[4]].connections.splice(a,1);var r=this.drawflow.drawflow[this.module].data[o[2].slice(14)].outputs[o[3]].connections.findIndex((function(t,e){return t.node===o[1].slice(13)&&t.output===o[4]}));this.drawflow.drawflow[this.module].data[o[2].slice(14)].outputs[o[3]].connections.splice(r,1),n[s].remove(),this.dispatch("connectionRemoved",{output_id:o[2].slice(14),input_id:o[1].slice(13),output_class:o[3],input_class:o[4]})}const l=this.container.querySelectorAll("."+e);for(s=l.length-1;s>=0;s--){o=l[s].classList,r=this.drawflow.drawflow[this.module].data[o[2].slice(14)].outputs[o[3]].connections.findIndex((function(t,e){return t.node===o[1].slice(13)&&t.output===o[4]}));this.drawflow.drawflow[this.module].data[o[2].slice(14)].outputs[o[3]].connections.splice(r,1);a=this.drawflow.drawflow[this.module].data[o[1].slice(13)].inputs[o[4]].connections.findIndex((function(t,e){return t.node===o[2].slice(14)&&t.input===o[3]}));this.drawflow.drawflow[this.module].data[o[1].slice(13)].inputs[o[4]].connections.splice(a,1),l[s].remove(),this.dispatch("connectionRemoved",{output_id:o[2].slice(14),input_id:o[1].slice(13),output_class:o[3],input_class:o[4]})}}getModuleFromNodeId(t){var e;const i=this.drawflow.drawflow;return Object.keys(i).map((function(n,s){Object.keys(i[n].data).map((function(i,s){i==t&&(e=n)}))})),e}addModule(t){this.drawflow.drawflow[t]={data:{}},this.dispatch("moduleCreated",t)}changeModule(t){this.dispatch("moduleChanged",t),this.module=t,this.precanvas.innerHTML="",this.canvas_x=0,this.canvas_y=0,this.pos_x=0,this.pos_y=0,this.mouse_x=0,this.mouse_y=0,this.zoom=1,this.zoom_last_value=1,this.precanvas.style.transform="",this.import(this.drawflow,!1)}removeModule(t){this.module===t&&this.changeModule("Home"),delete this.drawflow.drawflow[t],this.dispatch("moduleRemoved",t)}clearModuleSelected(){this.precanvas.innerHTML="",this.drawflow.drawflow[this.module]={data:{}}}clear(){this.precanvas.innerHTML="",this.drawflow={drawflow:{Home:{data:{}}}}}export(){const t=JSON.parse(JSON.stringify(this.drawflow));return this.dispatch("export",t),t}import(t,e=!0){this.clear(),this.drawflow=JSON.parse(JSON.stringify(t)),this.load(),e&&this.dispatch("import","import")}on(t,e){return"function"!==typeof e?(console.error("The listener callback must be a function, the given type is "+typeof e),!1):"string"!==typeof t?(console.error("The event name must be a string, the given type is "+typeof t),!1):(void 0===this.events[t]&&(this.events[t]={listeners:[]}),void this.events[t].listeners.push(e))}removeListener(t,e){if(void 0===this.events[t])return!1;this.events[t].listeners=this.events[t].listeners.filter(t=>t.toString()!==e.toString())}dispatch(t,e){if(void 0===this.events[t])return!1;this.events[t].listeners.forEach(t=>{t(e)})}getUuid(){for(var t=[],e="0123456789abcdef",i=0;i<36;i++)t[i]=e.substr(Math.floor(16*Math.random()),1);t[14]="4",t[19]=e.substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-";var n=t.join("");return n}}const bt={class:"blocks-menu-container"},wt={class:"blocks-menu-filter"},yt={class:"ks-cboxtags"},Ot=Object(n["createVNode"])("label",{for:"checkboxLogic"},"Logic",-1),_t={class:"ml-2"},xt=Object(n["createVNode"])("label",{for:"checkboxAction"},"Action",-1),Ct={class:"ml-2"},jt=Object(n["createVNode"])("label",{for:"checkboxTrigger"},"Trigger",-1),Tt=Object(n["createVNode"])("hr",null,null,-1),Nt={class:"blocks-menu-blocks"},kt={key:0,class:"p-2"},St={key:1,class:"px-1"};function Et(t,e){const i=Object(n["resolveComponent"])("menu-block-place-holder"),s=Object(n["resolveComponent"])("menu-block");return Object(n["openBlock"])(),Object(n["createBlock"])("div",bt,[Object(n["createVNode"])("div",wt,[Object(n["createVNode"])("ul",yt,[Object(n["createVNode"])("li",null,[Object(n["createVNode"])("input",{onClick:e[1]||(e[1]=e=>t.addFilter("LOG")),type:"checkbox",id:"checkboxLogic",value:"action"}),Ot]),Object(n["createVNode"])("li",_t,[Object(n["createVNode"])("input",{onClick:e[2]||(e[2]=e=>t.addFilter("ACT")),type:"checkbox",id:"checkboxAction",value:"logic"}),xt]),Object(n["createVNode"])("li",Ct,[Object(n["createVNode"])("input",{onClick:e[3]||(e[3]=e=>t.addFilter("TRG")),type:"checkbox",id:"checkboxTrigger",value:"trigger"}),jt])])]),Tt,Object(n["createVNode"])("div",Nt,[t.isLoadingData?(Object(n["openBlock"])(),Object(n["createBlock"])("div",kt,[(Object(n["openBlock"])(),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(5,t=>Object(n["createVNode"])(i)),64))])):Object(n["createCommentVNode"])("",!0),t.isLoadingData?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])("ul",St,[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(t.filteredItems,t=>(Object(n["openBlock"])(),Object(n["createBlock"])("li",null,[Object(n["createVNode"])(s,{id:t.id,data:t},null,8,["id","data"])]))),256))]))])])}const Lt={class:"primary"},Bt={key:0,class:"badge bg-primary"},$t={key:1,class:"badge bg-secondary"},Dt={key:2,class:"badge bg-info"};function Mt(t,e){return Object(n["openBlock"])(),Object(n["createBlock"])("div",{class:"drag-drawflow",draggable:"true",onDragstart:e[1]||(e[1]=(...e)=>t.drag&&t.drag(...e)),"data-node":t.id,"data-data":t.data},[Object(n["createVNode"])("h4",Lt,[Object(n["createVNode"])("i",{class:t.data.logo_class},null,2),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(t.data.name),1)]),Object(n["createVNode"])("p",null,["ACT"===t.data.block_type?(Object(n["openBlock"])(),Object(n["createBlock"])("span",Bt,Object(n["toDisplayString"])(t.data.block_type),1)):Object(n["createCommentVNode"])("",!0),"TRG"===t.data.block_type?(Object(n["openBlock"])(),Object(n["createBlock"])("span",$t,Object(n["toDisplayString"])(t.data.block_type),1)):Object(n["createCommentVNode"])("",!0),"LOG"===t.data.block_type?(Object(n["openBlock"])(),Object(n["createBlock"])("span",Dt,Object(n["toDisplayString"])(t.data.block_type),1)):Object(n["createCommentVNode"])("",!0),Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(t.data.description),1)])],40,["data-node","data-data"])}var At=Object(n["defineComponent"])({name:"MenuBlockComponent",props:{id:Number,blockId:String,data:Object},methods:{drag:function(t){t.dataTransfer.setData("node",t.target.getAttribute("data-node")),t.dataTransfer.setData("data",JSON.stringify(this.data))}}});i("6e05");At.render=Mt;var It=At;const Vt={class:"placeholder"},Rt={class:"av__placeholder"},Ht={class:"h4__placeholder"},zt={class:"p__placeholder"},Pt={class:"p__placeholder"};function Ft(t,e){const i=Object(n["resolveComponent"])("Skeletor");return Object(n["openBlock"])(),Object(n["createBlock"])("div",Vt,[Object(n["createVNode"])("div",Rt,[Object(n["createVNode"])(i,{circle:"",size:"48"})]),Object(n["createVNode"])("h4",Ht,[Object(n["createVNode"])(i,{height:"22"})]),Object(n["createVNode"])("p",zt,[Object(n["createVNode"])(i,{height:"16"})]),Object(n["createVNode"])("p",Pt,[Object(n["createVNode"])(i,{height:"16"})])])}var qt=i("df33"),Wt={name:"MenuBlockPlaceholderComponent",components:{Skeletor:qt["a"]}};i("3b5b");Wt.render=Ft;var Ut=Wt,Xt=[],Jt=[],Kt=Object(n["defineComponent"])({name:"BlocksMenuComponent",props:{blocks:Object},components:{MenuBlock:It,MenuBlockPlaceHolder:Ut},watch:{blocks:{immediate:!0,handler:function(t){this.items=t,this.filteredItems=t,this.isLoadingData=!1}}},data:function(){return{items:Jt,isLoadingData:!1,filters:Xt,filteredItems:Jt}},created:function(){this.isLoadingData=!0},methods:{updateData:function(t){this.items=t,this.filteredItems=t,this.isLoadingData=!1},addFilter:function(t){var e=this,i=this.filters.findIndex((function(e){return e===t}));this.filters.find((function(e){return e===t}))?this.filters.splice(i,1):this.filters.push(t);var n=this.items.filter((function(t){return e.filters.indexOf(t.block_type)>-1}));this.filteredItems=this.filters.length>0?n:this.items}}});i("fe41");Kt.render=Et;var Yt=Kt,Gt=i("96cd"),Qt=i("f1e8"),Zt=Object(n["defineComponent"])({name:"spinner",props:{color:{type:String,default:"#000"},height:{type:Number,default:64},width:{type:Number,default:64}}});const te=Object(n["createVNode"])("g",{fill:"none","fill-rule":"evenodd"},[Object(n["createVNode"])("g",{transform:"translate(1 1)","stroke-width":"2"},[Object(n["createVNode"])("circle",{"stroke-opacity":".25",cx:"18",cy:"18",r:"18"}),Object(n["createVNode"])("path",{d:"M36 18c0-9.94-8.06-18-18-18"},[Object(n["createVNode"])("animateTransform",{attributeName:"transform",type:"rotate",from:"0 18 18",to:"360 18 18",dur:"0.8s",repeatCount:"indefinite"})])])],-1);function ee(t,e,i,s,o,a){return Object(n["openBlock"])(),Object(n["createBlock"])("svg",{viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",width:t.width,height:t.height,stroke:t.color},[te],8,["width","height","stroke"])}Zt.render=ee,Zt.__file="src/loaders/Spinner.vue";var ie=Object(n["defineComponent"])({name:"dots",props:{color:{type:String,default:"#000"},height:{type:Number,default:240},width:{type:Number,default:60}}});const ne=Object(n["createVNode"])("circle",{cx:"15",cy:"15",r:"15"},[Object(n["createVNode"])("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),Object(n["createVNode"])("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})],-1),se=Object(n["createVNode"])("circle",{cx:"60",cy:"15",r:"9","fill-opacity":"0.3"},[Object(n["createVNode"])("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),Object(n["createVNode"])("animate",{attributeName:"fill-opacity",from:"0.5",to:"0.5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})],-1),oe=Object(n["createVNode"])("circle",{cx:"105",cy:"15",r:"15"},[Object(n["createVNode"])("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),Object(n["createVNode"])("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})],-1);function ae(t,e,i,s,o,a){return Object(n["openBlock"])(),Object(n["createBlock"])("svg",{viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",fill:t.color,width:t.width,height:t.height},[ne,se,oe],8,["fill","width","height"])}ie.render=ae,ie.__file="src/loaders/Dots.vue";var re=Object(n["defineComponent"])({name:"bars",props:{color:{type:String,default:"#000"},height:{type:Number,default:40},width:{type:Number,default:40}}});const le=Object(n["createVNode"])("rect",{x:"0",y:"13",width:"4",height:"5"},[Object(n["createVNode"])("animate",{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0s",dur:"0.6s",repeatCount:"indefinite"}),Object(n["createVNode"])("animate",{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0s",dur:"0.6s",repeatCount:"indefinite"})],-1),ce=Object(n["createVNode"])("rect",{x:"10",y:"13",width:"4",height:"5"},[Object(n["createVNode"])("animate",{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0.15s",dur:"0.6s",repeatCount:"indefinite"}),Object(n["createVNode"])("animate",{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0.15s",dur:"0.6s",repeatCount:"indefinite"})],-1),de=Object(n["createVNode"])("rect",{x:"20",y:"13",width:"4",height:"5"},[Object(n["createVNode"])("animate",{attributeName:"height",attributeType:"XML",values:"5;21;5",begin:"0.3s",dur:"0.6s",repeatCount:"indefinite"}),Object(n["createVNode"])("animate",{attributeName:"y",attributeType:"XML",values:"13; 5; 13",begin:"0.3s",dur:"0.6s",repeatCount:"indefinite"})],-1);function ue(t,e,i,s,o,a){return Object(n["openBlock"])(),Object(n["createBlock"])("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",height:t.height,width:t.width,fill:t.color},[le,ce,de],8,["height","width","fill"])}re.render=ue,re.__file="src/loaders/Bars.vue";var he={Spinner:Zt,Dots:ie,Bars:re},pe=Object(n["defineComponent"])({name:"vue-loading",props:{active:Boolean,programmatic:Boolean,container:[Object,Function,HTMLElement],isFullPage:{type:Boolean,default:!0},enforceFocus:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!1},transition:{type:String,default:"fade"},canCancel:Boolean,onCancel:{type:Function,default:()=>{}},color:String,backgroundColor:String,blur:{type:String,default:"2px"},opacity:Number,width:Number,height:Number,zIndex:{type:Number,default:100},loader:{type:String,default:"spinner"}},setup(t,e){const i=Object(n["ref"])(t.active),s=Object(n["computed"])(()=>{let e={background:t.backgroundColor,opacity:t.opacity,backdropFilter:`blur(${t.blur})`};return e}),o=()=>{t.programmatic&&(i.value=!1,setTimeout(()=>{},150))},a=()=>{t.canCancel&&i.value&&(o(),t.onCancel())},r=t=>{27===t.keyCode&&a()},l=()=>{t.isFullPage&&t.lockScroll&&document.body.classList.add("vld-shown")},c=()=>{t.isFullPage&&t.lockScroll&&document.body.classList.remove("vld-shown")};return Object(n["onMounted"])(()=>{t.programmatic&&(i.value=!0,document.addEventListener("keyup",r))}),Object(n["onUnmounted"])(()=>{document.removeEventListener("keyup",r)}),Object(n["watch"])(()=>t.active,()=>{i.value=t.active}),Object(n["watch"])(i,()=>{i.value?l():c()}),{isActive:i,bgStyle:s,hide:o,cancel:a}},components:he});const ge={class:"vld-icon"};function fe(t,e,i,s,o,a){return Object(n["openBlock"])(),Object(n["createBlock"])(n["Transition"],{ref:"root",name:t.transition},{default:Object(n["withCtx"])(()=>[Object(n["withDirectives"])(Object(n["createVNode"])("div",{tabindex:"0",class:["vld-overlay is-active",{"is-full-page":t.isFullPage}],"aria-busy":t.isActive,"aria-label":"Loading",style:{zIndex:t.zIndex}},[Object(n["createVNode"])("div",{class:"vld-background",onClick:e[1]||(e[1]=Object(n["withModifiers"])((...e)=>t.cancel&&t.cancel(...e),["prevent"])),style:t.bgStyle},null,4),Object(n["createVNode"])("div",ge,[Object(n["renderSlot"])(t.$slots,"before"),Object(n["renderSlot"])(t.$slots,"default",{},()=>[(Object(n["openBlock"])(),Object(n["createBlock"])(Object(n["resolveDynamicComponent"])(t.loader),{color:t.color,width:t.width,height:t.height},null,8,["color","width","height"]))]),Object(n["renderSlot"])(t.$slots,"after")])],14,["aria-busy"]),[[n["vShow"],t.isActive]])]),_:3},8,["name"])}pe.render=fe,pe.__file="src/main/Component.vue";var me=pe,ve=(i("fe26"),i("5502")),be=!0;function we(t){return we="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},we(t)}function ye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Oe(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _e(t,e,i){return e&&Oe(t.prototype,e),i&&Oe(t,i),t}function xe(t){return Ce(t)||je(t)||Te(t)||ke()}function Ce(t){if(Array.isArray(t))return Ne(t)}function je(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function Te(t,e){if(t){if("string"===typeof t)return Ne(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Ne(t,e):void 0}}function Ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function ke(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Se(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object.keys(t).reduce((function(i,s){return e.includes(s)||(i[s]=Object(n["unref"])(t[s])),i}),{})}function Ee(t){return"function"===typeof t}function Le(t){return Object(n["isReactive"])(t)||Object(n["isReadonly"])(t)}function Be(t,e,i){if(i)return e?e(t()):t();try{var n=Promise.resolve(t());return e?n.then(e):n}catch(s){return Promise.reject(s)}}var $e="__root";function De(t){return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];try{return Promise.resolve(t.apply(this,e))}catch(n){return Promise.reject(n)}}}function Me(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object(n["unref"])(t),i=Object.keys(e),s={},o={},a={};return i.forEach((function(t){var i=e[t];switch(!0){case Ee(i.$validator):s[t]=i;break;case Ee(i):s[t]={$validator:i};break;case t.startsWith("$"):a[t]=i;break;default:o[t]=i}})),{rules:s,nestedValidators:o,config:a}}function Ae(t,e,i){var s=Object(n["unref"])(e);return t.call(i,s,i)}function Ie(t){return void 0!==t.$valid?!t.$valid:!t}function Ve(t,e,i,s,o,a,r){var l=o.$lazy,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],d=Object(n["ref"])(!!s.value),u=Object(n["ref"])(0);i.value=!1;var h=Object(n["watch"])([e,s].concat(c),(function(){if(l&&!s.value)return!1;var n;try{n=Ae(t,e,r)}catch(o){n=Promise.reject(o)}u.value++,i.value=!!u.value,d.value=!0,Promise.resolve(n).then((function(t){u.value--,i.value=!!u.value,a.value=t,d.value=Ie(t)}))["catch"]((function(t){u.value--,i.value=!!u.value,a.value=t,d.value=!0}))}),{immediate:!0,deep:"object"===we(e)});return{$invalid:d,$unwatch:h}}function Re(t,e,i,s,o,a){var r=s.$lazy,l=function(){return{}},c=Object(n["computed"])((function(){if(r&&!i.value)return!1;try{var n=Ae(t,e,a);return o.value=n,Ie(n)}catch(s){o.value=s}return!0}));return{$unwatch:l,$invalid:c}}function He(t,e,i,s,o,a,r,l){var c,d,u=Object(n["ref"])(!1),h=t.$params||{},p=Object(n["ref"])(null);if(t.$async){var g=Ve(t.$validator,e,u,i,s,p,o,t.$watchTargets);c=g.$invalid,d=g.$unwatch}else{var f=Re(t.$validator,e,i,s,p,o);c=f.$invalid,d=f.$unwatch}var m=t.$message,v=Ee(m)?Object(n["computed"])((function(){return m(Se({$pending:u,$invalid:c,$params:Se(h),$model:e,$response:p,$validator:a,$propertyPath:l,$property:r}))})):m||"";return{$message:v,$params:h,$pending:u,$invalid:c,$response:p,$unwatch:d}}function ze(t,e,i,s,o,a,r,l){var c=Object.keys(t),d=s.get(o,t),u=Object(n["ref"])(!1);if(d){if(!d.$partial)return d;d.$unwatch(),u.value=d.$dirty.value}var h={$dirty:u,$path:o,$touch:function(){u.value||(u.value=!0)},$reset:function(){u.value&&(u.value=!1)}};return c.length?(c.forEach((function(n){h[n]=He(t[n],e,h.$dirty,a,r,n,i,o)})),h.$externalResults=Object(n["computed"])((function(){return l.value?[].concat(l.value).map((function(t,e){return{$propertyPath:o,$property:i,$validator:"$externalResults",$uid:"".concat(o,"-").concat(e),$message:t,$params:{},$response:null,$pending:!1}})):[]})),h.$invalid=Object(n["computed"])((function(){return!!h.$externalResults.value.length||c.some((function(t){return Object(n["unref"])(h[t].$invalid)}))})),h.$pending=Object(n["computed"])((function(){return c.some((function(t){return Object(n["unref"])(h[t].$pending)}))})),h.$error=Object(n["computed"])((function(){return h.$invalid.value&&h.$dirty.value})),h.$silentErrors=Object(n["computed"])((function(){return c.filter((function(t){return Object(n["unref"])(h[t].$invalid)})).map((function(t){var e=h[t];return Object(n["reactive"])({$propertyPath:o,$property:i,$validator:t,$uid:"".concat(o,"-").concat(t),$message:e.$message,$params:e.$params,$response:e.$response,$pending:e.$pending})})).concat(h.$externalResults.value)})),h.$errors=Object(n["computed"])((function(){return h.$dirty.value?h.$silentErrors.value:[]})),h.$unwatch=function(){return c.forEach((function(t){h[t].$unwatch()}))},s.set(o,t,h),h):(d&&s.set(o,t,h),h)}function Pe(t,e,i,n,s,o,a){var r=Object.keys(t);return r.length?r.reduce((function(r,l){return r[l]=qe({validations:t[l],state:e,key:l,parentKey:i,resultsCache:n,globalConfig:s,instance:o,externalResults:a}),r}),{}):{}}function Fe(t,e,i){var s=Object(n["computed"])((function(){return[e,i].filter((function(t){return t})).reduce((function(t,e){return t.concat(Object.values(Object(n["unref"])(e)))}),[])})),o=Object(n["computed"])({get:function(){return t.$dirty.value||!!s.value.length&&s.value.every((function(t){return t.$dirty}))},set:function(e){t.$dirty.value=e}}),a=Object(n["computed"])((function(){var e=Object(n["unref"])(t.$silentErrors)||[],i=s.value.filter((function(t){return(Object(n["unref"])(t).$silentErrors||[]).length})).reduce((function(t,e){return t.concat.apply(t,xe(e.$silentErrors))}),[]);return e.concat(i)})),r=Object(n["computed"])((function(){var e=Object(n["unref"])(t.$errors)||[],i=s.value.filter((function(t){return(Object(n["unref"])(t).$errors||[]).length})).reduce((function(t,e){return t.concat.apply(t,xe(e.$errors))}),[]);return e.concat(i)})),l=Object(n["computed"])((function(){return s.value.some((function(t){return t.$invalid}))||Object(n["unref"])(t.$invalid)||!1})),c=Object(n["computed"])((function(){return s.value.some((function(t){return Object(n["unref"])(t.$pending)}))||Object(n["unref"])(t.$pending)||!1})),d=Object(n["computed"])((function(){return s.value.some((function(t){return t.$dirty}))||s.value.some((function(t){return t.$anyDirty}))||o.value})),u=Object(n["computed"])((function(){return l.value&&o.value||!1})),h=function(){t.$touch(),s.value.forEach((function(t){t.$touch()}))},p=function(){t.$reset(),s.value.forEach((function(t){t.$reset()}))};return s.value.length&&s.value.every((function(t){return t.$dirty}))&&h(),{$dirty:o,$errors:r,$invalid:l,$anyDirty:d,$error:u,$pending:c,$touch:h,$reset:p,$silentErrors:a}}function qe(t){var e=t.validations,i=t.state,s=t.key,o=t.parentKey,a=t.childResults,r=t.resultsCache,l=t.globalConfig,c=void 0===l?{}:l,d=t.instance,u=t.externalResults,h=o?"".concat(o,".").concat(s):s,p=Me(e),g=p.rules,f=p.nestedValidators,m=p.config,v=Object.assign({},c,m),b=s?Object(n["computed"])((function(){var t=Object(n["unref"])(i);return t?Object(n["unref"])(t[s]):void 0})):i,w=Object.assign({},Object(n["unref"])(u)||{}),y=Object(n["computed"])((function(){var t=Object(n["unref"])(u);return s?t?Object(n["unref"])(t[s]):void 0:t})),O=ze(g,b,s,r,h,v,d,y),_=Pe(f,b,h,r,v,d,y),x=Fe(O,_,a),C=x.$dirty,j=x.$errors,T=x.$invalid,N=x.$anyDirty,k=x.$error,S=x.$pending,E=x.$touch,L=x.$reset,B=x.$silentErrors,$=s?Object(n["computed"])({get:function(){return Object(n["unref"])(b)},set:function(t){C.value=!0;var e=Object(n["unref"])(i);Object(n["isRef"])(e[s])?e[s].value=t:e[s]=t}}):null;if(s&&v.$autoDirty)var D=Object(n["watch"])(b,(function(){var t="_".concat(h,"_$watcher_"),e=r.get(t,{});C.value||E(),e&&e.$unwatch(),r.set(t,{},{$unwatch:D})}),{flush:"sync"});function M(){return new Promise(De((function(t){return C.value||E(),Be(n["nextTick"],(function(){if(!S.value)return t(!T.value);var e=Object(n["watch"])(S,(function(){t(!T.value),e()}))}))})))}function A(t){return(a.value||{})[t]}function I(){Object(n["isRef"])(u)?u.value=w:0===Object.keys(w).length?Object.keys(u).forEach((function(t){delete u[t]})):Object.assign(u,w)}return Object(n["reactive"])(Object.assign({},O,{$model:$,$dirty:C,$error:k,$errors:j,$invalid:T,$anyDirty:N,$pending:S,$touch:E,$reset:L,$path:h||$e,$silentErrors:B},a&&{$getResultsForChild:A,$validate:M,$clearExternalResults:I},_))}var We=function(){function t(){ye(this,t),this.storage=new Map}return _e(t,[{key:"set",value:function(t,e,i){this.storage.set(t,{rules:e,result:i})}},{key:"checkRulesValidity",value:function(t,e,i){var s=Object.keys(i),o=Object.keys(e);if(o.length!==s.length)return!1;var a=o.every((function(t){return s.includes(t)}));return!!a&&o.every((function(t){return!e[t].$params||Object.keys(e[t].$params).every((function(s){return Object(n["unref"])(i[t].$params[s])===Object(n["unref"])(e[t].$params[s])}))}))}},{key:"get",value:function(t,e){var i=this.storage.get(t);if(i){var n=i.rules,s=i.result,o=this.checkRulesValidity(t,e,n),a=s.$unwatch?s.$unwatch:function(){return{}};return o?s:{$dirty:s.$dirty,$partial:!0,$unwatch:a}}}}]),t}(),Ue=Symbol("vuelidate#injectChiildResults"),Xe=Symbol("vuelidate#removeChiildResults"),Je={COLLECT_ALL:!0,COLLECT_NONE:!1};function Ke(t){var e=t.$scope,i={},s=Object(n["ref"])([]),o=Object(n["computed"])((function(){return s.value.reduce((function(t,e){return t[e]=Object(n["unref"])(i[e]),t}),{})}));function a(t,n){var o=n.$registerAs,a=n.$scope,r=n.$stopPropagation;r||e===Je.COLLECT_NONE||a===Je.COLLECT_NONE||e!==Je.COLLECT_ALL&&e!==a||(i[o]=t,s.value.push(o))}function r(t){s.value=s.value.filter((function(e){return e!==t})),delete i[t]}var l=Object(n["inject"])(Ue,(function(){}));Object(n["provide"])(Ue,a);var c=Object(n["inject"])(Xe,(function(){}));return Object(n["provide"])(Xe,r),{childResults:o,sendValidationResultsToParent:l,removeValidationResultsFromParent:c}}function Ye(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};1===arguments.length&&(i=t,t=void 0,e=void 0);var s=i,o=s.$registerAs,a=s.$scope,r=void 0===a?Je.COLLECT_ALL:a,l=s.$stopPropagation,c=s.$externalResults,d=Object(n["getCurrentInstance"])(),u=d?be?d.type:d.proxy.$options:{};if(!o&&d){var h=d.uid||d._uid;o="_vuelidate_".concat(h)}var p=Object(n["ref"])({}),g=new We,f=d?Ke({$scope:r}):{childResults:Object(n["ref"])({})},m=f.childResults,v=f.sendValidationResultsToParent,b=f.removeValidationResultsFromParent;if(!t&&u.validations){var w=u.validations;e=Object(n["ref"])({}),Object(n["onBeforeMount"])((function(){function t(e){return new Proxy(e,{get:function(e,i,s){return"object"===we(e[i])?t(e[i]):Object(n["computed"])((function(){return e[i]}))}})}e.value=d.proxy,Object(n["watch"])((function(){return Ee(w)?w.call(e.value,new t(e.value)):w}),(function(t){p.value=qe({validations:t,state:e,childResults:m,resultsCache:g,globalConfig:i,instance:d.proxy,externalResults:d.proxy.vuelidateExternalResults})}),{immediate:!0})})),i=u.validationsConfig||{}}else{var y=Object(n["isRef"])(t)||Le(t)?t:Object(n["reactive"])(t||{});Object(n["watch"])(y,(function(t){p.value=qe({validations:t,state:e,childResults:m,resultsCache:g,globalConfig:i,instance:d?d.proxy:{},externalResults:c})}),{immediate:!0})}return d&&(v(p,{$registerAs:o,$scope:r,$stopPropagation:l}),Object(n["onBeforeUnmount"])((function(){return b(o)}))),Object(n["computed"])((function(){return Object.assign({},Object(n["unref"])(p.value),m.value)}))}var Ge=Ye;function Qe(t){return Qe="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qe(t)}function Ze(t,e){return ti(t)||ei(t,e)||ii(t,e)||si()}function ti(t){if(Array.isArray(t))return t}function ei(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var i=[],n=!0,s=!1,o=void 0;try{for(var a,r=t[Symbol.iterator]();!(n=(a=r.next()).done);n=!0)if(i.push(a.value),e&&i.length===e)break}catch(l){s=!0,o=l}finally{try{n||null==r["return"]||r["return"]()}finally{if(s)throw o}}return i}}function ii(t,e){if(t){if("string"===typeof t)return ni(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ni(t,e):void 0}}function ni(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function si(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function oi(t){return"function"===typeof t}function ai(t){return null!==t&&"object"===Qe(t)&&!Array.isArray(t)}function ri(t){return oi(t.$validator)?Object.assign({},t):{$validator:t}}function li(t){return"object"===Qe(t)?t.$valid:t}function ci(t){return t.$validator||t}function di(t,e){if(!ai(t))throw new Error('[@vuelidate/validators]: First parameter to "withParams" should be an object, provided '.concat(Qe(t)));if(!ai(e)&&!oi(e))throw new Error("[@vuelidate/validators]: Validator must be a function or object with $validator parameter");var i=ri(e);return i.$params=Object.assign({},i.$params||{},t),i}function ui(t,e){if(!oi(t)&&"string"!==typeof Object(n["unref"])(t))throw new Error('[@vuelidate/validators]: First parameter to "withMessage" should be string or a function returning a string, provided '.concat(Qe(t)));if(!ai(e)&&!oi(e))throw new Error("[@vuelidate/validators]: Validator must be a function or object with $validator parameter");var i=ri(e);return i.$message=t,i}function hi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=ri(t);return Object.assign({},i,{$async:!0,$watchTargets:e})}function pi(t){return{$validator:function(e){for(var i=this,s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];return Object(n["unref"])(e).reduce((function(e,n){var s=Object.entries(n).reduce((function(e,n){var s=Ze(n,2),a=s[0],r=s[1],l=t[a],c=Object.entries(l).reduce((function(t,e){var n=Ze(e,2),s=n[0],l=n[1],c=ci(l),d=c.call.apply(c,[i,r].concat(o)),u=li(d);if(t.$data[s]=d,!u){var h=l.$message||"",p=l.$params||{};"function"===typeof h&&(h=h({$pending:!1,$invalid:!u,$params:p,$model:r,$response:d})),t.$errors.push({$property:a,$message:h,$params:p,$response:d,$model:r,$pending:!1,$validator:s})}return{$valid:t.$valid&&u,$data:t.$data,$errors:t.$errors}}),{$valid:!0,$data:{},$errors:[]});return e.$data[a]=c.$data,e.$errors[a]=c.$errors,{$valid:e.$valid&&c.$valid,$data:e.$data,$errors:e.$errors}}),{$valid:!0,$data:{},$errors:{}});return{$valid:e.$valid&&s.$valid,$data:e.$data.concat(s.$data),$errors:e.$errors.concat(s.$errors)}}),{$valid:!0,$data:[],$errors:[]})},$message:function(t){var e=t.$response;return e?e.$errors.map((function(t){return Object.values(t).map((function(t){return t.map((function(t){return t.$message}))})).reduce((function(t,e){return t.concat(e)}),[])})):[]}}}var gi=function(t){if(t=Object(n["unref"])(t),Array.isArray(t))return!!t.length;if(void 0===t||null===t)return!1;if(!1===t)return!0;if(t instanceof Date)return!isNaN(t.getTime());if("object"===Qe(t)){for(var e in t)return!0;return!1}return!!String(t).length},fi=function(t){return t=Object(n["unref"])(t),Array.isArray(t)?t.length:"object"===Qe(t)?Object.keys(t).length:String(t).length};function mi(t){return function(e){return e=Object(n["unref"])(e),!gi(e)||t.test(e)}}n["unref"],mi(/^[a-zA-Z]*$/),mi(/^[a-zA-Z0-9]*$/),mi(/^\d*(\.\d+)?$/);var vi=/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i;mi(vi);function bi(t){return function(e){return!gi(e)||fi(e)>=Object(n["unref"])(t)}}function wi(t){return{$validator:bi(t),$message:function(t){var e=t.$params;return"This field should be at least ".concat(e.min," long")},$params:{min:t,type:"minLength"}}}function yi(t){return"string"===typeof t&&(t=t.trim()),gi(t)}var Oi={$validator:yi,$message:"Value is required",$params:{type:"required"}};var _i=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i;mi(_i);mi(/(^[0-9]*$)|(^-[0-9]+$)/),mi(/^[-]?\d*(\.\d+)?$/);var xi=null,Ci=null,ji=[],Ti=null,Ni="botoEditor",ki=[],Si=Object(n["defineComponent"])({name:"App",setup:function(){var t=Object(ve["b"])();return{store:t,v$:Ge()}},validations:function(){return{botName:{required:Oi,minLength:wi(5)}}},data:function(){return{editor:null,mobile_item_selec:xi,mobile_last_move:Ci,transform:"",open:!1,blocks:ji,saveError:!1,saveErrorText:"",saveSuccess:!1,saveLoading:!1,botId:Ti,botName:"",botFrequency:60,isLoading:!1,fieldsContext:ki}},components:{BlocksMenu:Yt,AdminLayout:Gt["a"],EditorBlock:mt,Loading:me},methods:{positionMobile:function(t){this.mobile_last_move=t},allowDrop:function(t){t.preventDefault()},drag:function(t){"touchstart"===t.type?this.mobile_item_selec=t.target.closest(".drag-drawflow").getAttribute("data-node"):t.dataTransfer.setData("node",t.target.getAttribute("data-node"))},drop:function(t){if("touchend"===t.type){var e=this.mobile_last_move.touches[0].clientX,i=this.mobile_last_move.touches[0].clientY,n=document.elementFromPoint(e,i),s=n.closest("#"+Ni);null!=s&&this.addNodeToDrawFlow(this.mobile_item_selec,JSON.parse(this.mobile_item_selec),e,i),this.mobile_item_selec=""}else{t.preventDefault();var o=t.dataTransfer.getData("node"),a=t.dataTransfer.getData("data");this.addNodeToDrawFlow(o,JSON.parse(a),t.clientX,t.clientY)}},clearBot:function(){this.editor.clear(),this.initContext()},saveBot:function(){return Object(E["b"])(this,void 0,void 0,(function(){var t,e,i,n,s,o,a,r,l;return Object(E["c"])(this,(function(c){switch(c.label){case 0:return c.trys.push([0,4,,5]),this.v$.$invalid?[3,3]:(this.saveLoading=!0,this.saveSuccess=!1,this.saveError=!1,this.saveErrorText="",t=this.editor.export(),e=t.drawflow.Home,i={name:this.botName,json:e,frequency:this.botFrequency},console.log("exportdata",t,i,JSON.stringify(i)),n=this.botId?"PUT":"POST",s="https://botoapp.io/api/bots/",this.botId&&(s=""+s+this.botId+"/"),o={method:n,headers:{"Content-Type":"application/json",Authorization:"Token "+this.store.getters.localStorageAuthToken},body:JSON.stringify(i)},[4,fetch(s,o)]);case 1:if(a=c.sent(),!a.ok)throw new Error("An error has occured: "+a.status);return[4,a.json()];case 2:r=c.sent(),this.botId=r.id,this.botName=r.name,this.saveLoading=!1,this.saveSuccess=!0,this.cleanSave(),c.label=3;case 3:return[3,5];case 4:return l=c.sent(),this.saveLoading=!1,this.saveSuccess=!1,this.saveError=!0,this.saveErrorText=l,this.cleanSave(),[3,5];case 5:return[2]}}))}))},cleanSave:function(){var t=this;setTimeout((function(){t.saveLoading=!1,t.saveSuccess=!1,t.saveError=!1,t.saveErrorText=""}),3e3)},getPreviousNodes:function(t,e){var i=this.editor.drawflow.drawflow["Home"].data,n=i[t].inputs,s=[];for(var o in e&&(s=e),n)for(var a=n[o],r=0;r<a.connections.length;r++){var l=a.connections;s.push(l[r].node),this.getPreviousNodes(l[r].node,s)}return Array.from(new Set(s))},getForwardNodesToBeUpdated:function(t,e){var i=this.editor.drawflow.drawflow["Home"].data,n=i[t].outputs,s=[];for(var o in e&&(s=e),n)for(var a=n[o],r=0;r<a.connections.length;r++){var l=a.connections;s.push(l[r].node),this.getForwardNodesToBeUpdated(l[r].node,s)}return Array.from(new Set(s))},getBlocks:function(){return Object(E["b"])(this,void 0,void 0,(function(){var t,e;return Object(E["c"])(this,(function(i){switch(i.label){case 0:return[4,fetch("https://botoapp.io/api/blocks/",{cache:"no-store",headers:{"Content-Type":"application/json",Authorization:"Token "+this.store.getters.localStorageAuthToken}})];case 1:return t=i.sent(),[4,t.json()];case 2:return e=i.sent(),[2,e]}}))}))},cancelSaveBot:function(){this.botId=null,this.botName="",this.editor.clear(),this.initContext(),Qt["a"].push({name:"home.editor",params:{}})},getBot:function(t){return Object(E["b"])(this,void 0,void 0,(function(){var e,i;return Object(E["c"])(this,(function(n){switch(n.label){case 0:return[4,fetch("https://botoapp.io/api/bot/"+t+"/",{cache:"no-store",headers:{"Content-Type":"application/json",Authorization:"Token "+this.store.getters.localStorageAuthToken}})];case 1:return e=n.sent(),[4,e.json()];case 2:return i=n.sent(),[2,i]}}))}))},onFrequencyChange:function(t){this.botFrequency=t},initContext:function(){this.editor.drawflow.drawflow["Home"].context={},this.editor.drawflow.drawflow["Home"].context.nodes={}},initDiagram:function(){var t=document.getElementById(Ni);this.editor=null,this.editor=new vt(t,n),this.editor.start()},addNodeToDrawFlow:function(t,e,i,n){if("fixed"===this.editor.editor_mode)return!1;i=i*(this.editor.precanvas.clientWidth/(this.editor.precanvas.clientWidth*this.editor.zoom))-this.editor.precanvas.getBoundingClientRect().x*(this.editor.precanvas.clientWidth/(this.editor.precanvas.clientWidth*this.editor.zoom)),n=n*(this.editor.precanvas.clientHeight/(this.editor.precanvas.clientHeight*this.editor.zoom))-this.editor.precanvas.getBoundingClientRect().y*(this.editor.precanvas.clientHeight/(this.editor.precanvas.clientHeight*this.editor.zoom));var s=e.id,o={},a=this.editor.addNode(s,e.inputs,e.outputs,i,n,"class",o,s,"vue");this.editor.drawflow.drawflow["Home"].context.nodes[s]=a},sendBotContext:function(t){for(var e in t){var i=t[e].id,n=this.getForwardNodesToBeUpdated(i),s=this.getPreviousNodes(parseInt(i));U["a"].emitter.emit("editor-block-context-update-"+i,this.fieldsContext,s);for(var o=0;o<n.length;o++)U["a"].emitter.emit("editor-block-context-update-"+n[o],this.fieldsContext,s)}},sendContext:function(t){var e=t.input_id,i=this.getForwardNodesToBeUpdated(e),n=this.getPreviousNodes(parseInt(e));U["a"].emitter.emit("editor-block-context-update-"+e,this.fieldsContext,n);for(var s=0;s<i.length;s++)U["a"].emitter.emit("editor-block-context-update-"+i[s],this.fieldsContext,n)}},mounted:function(){return Object(E["b"])(this,void 0,void 0,(function(){var t,e,i,n,s,o,a,r,l,c,d;return Object(E["c"])(this,(function(u){switch(u.label){case 0:return u.trys.push([0,4,,5]),this.editor&&this.editor.clear(),t=this.$route.params.id,[4,this.getBlocks()];case 1:for(e=u.sent(),this.blocks=e.results.filter((function(t){return!0===t.published})),this.initDiagram(),this.initContext(),i=0;i<this.blocks.length;i++)n=this.blocks[i],s=n,o={},this.editor.registerNode(n.id,mt,s,o);return t?(this.botId=t.toString(),this.isLoading=!0,[4,this.getBot(this.botId)]):[3,3];case 2:a=u.sent(),this.editor.import({drawflow:{Home:{context:{nodes:a.json.context.nodes},data:a.json.data}}}),setTimeout((function(){c.sendBotContext(a.json.data)}),40),this.botName=a.name,this.botFrequency=a.frequency,this.isLoading=!1,u.label=3;case 3:for(r=document.getElementsByClassName("drag-drawflow"),l=0;l<r.length;l++)r[l].addEventListener("touchend",this.drop,!1),r[l].addEventListener("touchmove",this.positionMobile,!1),r[l].addEventListener("touchstart",this.drag,!1);return c=this,U["a"].emitter.on("block-properties-change",(function(t,e){var i=c.editor.drawflow.drawflow["Home"];i.data[t]||(i.data[t]={data:{}}),i.data[t].data[e.id]=e.value})),U["a"].emitter.on("editor-block-data-request",(function(t,e,i){var n=c.editor.drawflow.drawflow["Home"],s=t||n.context.nodes[e];U["a"].emitter.emit("editor-block-data-response-"+i,n.data[s])})),U["a"].emitter.on("editor-block-data-ctx-add",(function(t,e){if(t){var i=function(i){var n=e[i],s="@"+t+"."+n.slug;c.fieldsContext.find((function(t){return t.value===s}))||c.fieldsContext.push({value:s,text:n.name,title:n.description})};for(var n in e)i(n)}})),this.editor.on("connectionCreated",this.sendContext),this.editor.on("connectionRemoved",this.sendContext),[3,5];case 4:return d=u.sent(),console.error(d),this.isLoading=!1,[3,5];case 5:return[2]}}))}))}});i("6391");Si.render=S;e["default"]=Si},fe26:function(t,e,i){},fe41:function(t,e,i){"use strict";i("6f2f")}}]);
//# sourceMappingURL=chunk-f1b311b0.8b7b0510.js.map